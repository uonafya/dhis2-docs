<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>1.35.&nbsp;Data usage analytics</title><link rel="stylesheet" type="text/css" href="resources/css/docbook_bsd.css"><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"><link rel="home" href="dhis2_developer_manual.html" title="DHIS2 Developer Manual"><link rel="up" href="ch01.html" title="Chapter&nbsp;1.&nbsp;Web API"><link rel="prev" href="ch01s34.html" title="1.34.&nbsp;Data set report"><link rel="next" href="ch01s36.html" title="1.36.&nbsp;Geo features"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">1.35.&nbsp;Data usage analytics</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch01s34.html">Prev</a>&nbsp;</td><th width="60%" align="center">Chapter&nbsp;1.&nbsp;Web API</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="ch01s36.html">Next</a></td></tr></table><hr></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e8773"></a>1.35.&nbsp;Data usage analytics</h2></div></div></div><p>The usage analytics API lets you access information about how people are using DHIS 2, in
      particular related to data analysis. This resource lets you retrieve aggregated snapshots of
      usage analytics based on intervals in time. The resource will capture user views (e.g the
      number of times a chart or pivot table has been viewed by some user) and saved analysis
      favorites (e.g. favorite charts and pivot tables). When enabled, DHIS 2 will capture nightly
      snapshots which are then aggregated at request.</p><pre class="screen">/api/dataStatistics</pre><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d0e8780"></a>1.35.1.&nbsp;Request query parameter</h3></div></div></div><p>The usage analytics (data statistics) API supports two operations: POST to create a view
        event and GET to retrieve aggregated statistics.</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="d0e8785"></a>1.35.1.1.&nbsp;Creating view events (POST)</h4></div></div></div><p>The usage analytics API lets you create event views. The dataStatisticsEventType
          parameter describes what type of item was viewed. As an example, the following URL can be
          used to create a new event view for charts:
          </p><pre class="screen">POST /api/dataStatistics?eventType=CHART_VIEW</pre><p>A successful save operation returns HTTP status code 201. The table below shows the
          supported types of events.</p><div class="table"><a name="d0e8794"></a><p class="title"><b>Table&nbsp;1.65.&nbsp;Event types</b></p><div class="table-contents"><table class="table" summary="Event types" border="1"><colgroup><col class="c1"><col class="c2"></colgroup><thead><tr><th>Key</th><th>Description</th></tr></thead><tbody><tr><td>REPORT_TABLE_VIEW</td><td>Report table (pivot table) view.</td></tr><tr><td>CHART_VIEW</td><td>Chart view.</td></tr><tr><td>MAP_VIEW</td><td>Map view (GIS).</td></tr><tr><td>EVENT_REPORT_VIEW</td><td>Event report view.</td></tr><tr><td>EVENT_CHART_VIEW</td><td>Event chart view.</td></tr><tr><td>DASHBOARD_VIEW</td><td>Dashboard view.</td></tr></tbody></table></div></div><br class="table-break"></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="d0e8837"></a>1.35.1.2.&nbsp;Aggregated usage analytics report (GET)</h4></div></div></div><p>The usage analytics (data statistics) API lets you specify certain query parameters
          when asking for an aggregated report.</p><div class="table"><a name="d0e8842"></a><p class="title"><b>Table&nbsp;1.66.&nbsp;Query parameters for aggregated usage analytics (data statistics)</b></p><div class="table-contents"><table class="table" summary="Query parameters for aggregated usage analytics (data statistics)" border="1"><colgroup><col class="c1"><col class="c2"><col class="c3"><col class="c4"></colgroup><thead><tr><th>Query parameter</th><th>Required</th><th>Description</th><th>Options</th></tr></thead><tbody><tr><td>startDate</td><td>Yes</td><td>Start date for period</td><td>Date in yyyy-MM-dd format</td></tr><tr><td>endDate</td><td>Yes</td><td>End date for period</td><td>Date in yyyy-MM-dd format</td></tr><tr><td>interval</td><td>Yes</td><td>Type of interval to be aggregated</td><td>DAY, WEEK, MONTH, YEAR</td></tr></tbody></table></div></div><p><br class="table-break"></p><p>The startDate and endDate parameters specifies the period for which snaphots should be
          used in the aggregation. The dates must be formatted as shown above. If there is no
          snapshots saved in the specified period an empty list will be sent back. The interval
          parameter specifies what kind of aggregation will be done. As an example, to query for a
          yearly aggregation you can use the following URL:
          </p><pre class="screen">GET /api/dataStatistics?startDate=2014-01-02&amp;endDate=2016-01-01&amp;interval=MONTH</pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="d0e8892"></a>1.35.1.3.&nbsp;Response format</h4></div></div></div><p>The usage analytics response containing aggregate data can be returned in various
          representation formats. The default format is JSON. The available formats and content-
          types are listed below. </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>json (application/json)</p></li><li class="listitem"><p>xml (application/xml)</p></li><li class="listitem"><p>html (text/html)</p></li></ul></div><p>As an example, to request an usage analytics response in XML format you can use the
        following URL:
        </p><pre class="screen">/api/dataStatistics.xml?startDate=2014-01-01&amp;endDate=2016-01-01&amp;interval=WEEK</pre><p>The aggregated usage analytics response must be retrieved using the HTTP GET method.
        This allows for direct linking to usage analytics responses from Web pages as well as other
        HTTP-enabled clients. To do functional testing we can use the cURL library. By executing
        this command against the demo database you will get an usage analytics response in JSON
        format:
        </p><pre class="screen">curl "play.dhis2.org/demo/api/dataStatistics?startDate=2016-02-01&amp;endDate=2016-02-14&amp;
interval=WEEK" -u admin:district</pre><p>The JSON response will look like this:
        </p><pre class="screen">[ 
  {
    "year": 2016,
    "week": 5,
    "activeUsers": 99,
    "mapViews": 2180,
    "chartViews": 2227,
    "reportTableViews": 5632,
    "eventReportViews": 5632,
    "eventChartViews": 9859,
    "dashboardViews": 10081,
    "totalViews": 1819,
    "averageViews": 6620,
    "savedMaps": 1804,
    "savedCharts": 2205,
    "savedReportTables": 1995,
    "savedEventReports": 1678,
    "savedEventCharts": 1613,
    "savedDashboards": 1922,
    "savedIndicators": 1831,
    "users": 969
}, 
{     
    "year": 2016,
    "week": 6,
    "activeUsers": 96,
    "mapViews": 2017,
    "chartViews": 2266,
    "reportTablesViews": 4714,
    "eventReportViews": 4714,
    "eventChartViews": 9510,
    "dashboardViews": 12181,
    "indicatorsViews": 10357,
    "totalViews": 2029,
    "averageViews": 6820,
    "savedMaps": 1642,
    "savedCharts": 1934,
    "savedReportTables": 1867,
    "savedEventReports": 1976,
    "savedEventCharts": 1713,
    "savedDashboards": 1736,
    "savedIndicators": 1646,
    "users": 953
  } 
] </pre><p>The response represents a list of aggregated data over two weekly intervals.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>The <span class="emphasis"><em>year</em></span> and <span class="emphasis"><em>week</em></span> properties show when the
            aggregated data is from.</p></li><li class="listitem"><p>The <span class="emphasis"><em>activeUsers</em></span> property is the maximum (peak) number of unique users
            that have made an event view.</p></li><li class="listitem"><p>The various views properties shows the number of views of each event (e.g map, chart) in the
            interval.</p></li><li class="listitem"><p>The <span class="emphasis"><em>totalViews</em></span> property shows the total number of views.</p></li><li class="listitem"><p>The <span class="emphasis"><em>averageViews</em></span> property shows the average number of views.</p></li><li class="listitem"><p>The varuous saved favorite properties shows how many favorites (e.g. report tables,
            dashboards) have been saved in the interval.</p></li><li class="listitem"><p>The <span class="emphasis"><em>users</em></span> property shows the total maximum (peak) number of users in the
            database at the given interval.</p></li></ul></div></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch01s34.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="ch01.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="ch01s36.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">1.34.&nbsp;Data set report&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="dhis2_developer_manual.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;1.36.&nbsp;Geo features</td></tr></table></div></body></html>