<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>DHIS2 Developer Manual</title><link rel="stylesheet" type="text/css" href="resources/css/docbook_bsd.css"><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="book"><div class="titlepage"><div><div><h1 class="title"><a name="index"></a>DHIS2 Developer Manual</h1></div><div><p class="releaseinfo">2.23</p></div><div><p class="copyright">Copyright &copy; 2006-2016 DHIS2 Documentation Team</p></div><div><div class="legalnotice"><a name="d6099e12"></a><p><a name="warranty"></a><b>Warranty:&nbsp;</b> THIS DOCUMENT IS PROVIDED BY  THE AUTHORS ''AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE AUTHORS OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS MANUAL AND PRODUCTS MENTIONED HEREIN, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</p><p><a name="license"></a><b>License:&nbsp;</b> Permission is granted to copy, distribute and/or modify this document
                    under the terms of the GNU Free Documentation License, Version 1.3
                    or any later version published by the Free Software Foundation;
                    with no Invariant Sections, no Front-Cover Texts, and no Back-Cover Texts.
                    A copy of the license is included in the source of this documentation, and is available here online:<a class="link" href="http://www.gnu.org/licenses/fdl.html" target="_top"> http://www.gnu.org/licenses/fdl.html</a>.</p></div></div><div><div class="revhistory"><table style="border-style:solid; width:100%;" summary="Revision History"><tr><th align="left" valign="top" colspan="2"><b>Revision History</b></th></tr><tr><td align="left">Revision 2174</td><td align="left">2016-05-22 10:32:35</td></tr><tr><td align="left" colspan="2">Version 2.23</td></tr></table></div></div></div><hr></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="chapter"><a href="#d6099e34">1. Web API</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e39">1.1. Introduction</a></span></dt><dt><span class="section"><a href="#d6099e119">1.2. Authentication</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e126">1.2.1. Basic Authentication</a></span></dt><dt><span class="section"><a href="#d6099e140">1.2.2. OAuth2</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e223">1.3. Error and info messages</a></span></dt><dt><span class="section"><a href="#d6099e300">1.4. Date and period format</a></span></dt><dt><span class="section"><a href="#d6099e447">1.5. Identifier Schemes</a></span></dt><dt><span class="section"><a href="#d6099e512">1.6. Browsing the Web API</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e601">1.6.1. Translation</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e636">1.7. Working with the metadata API</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e649">1.7.1. Content types</a></span></dt><dt><span class="section"><a href="#d6099e708">1.7.2. Query parameters</a></span></dt><dt><span class="section"><a href="#d6099e846">1.7.3. Available strategies for import</a></span></dt><dt><span class="section"><a href="#d6099e885">1.7.4. Examples</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e922">1.8. Metadata object filter</a></span></dt><dt><span class="section"><a href="#d6099e1210">1.9. Metadata field filter</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e1377">1.9.1. Field transformers</a></span></dt><dt><span class="section"><a href="#d6099e1403">1.9.2. Field converters</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e1436">1.10. Metadata create, read, update, delete, validate</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e1441">1.10.1. Create / update parameters</a></span></dt><dt><span class="section"><a href="#d6099e1499">1.10.2. Creating and updating objects</a></span></dt><dt><span class="section"><a href="#d6099e1550">1.10.3. Deleting objects</a></span></dt><dt><span class="section"><a href="#d6099e1568">1.10.4. Adding and removing objects to/from collections</a></span></dt><dt><span class="section"><a href="#d6099e1598">1.10.5. Validating payloads</a></span></dt><dt><span class="section"><a href="#d6099e1615">1.10.6. Partial updates</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e1638">1.11. CSV metadata import</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e1673">1.11.1. Data elements</a></span></dt><dt><span class="section"><a href="#d6099e1820">1.11.2. Organisation units</a></span></dt><dt><span class="section"><a href="#d6099e1987">1.11.3. Validation rules</a></span></dt><dt><span class="section"><a href="#d6099e2132">1.11.4. Translations</a></span></dt><dt><span class="section"><a href="#d6099e2199">1.11.5. Option sets</a></span></dt><dt><span class="section"><a href="#d6099e2275">1.11.6. Other objects</a></span></dt></dl></dd><dt><span class="section"><a href="#fileresource">1.12. File resources</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e2396">1.12.1. File resource constraints</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e2427">1.13. Metadata Export API 23</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e2498">1.13.1. Export Examples</a></span></dt><dt><span class="section"><a href="#d6099e2517">1.13.2. Data set and program export with dependencies</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e2534">1.14. Metadata Import API 23</a></span></dt><dt><span class="section"><a href="#d6099e2677">1.15. Data values</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e2682">1.15.1. Sending data values</a></span></dt><dt><span class="section"><a href="#d6099e2818">1.15.2. Sending bulks of data values</a></span></dt><dt><span class="section"><a href="#d6099e2854">1.15.3. Import parameters</a></span></dt><dt><span class="section"><a href="#d6099e2983">1.15.4. CSV data value format</a></span></dt><dt><span class="section"><a href="#d6099e3077">1.15.5. Generating data value set template</a></span></dt><dt><span class="section"><a href="#d6099e3140">1.15.6. Sending, reading and deleting individual data values</a></span></dt><dt><span class="section"><a href="#d6099e3315">1.15.7. Reading data values</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e3472">1.16. ADX formatted data</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e3485">1.16.1. The adx root element</a></span></dt><dt><span class="section"><a href="#d6099e3493">1.16.2. The group element</a></span></dt><dt><span class="section"><a href="#d6099e3502">1.16.3. Data values</a></span></dt><dt><span class="section"><a href="#d6099e3560">1.16.4. Importing data - HTTP POST</a></span></dt><dt><span class="section"><a href="#d6099e3574">1.16.5. Exporting data - HTTP GET</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e3588">1.17. Events</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e3593">1.17.1. Sending events</a></span></dt><dt><span class="section"><a href="#d6099e3877">1.17.2. CSV Import / Export</a></span></dt><dt><span class="section"><a href="#d6099e4047">1.17.3. Querying and reading events</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e4339">1.18. Program rules</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e4344">1.18.1. Program rules model</a></span></dt><dt><span class="section"><a href="#d6099e4741">1.18.2. Posting rules through the API</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e4746">1.19. Forms</a></span></dt><dt><span class="section"><a href="#d6099e4811">1.20. Validation</a></span></dt><dt><span class="section"><a href="#d6099e4915">1.21. Data integrity</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e4920">1.21.1. Running data integrity</a></span></dt><dt><span class="section"><a href="#d6099e4932">1.21.2. Fetching the result</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e4944">1.22. Indicators</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e4949">1.22.1. Aggregate indicators</a></span></dt><dt><span class="section"><a href="#d6099e5050">1.22.2. Program indicators</a></span></dt><dt><span class="section"><a href="#d6099e5103">1.22.3. Expressions</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e5123">1.23. Complete data set registrations</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e5128">1.23.1. Completing and un-completing data sets</a></span></dt><dt><span class="section"><a href="#d6099e5201">1.23.2. Reading complete data set registrations</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e5273">1.24. Data approval</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e5283">1.24.1. Get approval status</a></span></dt><dt><span class="section"><a href="#d6099e5451">1.24.2. Approve data</a></span></dt><dt><span class="section"><a href="#d6099e5534">1.24.3. Bulk approve data</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e5569">1.25. Auditing</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e5574">1.25.1. Aggregate data value audits</a></span></dt><dt><span class="section"><a href="#d6099e5654">1.25.2. Tracked entity data value audits</a></span></dt><dt><span class="section"><a href="#d6099e5717">1.25.3. Tracked entity attribute value audits</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e5780">1.26. Message conversations</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e5797">1.26.1. Writing and reading messages</a></span></dt><dt><span class="section"><a href="#d6099e5903">1.26.2. Managing messages</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e5986">1.27. Interpretations</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e5991">1.27.1. Reading interpretations</a></span></dt><dt><span class="section"><a href="#d6099e6012">1.27.2. Writing interpretations</a></span></dt><dt><span class="section"><a href="#d6099e6042">1.27.3. Creating, updating and removing interpretation comments</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e6057">1.28. Viewing analytical resource representations</a></span></dt><dt><span class="section"><a href="#d6099e6214">1.29. Plugins</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e6219">1.29.1. Embedding pivot tables with the Pivot Table plug-in</a></span></dt><dt><span class="section"><a href="#d6099e6492">1.29.2. Embedding charts with the Visualizer chart plug-in</a></span></dt><dt><span class="section"><a href="#d6099e6815">1.29.3. Embedding maps with the GIS map plug-in</a></span></dt><dt><span class="section"><a href="#d6099e7173">1.29.4. Creating a chart carousel with the carousel plug-in</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e7214">1.30. SQL views</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e7270">1.30.1. Criteria</a></span></dt><dt><span class="section"><a href="#d6099e7284">1.30.2. Variables</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e7319">1.31. Dashboard</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e7330">1.31.1. Browsing dashboards</a></span></dt><dt><span class="section"><a href="#d6099e7352">1.31.2. Searching dashboards</a></span></dt><dt><span class="section"><a href="#d6099e7369">1.31.3. Creating, updating and removing dashboards</a></span></dt><dt><span class="section"><a href="#d6099e7394">1.31.4. Adding, moving and removing dashboard items and content</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e7465">1.32. Analytics</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e7475">1.32.1. Dimensions and items</a></span></dt><dt><span class="section"><a href="#d6099e7650">1.32.2. Request query parameters</a></span></dt><dt><span class="section"><a href="#d6099e7902">1.32.3. Response formats</a></span></dt><dt><span class="section"><a href="#d6099e7997">1.32.4. Constraints</a></span></dt><dt><span class="section"><a href="#d6099e8032">1.32.5. Debugging</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e8042">1.33. Event analytics</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e8050">1.33.1. Dimensions and items</a></span></dt><dt><span class="section"><a href="#d6099e8106">1.33.2. Request query parameters</a></span></dt><dt><span class="section"><a href="#d6099e8438">1.33.3. Event query analytics</a></span></dt><dt><span class="section"><a href="#d6099e8593">1.33.4. Event aggregate analytics</a></span></dt><dt><span class="section"><a href="#d6099e8660">1.33.5. Event clustering analytics</a></span></dt><dt><span class="section"><a href="#d6099e8677">1.33.6. Event count and extent analytics</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e8694">1.34. Data set report</a></span></dt><dt><span class="section"><a href="#d6099e8773">1.35. Data usage analytics</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e8780">1.35.1. Request query parameter</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e8961">1.36. Geo features</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e9042">1.36.1. GeoJSON</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e9075">1.37. Generating resource and analytics tables</a></span></dt><dt><span class="section"><a href="#d6099e9134">1.38. Maintenance</a></span></dt><dt><span class="section"><a href="#d6099e9196">1.39. System resource</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e9204">1.39.1. Generate identifiers</a></span></dt><dt><span class="section"><a href="#d6099e9230">1.39.2. View system information</a></span></dt><dt><span class="section"><a href="#d6099e9251">1.39.3. Check if username and password combination is correct</a></span></dt><dt><span class="section"><a href="#d6099e9306">1.39.4. View asynchronous task status</a></span></dt><dt><span class="section"><a href="#d6099e9379">1.39.5. Get appearance information</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e9390">1.40. Locales</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e9395">1.40.1. UI locales</a></span></dt><dt><span class="section"><a href="#d6099e9402">1.40.2. Database content locales</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e9409">1.41. Translations</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e9417">1.41.1. Create translation</a></span></dt><dt><span class="section"><a href="#d6099e9596">1.41.2. Get translations</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e9611">1.42. Short Message Service (SMS)</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e9616">1.42.1. Outbound SMS service</a></span></dt><dt><span class="section"><a href="#d6099e9801">1.42.2. Inbound SMS service</a></span></dt><dt><span class="section"><a href="#d6099e9858">1.42.3. Gateway service administration</a></span></dt><dt><span class="section"><a href="#d6099e9883">1.42.4. Gateway configuration</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e9954">1.43. Users</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e9961">1.43.1. User query</a></span></dt><dt><span class="section"><a href="#d6099e10076">1.43.2. UserCredentials query</a></span></dt><dt><span class="section"><a href="#d6099e10095">1.43.3. User account create and update</a></span></dt><dt><span class="section"><a href="#d6099e10124">1.43.4. User account invitations</a></span></dt><dt><span class="section"><a href="#d6099e10183">1.43.5. User replication</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e10201">1.44. Current user information and associations</a></span></dt><dt><span class="section"><a href="#d6099e10264">1.45. System settings</a></span></dt><dt><span class="section"><a href="#d6099e10639">1.46. User settings</a></span></dt><dt><span class="section"><a href="#d6099e10785">1.47. Organisation units</a></span></dt><dt><span class="section"><a href="#d6099e10833">1.48. Filled organisation unit levels</a></span></dt><dt><span class="section"><a href="#d6099e10854">1.49. Static content</a></span></dt><dt><span class="section"><a href="#d6099e10916">1.50. Configuration</a></span></dt><dt><span class="section"><a href="#d6099e11041">1.51. Internationalization</a></span></dt><dt><span class="section"><a href="#d6099e11071">1.52. SVG conversion</a></span></dt><dt><span class="section"><a href="#d6099e11130">1.53. Tracked entity instance management</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e11135">1.53.1. Creating a new tracked entity instance</a></span></dt><dt><span class="section"><a href="#d6099e11176">1.53.2. Updating a tracked entity instance</a></span></dt><dt><span class="section"><a href="#d6099e11189">1.53.3. Deleting a tracked entity instance</a></span></dt><dt><span class="section"><a href="#d6099e11197">1.53.4. Enrolling a tracked entity instance into a program</a></span></dt><dt><span class="section"><a href="#d6099e11241">1.53.5. Update strategies</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e11273">1.54. Tracked entity instance query</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e11283">1.54.1. Request syntax</a></span></dt><dt><span class="section"><a href="#d6099e11549">1.54.2. Response format</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e11568">1.55. Tracked entity instance grid query</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e11590">1.55.1. Request syntax</a></span></dt><dt><span class="section"><a href="#d6099e11935">1.55.2. Response format</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e11966">1.56. Enrollment instance query</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e11974">1.56.1. Request syntax</a></span></dt><dt><span class="section"><a href="#d6099e12170">1.56.2. Response format</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e12189">1.57. Tracker bulk deletion</a></span></dt><dt><span class="section"><a href="#d6099e12221">1.58. Email</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e12226">1.58.1. System notification</a></span></dt><dt><span class="section"><a href="#d6099e12240">1.58.2. Test message</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e12250">1.59. Sharing</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e12260">1.59.1. Get sharing status</a></span></dt><dt><span class="section"><a href="#d6099e12271">1.59.2. Set sharing status</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e12282">1.60. Scheduling</a></span></dt><dt><span class="section"><a href="#d6099e12332">1.61. Schema</a></span></dt><dt><span class="section"><a href="#d6099e12355">1.62. UI customization</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e12373">1.62.1. Javascript</a></span></dt><dt><span class="section"><a href="#d6099e12392">1.62.2. CSS</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e12411">1.63. Synchronization</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e12416">1.63.1. Data push</a></span></dt><dt><span class="section"><a href="#d6099e12423">1.63.2. Metadata pull</a></span></dt><dt><span class="section"><a href="#d6099e12433">1.63.3. Availability check</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e12440">1.64. Apps</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e12450">1.64.1. Get apps</a></span></dt><dt><span class="section"><a href="#d6099e12488">1.64.2. Install an app</a></span></dt><dt><span class="section"><a href="#d6099e12495">1.64.3. Delete an app</a></span></dt><dt><span class="section"><a href="#d6099e12502">1.64.4. Reload apps</a></span></dt><dt><span class="section"><a href="#d6099e12509">1.64.5. Configure apps</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e12534">1.65. App store</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e12542">1.65.1. Get apps</a></span></dt><dt><span class="section"><a href="#d6099e12553">1.65.2. Install apps</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e12569">1.66. Data store</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e12579">1.66.1. Data store structure</a></span></dt><dt><span class="section"><a href="#d6099e12628">1.66.2. Get keys and namespaces</a></span></dt><dt><span class="section"><a href="#d6099e12682">1.66.3. Create and update values</a></span></dt><dt><span class="section"><a href="#d6099e12713">1.66.4. Delete keys</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e12740">1.67. User data store</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e12756">1.67.1. User data store structure</a></span></dt><dt><span class="section"><a href="#d6099e12814">1.67.2. Get namespaces</a></span></dt><dt><span class="section"><a href="#d6099e12830">1.67.3. Get keys</a></span></dt><dt><span class="section"><a href="#d6099e12847">1.67.4. Get value</a></span></dt><dt><span class="section"><a href="#d6099e12860">1.67.5. Add new value</a></span></dt><dt><span class="section"><a href="#d6099e12877">1.67.6. Update existing value</a></span></dt><dt><span class="section"><a href="#d6099e12890">1.67.7. Delete key</a></span></dt><dt><span class="section"><a href="#d6099e12903">1.67.8. Delete namespace</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e12916">1.68. Metadata repository</a></span></dt><dt><span class="section"><a href="#d6099e12943">1.69. FRED API</a></span></dt></dl></dd><dt><span class="chapter"><a href="#d6099e12976">2. Apps</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e12993">2.1. Purpose of packaged Apps</a></span></dt><dt><span class="section"><a href="#d6099e13000">2.2. Creating Apps</a></span></dt><dt><span class="section"><a href="#d6099e13104">2.3. Installing Apps into DHIS 2</a></span></dt><dt><span class="section"><a href="#d6099e13119">2.4. Launching Apps</a></span></dt><dt><span class="section"><a href="#d6099e13124">2.5. Adding the DHIS 2 menu to your app</a></span></dt></dl></dd><dt><span class="chapter"><a href="#d6099e13241">3. Infrastructure</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e13245">3.1. Release process</a></span></dt></dl></dd><dt><span class="chapter"><a href="#d6099e13317">4. DHIS 2 Technical Architecture</a></span></dt><dd><dl><dt><span class="section"><a href="#technicalOverview">4.1. Overview</a></span></dt><dt><span class="section"><a href="#technicalRequirements">4.2. Technical Requirements</a></span></dt><dt><span class="section"><a href="#technicalStructure">4.3. Project Structure</a></span></dt><dt><span class="section"><a href="#d6099e13386">4.4. Project Dependencies</a></span></dt><dt><span class="section"><a href="#technicalDataModel">4.5. The Data Model</a></span></dt><dt><span class="section"><a href="#technicalPersistenceLayer">4.6.  The Persistence Layer </a></span></dt><dt><span class="section"><a href="#technicalBusinessLayer">4.7.  The Business Layer </a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e13447">4.7.1. The JDBC Service Project</a></span></dt><dt><span class="section"><a href="#d6099e13516">4.7.2. The Data Mart Project</a></span></dt><dt><span class="section"><a href="#d6099e13720">4.7.3. The Reporting Project</a></span></dt><dt><span class="section"><a href="#d6099e13957">4.7.4. The System Support Project</a></span></dt></dl></dd><dt><span class="section"><a href="#technicalPresentationLayer">4.8.  The Presentation Layer </a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e13978">4.8.1. The Portal</a></span></dt></dl></dd><dt><span class="section"><a href="#technicalFrameworkStack">4.9.  Framework Stack </a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e14054">4.9.1. Application Frameworks</a></span></dt><dt><span class="section"><a href="#d6099e14102">4.9.2. Development Frameworks</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e14118">4.10. Definitions</a></span></dt></dl></dd><dt><span class="appendix"><a href="#dhis2_r">A. DHIS2 and R integration</a></span></dt><dd><dl><dt><span class="section"><a href="#dhis2_r_intro">A.1. Introduction</a></span></dt><dt><span class="section"><a href="#r_install">A.2. Installing R</a></span></dt><dt><span class="section"><a href="#dhis2_r_odbc">A.3. Using ODBC to retrieve data from DHIS2 into R</a></span></dt><dt><span class="section"><a href="#dhis2_r_mydatamart">A.4. Using R with MyDatamart</a></span></dt><dt><span class="section"><a href="#dhis2_r_maps">A.5. Mapping with R and PostgreSQL</a></span></dt><dt><span class="section"><a href="#dhis2_r_google_vis">A.6. Using R, DHIS2 and the Google Visualization API</a></span></dt><dt><span class="section"><a href="#dhis2_r_plr">A.7. Using PL/R with DHIS2</a></span></dt><dt><span class="section"><a href="#dhis2_r_web_api">A.8. Using this DHIS2 Web API with R</a></span></dt></dl></dd></dl></div><div class="list-of-figures"><p><b>List of Figures</b></p><dl><dt>4.1. <a href="#d6099e13404">Data values</a></dt><dt>4.2. <a href="#d6099e13416">Core Diagram</a></dt></dl></div><div class="list-of-tables"><p><b>List of Tables</b></p><dl><dt>1.1. <a href="#d6099e235">WebMessage properties</a></dt><dt>1.2. <a href="#d6099e314">Period format</a></dt><dt>1.3. <a href="#d6099e470">Scheme Values</a></dt><dt>1.4. <a href="#d6099e528">Query parameters</a></dt><dt>1.5. <a href="#d6099e606">Translate options</a></dt><dt>1.6. <a href="#d6099e656">Available Content-Types</a></dt><dt>1.7. <a href="#d6099e715">Available Query Filters</a></dt><dt>1.8. <a href="#d6099e853">Available Strategies</a></dt><dt>1.9. <a href="#d6099e942">Available Operators</a></dt><dt>1.10. <a href="#d6099e1278">Property operators</a></dt><dt>1.11. <a href="#d6099e1316">Field presets</a></dt><dt>1.12. <a href="#d6099e1408">Field converters</a></dt><dt>1.13. <a href="#d6099e1448">Available Query Filters</a></dt><dt>1.14. <a href="#d6099e1676">Data Element CSV Format</a></dt><dt>1.15. <a href="#d6099e1823">Organisation Unit CSV Format</a></dt><dt>1.16. <a href="#d6099e1990">Validation Rule CSV Format</a></dt><dt>1.17. <a href="#d6099e2135">Translation CSV format</a></dt><dt>1.18. <a href="#d6099e2202">Option Set CSV Format</a></dt><dt>1.19. <a href="#d6099e2278">Data Element Group, Category Option, Category Option Group, Organisation Unit Group
          CSV Format</a></dt><dt>1.20. <a href="#d6099e2449">Export Parameter</a></dt><dt>1.21. <a href="#d6099e2547">Import Parameter</a></dt><dt>1.22. <a href="#d6099e2859">Import parameters</a></dt><dt>1.23. <a href="#d6099e2990">CSV format of DHIS 2</a></dt><dt>1.24. <a href="#d6099e3089">Data values query parameters</a></dt><dt>1.25. <a href="#d6099e3155">Data values query parameters</a></dt><dt>1.26. <a href="#d6099e3338">Data value set query parameters</a></dt><dt>1.27. <a href="#d6099e3668">Events resource format</a></dt><dt>1.28. <a href="#d6099e3822">Import parameters</a></dt><dt>1.29. <a href="#d6099e3900">CSV column</a></dt><dt>1.30. <a href="#d6099e4069">Events resource query parameters</a></dt><dt>1.31. <a href="#d6099e4361"> programRule </a></dt><dt>1.32. <a href="#d6099e4426"> programRuleAction </a></dt><dt>1.33. <a href="#d6099e4669"> programRuleVariable </a></dt><dt>1.34. <a href="#d6099e4754">Form query parameters</a></dt><dt>1.35. <a href="#d6099e4831">Operators</a></dt><dt>1.36. <a href="#d6099e4886">Missing value strategies</a></dt><dt>1.37. <a href="#d6099e4960">Indicator variables</a></dt><dt>1.38. <a href="#d6099e5061">Program indicator variables</a></dt><dt>1.39. <a href="#d6099e5143">Complete data set registrations query parameters</a></dt><dt>1.40. <a href="#d6099e5209">Data value set query parameters</a></dt><dt>1.41. <a href="#d6099e5290">Data approval query parameters</a></dt><dt>1.42. <a href="#d6099e5333">Data approval query parameters</a></dt><dt>1.43. <a href="#d6099e5371">Data approval states</a></dt><dt>1.44. <a href="#d6099e5485">Data approval action parameters</a></dt><dt>1.45. <a href="#d6099e5584">Aggregate data value query parameters</a></dt><dt>1.46. <a href="#d6099e5662">Tracked entity data value query parameters</a></dt><dt>1.47. <a href="#d6099e5725">Tracked entity attribute value query parameters</a></dt><dt>1.48. <a href="#d6099e6086">Analytical resources</a></dt><dt>1.49. <a href="#d6099e6164">Data query parameters</a></dt><dt>1.50. <a href="#d6099e6187">Query parameters for png / image types (charts, maps)</a></dt><dt>1.51. <a href="#d6099e6301">Pivot table plug-in configuration</a></dt><dt>1.52. <a href="#d6099e6576">Visualizer chart plug-in configuration</a></dt><dt>1.53. <a href="#d6099e6901">GIS map plug-in configuration</a></dt><dt>1.54. <a href="#d6099e6982">Map plug-in configuration</a></dt><dt>1.55. <a href="#d6099e7405">Items content parameters</a></dt><dt>1.56. <a href="#d6099e7486">Dimensions and dimension items</a></dt><dt>1.57. <a href="#d6099e7655">Query parameters</a></dt><dt>1.58. <a href="#d6099e8055">Event dimensions</a></dt><dt>1.59. <a href="#d6099e8111">Query parameters for both event query and aggregate analytics</a></dt><dt>1.60. <a href="#d6099e8192">Query parameters for event query analytics only</a></dt><dt>1.61. <a href="#d6099e8265">Query parameters for aggregate event analytics only</a></dt><dt>1.62. <a href="#d6099e8392">Query parameters for cluster event analytics only</a></dt><dt>1.63. <a href="#d6099e8489">Filter operators</a></dt><dt>1.64. <a href="#d6099e8704">Accepted parameters of /dataSetReport resource</a></dt><dt>1.65. <a href="#d6099e8794">Event types</a></dt><dt>1.66. <a href="#d6099e8842">Query parameters for aggregated usage analytics (data statistics)</a></dt><dt>1.67. <a href="#d6099e8979">Geo features response</a></dt><dt>1.68. <a href="#d6099e9088">Analytics tables optional query parameters</a></dt><dt>1.69. <a href="#d6099e9269">HTTP Status codes</a></dt><dt>1.70. <a href="#d6099e9318">Task categories</a></dt><dt>1.71. <a href="#d6099e9428">Property names</a></dt><dt>1.72. <a href="#d6099e9458">Class names</a></dt><dt>1.73. <a href="#d6099e9638">Gateway response codes</a></dt><dt>1.74. <a href="#d6099e9814">User query parameters</a></dt><dt>1.75. <a href="#d6099e9910">Gateway api end points</a></dt><dt>1.76. <a href="#d6099e9971">User query parameters</a></dt><dt>1.77. <a href="#d6099e10311">System settings</a></dt><dt>1.78. <a href="#d6099e10692">User settings</a></dt><dt>1.79. <a href="#d6099e10795">Organisation units query parameters</a></dt><dt>1.80. <a href="#d6099e10864">Static content keys</a></dt><dt>1.81. <a href="#d6099e10964">Configuration values</a></dt><dt>1.82. <a href="#d6099e11100">Query parameters</a></dt><dt>1.83. <a href="#d6099e11246">Available tracker strategies</a></dt><dt>1.84. <a href="#d6099e11286">Tracked entity instances query parameters</a></dt><dt>1.85. <a href="#d6099e11366">Organisation unit selection modes</a></dt><dt>1.86. <a href="#d6099e11496">Filter operators</a></dt><dt>1.87. <a href="#d6099e11593">Tracked entity instances query parameters</a></dt><dt>1.88. <a href="#d6099e11703">Organisation unit selection modes</a></dt><dt>1.89. <a href="#d6099e11882">Filter operators</a></dt><dt>1.90. <a href="#d6099e11977">Tracked entity instances query parameters</a></dt><dt>1.91. <a href="#d6099e12057">Organisation unit selection modes</a></dt><dt>1.92. <a href="#d6099e12299">Task strategies</a></dt><dt>1.93. <a href="#d6099e12584">Data store structure</a></dt><dt>1.94. <a href="#d6099e12763">User data store structure</a></dt><dt>2.1. <a href="#d6099e13048">App types</a></dt></dl></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="d6099e34"></a>Chapter&nbsp;1.&nbsp;Web API</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="section"><a href="#d6099e39">1.1. Introduction</a></span></dt><dt><span class="section"><a href="#d6099e119">1.2. Authentication</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e126">1.2.1. Basic Authentication</a></span></dt><dt><span class="section"><a href="#d6099e140">1.2.2. OAuth2</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e223">1.3. Error and info messages</a></span></dt><dt><span class="section"><a href="#d6099e300">1.4. Date and period format</a></span></dt><dt><span class="section"><a href="#d6099e447">1.5. Identifier Schemes</a></span></dt><dt><span class="section"><a href="#d6099e512">1.6. Browsing the Web API</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e601">1.6.1. Translation</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e636">1.7. Working with the metadata API</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e649">1.7.1. Content types</a></span></dt><dt><span class="section"><a href="#d6099e708">1.7.2. Query parameters</a></span></dt><dt><span class="section"><a href="#d6099e846">1.7.3. Available strategies for import</a></span></dt><dt><span class="section"><a href="#d6099e885">1.7.4. Examples</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e922">1.8. Metadata object filter</a></span></dt><dt><span class="section"><a href="#d6099e1210">1.9. Metadata field filter</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e1377">1.9.1. Field transformers</a></span></dt><dt><span class="section"><a href="#d6099e1403">1.9.2. Field converters</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e1436">1.10. Metadata create, read, update, delete, validate</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e1441">1.10.1. Create / update parameters</a></span></dt><dt><span class="section"><a href="#d6099e1499">1.10.2. Creating and updating objects</a></span></dt><dt><span class="section"><a href="#d6099e1550">1.10.3. Deleting objects</a></span></dt><dt><span class="section"><a href="#d6099e1568">1.10.4. Adding and removing objects to/from collections</a></span></dt><dt><span class="section"><a href="#d6099e1598">1.10.5. Validating payloads</a></span></dt><dt><span class="section"><a href="#d6099e1615">1.10.6. Partial updates</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e1638">1.11. CSV metadata import</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e1673">1.11.1. Data elements</a></span></dt><dt><span class="section"><a href="#d6099e1820">1.11.2. Organisation units</a></span></dt><dt><span class="section"><a href="#d6099e1987">1.11.3. Validation rules</a></span></dt><dt><span class="section"><a href="#d6099e2132">1.11.4. Translations</a></span></dt><dt><span class="section"><a href="#d6099e2199">1.11.5. Option sets</a></span></dt><dt><span class="section"><a href="#d6099e2275">1.11.6. Other objects</a></span></dt></dl></dd><dt><span class="section"><a href="#fileresource">1.12. File resources</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e2396">1.12.1. File resource constraints</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e2427">1.13. Metadata Export API 23</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e2498">1.13.1. Export Examples</a></span></dt><dt><span class="section"><a href="#d6099e2517">1.13.2. Data set and program export with dependencies</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e2534">1.14. Metadata Import API 23</a></span></dt><dt><span class="section"><a href="#d6099e2677">1.15. Data values</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e2682">1.15.1. Sending data values</a></span></dt><dt><span class="section"><a href="#d6099e2818">1.15.2. Sending bulks of data values</a></span></dt><dt><span class="section"><a href="#d6099e2854">1.15.3. Import parameters</a></span></dt><dt><span class="section"><a href="#d6099e2983">1.15.4. CSV data value format</a></span></dt><dt><span class="section"><a href="#d6099e3077">1.15.5. Generating data value set template</a></span></dt><dt><span class="section"><a href="#d6099e3140">1.15.6. Sending, reading and deleting individual data values</a></span></dt><dt><span class="section"><a href="#d6099e3315">1.15.7. Reading data values</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e3472">1.16. ADX formatted data</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e3485">1.16.1. The adx root element</a></span></dt><dt><span class="section"><a href="#d6099e3493">1.16.2. The group element</a></span></dt><dt><span class="section"><a href="#d6099e3502">1.16.3. Data values</a></span></dt><dt><span class="section"><a href="#d6099e3560">1.16.4. Importing data - HTTP POST</a></span></dt><dt><span class="section"><a href="#d6099e3574">1.16.5. Exporting data - HTTP GET</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e3588">1.17. Events</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e3593">1.17.1. Sending events</a></span></dt><dt><span class="section"><a href="#d6099e3877">1.17.2. CSV Import / Export</a></span></dt><dt><span class="section"><a href="#d6099e4047">1.17.3. Querying and reading events</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e4339">1.18. Program rules</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e4344">1.18.1. Program rules model</a></span></dt><dt><span class="section"><a href="#d6099e4741">1.18.2. Posting rules through the API</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e4746">1.19. Forms</a></span></dt><dt><span class="section"><a href="#d6099e4811">1.20. Validation</a></span></dt><dt><span class="section"><a href="#d6099e4915">1.21. Data integrity</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e4920">1.21.1. Running data integrity</a></span></dt><dt><span class="section"><a href="#d6099e4932">1.21.2. Fetching the result</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e4944">1.22. Indicators</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e4949">1.22.1. Aggregate indicators</a></span></dt><dt><span class="section"><a href="#d6099e5050">1.22.2. Program indicators</a></span></dt><dt><span class="section"><a href="#d6099e5103">1.22.3. Expressions</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e5123">1.23. Complete data set registrations</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e5128">1.23.1. Completing and un-completing data sets</a></span></dt><dt><span class="section"><a href="#d6099e5201">1.23.2. Reading complete data set registrations</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e5273">1.24. Data approval</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e5283">1.24.1. Get approval status</a></span></dt><dt><span class="section"><a href="#d6099e5451">1.24.2. Approve data</a></span></dt><dt><span class="section"><a href="#d6099e5534">1.24.3. Bulk approve data</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e5569">1.25. Auditing</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e5574">1.25.1. Aggregate data value audits</a></span></dt><dt><span class="section"><a href="#d6099e5654">1.25.2. Tracked entity data value audits</a></span></dt><dt><span class="section"><a href="#d6099e5717">1.25.3. Tracked entity attribute value audits</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e5780">1.26. Message conversations</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e5797">1.26.1. Writing and reading messages</a></span></dt><dt><span class="section"><a href="#d6099e5903">1.26.2. Managing messages</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e5986">1.27. Interpretations</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e5991">1.27.1. Reading interpretations</a></span></dt><dt><span class="section"><a href="#d6099e6012">1.27.2. Writing interpretations</a></span></dt><dt><span class="section"><a href="#d6099e6042">1.27.3. Creating, updating and removing interpretation comments</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e6057">1.28. Viewing analytical resource representations</a></span></dt><dt><span class="section"><a href="#d6099e6214">1.29. Plugins</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e6219">1.29.1. Embedding pivot tables with the Pivot Table plug-in</a></span></dt><dt><span class="section"><a href="#d6099e6492">1.29.2. Embedding charts with the Visualizer chart plug-in</a></span></dt><dt><span class="section"><a href="#d6099e6815">1.29.3. Embedding maps with the GIS map plug-in</a></span></dt><dt><span class="section"><a href="#d6099e7173">1.29.4. Creating a chart carousel with the carousel plug-in</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e7214">1.30. SQL views</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e7270">1.30.1. Criteria</a></span></dt><dt><span class="section"><a href="#d6099e7284">1.30.2. Variables</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e7319">1.31. Dashboard</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e7330">1.31.1. Browsing dashboards</a></span></dt><dt><span class="section"><a href="#d6099e7352">1.31.2. Searching dashboards</a></span></dt><dt><span class="section"><a href="#d6099e7369">1.31.3. Creating, updating and removing dashboards</a></span></dt><dt><span class="section"><a href="#d6099e7394">1.31.4. Adding, moving and removing dashboard items and content</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e7465">1.32. Analytics</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e7475">1.32.1. Dimensions and items</a></span></dt><dt><span class="section"><a href="#d6099e7650">1.32.2. Request query parameters</a></span></dt><dt><span class="section"><a href="#d6099e7902">1.32.3. Response formats</a></span></dt><dt><span class="section"><a href="#d6099e7997">1.32.4. Constraints</a></span></dt><dt><span class="section"><a href="#d6099e8032">1.32.5. Debugging</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e8042">1.33. Event analytics</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e8050">1.33.1. Dimensions and items</a></span></dt><dt><span class="section"><a href="#d6099e8106">1.33.2. Request query parameters</a></span></dt><dt><span class="section"><a href="#d6099e8438">1.33.3. Event query analytics</a></span></dt><dt><span class="section"><a href="#d6099e8593">1.33.4. Event aggregate analytics</a></span></dt><dt><span class="section"><a href="#d6099e8660">1.33.5. Event clustering analytics</a></span></dt><dt><span class="section"><a href="#d6099e8677">1.33.6. Event count and extent analytics</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e8694">1.34. Data set report</a></span></dt><dt><span class="section"><a href="#d6099e8773">1.35. Data usage analytics</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e8780">1.35.1. Request query parameter</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e8961">1.36. Geo features</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e9042">1.36.1. GeoJSON</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e9075">1.37. Generating resource and analytics tables</a></span></dt><dt><span class="section"><a href="#d6099e9134">1.38. Maintenance</a></span></dt><dt><span class="section"><a href="#d6099e9196">1.39. System resource</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e9204">1.39.1. Generate identifiers</a></span></dt><dt><span class="section"><a href="#d6099e9230">1.39.2. View system information</a></span></dt><dt><span class="section"><a href="#d6099e9251">1.39.3. Check if username and password combination is correct</a></span></dt><dt><span class="section"><a href="#d6099e9306">1.39.4. View asynchronous task status</a></span></dt><dt><span class="section"><a href="#d6099e9379">1.39.5. Get appearance information</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e9390">1.40. Locales</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e9395">1.40.1. UI locales</a></span></dt><dt><span class="section"><a href="#d6099e9402">1.40.2. Database content locales</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e9409">1.41. Translations</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e9417">1.41.1. Create translation</a></span></dt><dt><span class="section"><a href="#d6099e9596">1.41.2. Get translations</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e9611">1.42. Short Message Service (SMS)</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e9616">1.42.1. Outbound SMS service</a></span></dt><dt><span class="section"><a href="#d6099e9801">1.42.2. Inbound SMS service</a></span></dt><dt><span class="section"><a href="#d6099e9858">1.42.3. Gateway service administration</a></span></dt><dt><span class="section"><a href="#d6099e9883">1.42.4. Gateway configuration</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e9954">1.43. Users</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e9961">1.43.1. User query</a></span></dt><dt><span class="section"><a href="#d6099e10076">1.43.2. UserCredentials query</a></span></dt><dt><span class="section"><a href="#d6099e10095">1.43.3. User account create and update</a></span></dt><dt><span class="section"><a href="#d6099e10124">1.43.4. User account invitations</a></span></dt><dt><span class="section"><a href="#d6099e10183">1.43.5. User replication</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e10201">1.44. Current user information and associations</a></span></dt><dt><span class="section"><a href="#d6099e10264">1.45. System settings</a></span></dt><dt><span class="section"><a href="#d6099e10639">1.46. User settings</a></span></dt><dt><span class="section"><a href="#d6099e10785">1.47. Organisation units</a></span></dt><dt><span class="section"><a href="#d6099e10833">1.48. Filled organisation unit levels</a></span></dt><dt><span class="section"><a href="#d6099e10854">1.49. Static content</a></span></dt><dt><span class="section"><a href="#d6099e10916">1.50. Configuration</a></span></dt><dt><span class="section"><a href="#d6099e11041">1.51. Internationalization</a></span></dt><dt><span class="section"><a href="#d6099e11071">1.52. SVG conversion</a></span></dt><dt><span class="section"><a href="#d6099e11130">1.53. Tracked entity instance management</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e11135">1.53.1. Creating a new tracked entity instance</a></span></dt><dt><span class="section"><a href="#d6099e11176">1.53.2. Updating a tracked entity instance</a></span></dt><dt><span class="section"><a href="#d6099e11189">1.53.3. Deleting a tracked entity instance</a></span></dt><dt><span class="section"><a href="#d6099e11197">1.53.4. Enrolling a tracked entity instance into a program</a></span></dt><dt><span class="section"><a href="#d6099e11241">1.53.5. Update strategies</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e11273">1.54. Tracked entity instance query</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e11283">1.54.1. Request syntax</a></span></dt><dt><span class="section"><a href="#d6099e11549">1.54.2. Response format</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e11568">1.55. Tracked entity instance grid query</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e11590">1.55.1. Request syntax</a></span></dt><dt><span class="section"><a href="#d6099e11935">1.55.2. Response format</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e11966">1.56. Enrollment instance query</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e11974">1.56.1. Request syntax</a></span></dt><dt><span class="section"><a href="#d6099e12170">1.56.2. Response format</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e12189">1.57. Tracker bulk deletion</a></span></dt><dt><span class="section"><a href="#d6099e12221">1.58. Email</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e12226">1.58.1. System notification</a></span></dt><dt><span class="section"><a href="#d6099e12240">1.58.2. Test message</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e12250">1.59. Sharing</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e12260">1.59.1. Get sharing status</a></span></dt><dt><span class="section"><a href="#d6099e12271">1.59.2. Set sharing status</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e12282">1.60. Scheduling</a></span></dt><dt><span class="section"><a href="#d6099e12332">1.61. Schema</a></span></dt><dt><span class="section"><a href="#d6099e12355">1.62. UI customization</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e12373">1.62.1. Javascript</a></span></dt><dt><span class="section"><a href="#d6099e12392">1.62.2. CSS</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e12411">1.63. Synchronization</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e12416">1.63.1. Data push</a></span></dt><dt><span class="section"><a href="#d6099e12423">1.63.2. Metadata pull</a></span></dt><dt><span class="section"><a href="#d6099e12433">1.63.3. Availability check</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e12440">1.64. Apps</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e12450">1.64.1. Get apps</a></span></dt><dt><span class="section"><a href="#d6099e12488">1.64.2. Install an app</a></span></dt><dt><span class="section"><a href="#d6099e12495">1.64.3. Delete an app</a></span></dt><dt><span class="section"><a href="#d6099e12502">1.64.4. Reload apps</a></span></dt><dt><span class="section"><a href="#d6099e12509">1.64.5. Configure apps</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e12534">1.65. App store</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e12542">1.65.1. Get apps</a></span></dt><dt><span class="section"><a href="#d6099e12553">1.65.2. Install apps</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e12569">1.66. Data store</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e12579">1.66.1. Data store structure</a></span></dt><dt><span class="section"><a href="#d6099e12628">1.66.2. Get keys and namespaces</a></span></dt><dt><span class="section"><a href="#d6099e12682">1.66.3. Create and update values</a></span></dt><dt><span class="section"><a href="#d6099e12713">1.66.4. Delete keys</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e12740">1.67. User data store</a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e12756">1.67.1. User data store structure</a></span></dt><dt><span class="section"><a href="#d6099e12814">1.67.2. Get namespaces</a></span></dt><dt><span class="section"><a href="#d6099e12830">1.67.3. Get keys</a></span></dt><dt><span class="section"><a href="#d6099e12847">1.67.4. Get value</a></span></dt><dt><span class="section"><a href="#d6099e12860">1.67.5. Add new value</a></span></dt><dt><span class="section"><a href="#d6099e12877">1.67.6. Update existing value</a></span></dt><dt><span class="section"><a href="#d6099e12890">1.67.7. Delete key</a></span></dt><dt><span class="section"><a href="#d6099e12903">1.67.8. Delete namespace</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e12916">1.68. Metadata repository</a></span></dt><dt><span class="section"><a href="#d6099e12943">1.69. FRED API</a></span></dt></dl></div><p>The Web API is a component which makes it possible for external systems to access and
    manipulate data stored in an instance of DHIS 2. More precisely, it provides a programmatic
    interface to a wide range of exposed data and service methods for applications such as
    third-party software clients, web portals and internal DHIS 2 modules.</p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e39"></a>1.1.&nbsp;Introduction</h2></div></div></div><p>The Web API adheres to many of the principles behind the REST architectural style. To
      mention some few and important ones:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>The fundamental building blocks are referred to as <span class="italic">resources</span>. A resource can be anything exposed to the Web, from a document to
          a business process - anything a client might want to interact with. The information
          aspects of a resource can be retrieved or exchanged through resource <span class="italic">representations</span>. A representation is a view of a
          resource's state at any given time. For instance, the <span class="italic">reportTable</span> resource in DHIS represents a tabular report of aggregated data
          for a certain set of parameters. This resource can be retrieved in a variety of
          representation formats including HTML, PDF, and MS Excel.</p></li><li class="listitem"><p>All resources can be uniquely identified by a <span class="italic">URI</span>
          (also referred to as <span class="italic">URL</span>). All resources have a default
          representation. You can indicate that you are interested in a specific representation by
          supplying an <span class="italic">Accept</span> HTTP header, a file extension or a
            <span class="italic">format</span> query parameter. So in order to retrieve the
          PDF representation of a report table you can supply a <span class="italic">Accept:
            application/pdf</span> header or append <span class="italic">.pdf</span> or
            <span class="italic">?format=pdf</span> to your request URL.</p></li><li class="listitem"><p>Interactions with the API requires correct use of HTTP <span class="italic">methods</span> or <span class="italic">verbs</span>. This implies that for a
          resource you must issue a <span class="italic">GET</span> request when you want to
          retrieve it, <span class="italic">POST</span> request when you want to create one,
            <span class="italic">PUT</span> when you want to update it and <span class="italic">DELETE</span> when you want to remove it. So if you want to retrieve
          the default representation of a report table you can send a GET request to e.g. <span class="italic">/reportTable/iu8j/hYgF6t</span>, where the last part is the report
          table identifier.</p></li><li class="listitem"><p>Resource representations are <span class="italic">linkable</span>, meaning that
          representations advertise other resources which are relevant to the current one by
          embedding links into itself (please be aware that you need to request <span class="italic">href</span> in your field filter to have this working. This feature
          greatly improves the usability and robustness of the API as we will see later. For
          instance, you can easily navigate to the indicators which are associated with a report
          table from the <span class="italic">reportTable</span> resource through the
          embedded links using your preferred representation format.</p></li></ol></div><p>While all of this might sound complicated, the Web API is actually very simple to use. We
      will proceed with a few practical examples in a minute.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e119"></a>1.2.&nbsp;Authentication</h2></div></div></div><p>The DHIS 2 Web API supports two protocols for authentication, Basic Authentication and
      OAuth 2. You can verify and get information about the currently authenticated user by making a
      GET request to the following URL:</p><pre class="screen">/api/me</pre><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e126"></a>1.2.1.&nbsp;Basic Authentication</h3></div></div></div><p>The DHIS 2 Web API supports <span class="italic">Basic authentication</span>.
        Basic authentication is a technique for clients to send login credentials over HTTP to a web
        server. Technically speaking, the username is appended with a colon and the password,
        Base64-encoded, prefixed Basic and supplied as the value of the <span class="italic">Authorization</span> HTTP header. More formally that is<code class="code"> Authorization: Basic
          base64encode(username:password)</code> Most network-aware development frameworks provides
        support for authentication using Basic, such as Apache HttpClient, Spring RestTemplate and
        C# WebClient. An important note is that this authentication scheme provides no security
        since the username and password is sent in plain text and can be easily decoded. Using it is
        recommended only if the server is using SSL/TLS (HTTPS) to encrypt communication between
        itself and the client. Consider it a hard requirement to provide secure interactions with
        the Web API.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e140"></a>1.2.2.&nbsp;OAuth2</h3></div></div></div><p>DHIS 2 support the OAuth2 protocol, which is an open standard for authorization, it
        allows 3rd party clients to connect on behalf of a DHIS 2 user, and get a re-usable bearer
        token for multiple requests to the web-api (without requiring getting the users permission
        again). We do not support fine-grained OAuth2 roles, rather we gives the application access
        based on the users DHIS 2 user role.</p><p>Each client for which you want to allow OAuth 2 authentication must be registered in
        DHIS 2. To add a new OAuth2 client, go to <span class="italic">settings =&gt; OAuth2
          Clients</span>, click add new and at least the name of client, and the grant types you
        want supported.</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="d6099e150"></a>1.2.2.1.&nbsp;Adding a client using the web-api</h4></div></div></div><p>An OAuth2 client can also be added through the Web API. As an example we can send a
          payload like
          this:</p><pre class="screen">{
   "name" : "OAuth2 Demo Client",
   "cid" : "demo",
   "secret" : "1e6db50c-0fee-11e5-98d0-3c15c2c6caf6",
   "grantTypes" : [
      "password",
      "refresh_token",
      "authorization_code"
   ],
   "redirectUris" : [
      "http://www.example.org"
   ]
}</pre><pre class="screen">SERVER="https://play.dhis2.org/dev"
curl -X POST -H "Content-Type: application/json" -d @client.json -u admin:district $SERVER/api/oAuth2Clients</pre><p>We will use this client as the basis for our next grant type examples.</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="d6099e161"></a>1.2.2.2.&nbsp;Grant type password</h4></div></div></div><p>The simplest of all grant types is the <span class="bold"><strong>password</strong></span> grant
          type. This grant type is similar to basic authenticaion in the sense that it requires the
          client to collect the users username and password. As an example we can use our demo
          server:</p><p>
          </p><pre class="screen">SERVER="https://play.dhis2.org/dev"
SECRET="1e6db50c-0fee-11e5-98d0-3c15c2c6caf6"

curl -X POST -H "Accept: application/json" -u demo:$SECRET $SERVER/uaa/oauth/token
-d grant_type=password -d username=admin -d password=district</pre><p>
        </p><p>This will give you a response similar to
          this:</p><pre class="screen">{
   "expires_in" : 43175,
   "scope" : "ALL",
   "access_token" : "07fc551c-806c-41a4-9a8c-10658bd15435",
   "refresh_token" : "a4e4de45-4743-481d-9345-2cfe34732fcc",
   "token_type" : "bearer"
}</pre><p>For now, we will concentrate on the <span class="bold"><strong>access_token</strong></span>,
          which is what we will use as our authentication (bearer) token. As an example we will get
          all data elements using our
          token:</p><pre class="screen">SERVER="https://play.dhis2.org/dev"
curl -H "Authorization: Bearer 07fc551c-806c-41a4-9a8c-10658bd15435" $SERVER/api/dataElements.json</pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="d6099e185"></a>1.2.2.3.&nbsp;Grant type refresh_token</h4></div></div></div><p>In general the access tokens have limited validity. You can have a look at the
            <span class="bold"><strong>expires_in</strong></span> property of the response in the previous
          example to understand when a token expires. To get a fresh <span class="bold"><strong>access_token</strong></span> you can make another roundtrip to the server and use <span class="bold"><strong>refresh_token</strong></span> which allows you to get an updated token without
          needing to ask for the user credentials one more
          time.</p><pre class="screen">SERVER="https://play.dhis2.org/dev"
SECRET="1e6db50c-0fee-11e5-98d0-3c15c2c6caf6"
REFRESH_TOKEN="a4e4de45-4743-481d-9345-2cfe34732fcc"

curl -X POST -H "Accept: application/json" -u demo:$SECRET $SERVER/uaa/oauth/token
-d grant_type=refresh_token -d refresh_token=$REFRESH_TOKEN</pre><p>The response will be exactly the same as when you get an token to start with.</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="d6099e203"></a>1.2.2.4.&nbsp;Grant type authorization_code</h4></div></div></div><p>Authorized code grant type is the recommended approach if you don't want to store
          the user credentials externally. It allows DHIS 2 to collect the username/password
          directly from the user instead of the client collecting them and then authenticating on
          behalf of the user. Please be aware that this approach uses the <span class="bold"><strong>redirect_uris</strong></span> part of the client payload.</p><p>Step 1 - Using a browser visit this URL (if you have more than one redirect URIs, you
          might want to add &amp;redirect_uri=http://www.example.org)
          :</p><pre class="screen">SERVER="https://play.dhis2.org/dev"

$SERVER/uaa/oauth/authorize?client_xml:id=demo&amp;response_type=code</pre><p>Step 2 - After the user have successfully logged in and accepted your client access,
          it will redirect back to your redirect uri like
          this:</p><pre class="screen">http://www.example.org/?code=XYZ</pre><p>Step 3 - This step is similar to what we did in the password grant type, using the
          given code, we will now ask for a access
          token:</p><pre class="screen">SERVER="https://play.dhis2.org/dev"
SECRET="1e6db50c-0fee-11e5-98d0-3c15c2c6caf6"

curl -X POST -u demo:$SECRET -H "Accept: application/json" $SERVER/token -d grant_type=authorization_code -d code=XYZ</pre></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e223"></a>1.3.&nbsp;Error and info messages</h2></div></div></div><p>The Web API uses a consistent format for all error/warning and informational
      messages:</p><pre class="screen">{
   "httpStatus" : "Forbidden",
   "message" : "You don't have the proper permissions to read objects of this type.",
   "httpStatusCode" : 403,
   "status" : "ERROR"
}</pre><p>Here we can see from the message that the user tried to access a resource I did not have
      access to. It uses the http status code 403, the http status message <span class="bold"><strong>forbidden</strong></span> and a descriptive message.</p><div class="table"><a name="d6099e235"></a><p class="title"><b>Table&nbsp;1.1.&nbsp;WebMessage properties</b></p><div class="table-contents"><table class="table" summary="WebMessage properties" border="1"><colgroup><col class="c1"><col class="c3"></colgroup><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td>httpStatus</td><td>HTTP Status message for this response, see RFC 2616 (Section 10) for more
                information.</td></tr><tr><td>httpStatusCode</td><td>HTTP Status code for this response, see RFC 2616 (Section 10) for more
                information.</td></tr><tr><td>status</td><td>DHIS 2 status, possible values are <span class="italic">OK</span>
                  |&nbsp;<span class="italic">WARNING</span> |&nbsp;<span class="italic">ERROR</span>, where <span class="bold"><strong>OK</strong></span> is means everything
                was successful, <span class="bold"><strong>ERROR</strong></span> means that operation did not
                complete and <span class="bold"><strong>WARNING</strong></span> means operation was partially
                successful, if there message contains a <span class="bold"><strong>response</strong></span>
                property, please look there for more information.</td></tr><tr><td>message</td><td>A user friendly message telling whether the operation was a success or
                not.</td></tr><tr><td>devMessage</td><td>A more techincal developer friendly message (not currently in use).</td></tr><tr><td>response</td><td>Extension point for future extension to the WebMessage format. This will be
                documented when it starts being used.</td></tr></tbody></table></div></div><p><br class="table-break">
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e300"></a>1.4.&nbsp;Date and period format</h2></div></div></div><p>Throughout the Web API we refer to dates and periods. The date format is:</p><pre class="screen">yyyy-MM-dd</pre><p>For instance, if you want to express March 20, 2014 you must use <span class="italic">2014-03-20</span>.</p><p>The period format is described in the following table. </p><div class="table"><a name="d6099e314"></a><p class="title"><b>Table&nbsp;1.2.&nbsp;Period format</b></p><div class="table-contents"><table class="table" summary="Period format" border="1"><colgroup><col width="60pt" class="c1"><col width="80pt" class="c2"><col width="80pt" class="c3"><col width="200pt" class="c4"></colgroup><thead><tr><th> Interval </th><th> Format </th><th> Example </th><th> Description </th></tr></thead><tbody><tr><td>Day</td><td>
              <span class="emphasis"><em>yyyyMMdd</em></span>
            </td><td>20040315</td><td>March 15 2004</td></tr><tr><td>Week</td><td><span class="emphasis"><em>yyyy</em></span>W<span class="emphasis"><em>n</em></span></td><td>2004W10</td><td>Week 10 2004</td></tr><tr><td>Month</td><td>
              <span class="emphasis"><em>yyyyMM</em></span>
            </td><td>200403</td><td>March 2004</td></tr><tr><td>Quarter</td><td><span class="emphasis"><em>yyyy</em></span>Q<span class="emphasis"><em>n</em></span></td><td>2004Q1</td><td>January-March 2004</td></tr><tr><td>Six-month</td><td><span class="emphasis"><em>yyyy</em></span>S<span class="emphasis"><em>n</em></span></td><td>2004S1</td><td>January-June 2004</td></tr><tr><td>Six-month April</td><td><span class="emphasis"><em>yyyy</em></span>AprilSn</td><td>2004AprilS1</td><td>April-September 2004</td></tr><tr><td>Year</td><td>yyyy</td><td>2004</td><td>2004</td></tr><tr><td>Financial Year April</td><td>yyyyApril</td><td>2004April</td><td>Apr 2004-Mar 2005</td></tr><tr><td>Financial Year July</td><td>yyyyJuly</td><td>2004July</td><td>July 2004-June 2005</td></tr><tr><td>Financial Year Oct</td><td>yyyyOct</td><td>2004Oct</td><td>Oct 2004-Sep 2005</td></tr></tbody></table></div></div><br class="table-break"><p>In some parts of the API, like for the analytics resource, you can utilize relative
      periods in addition to fixed periods (defined above). The relative periods are relative to the
      current date, and allows e.g. for creating dynamic reports. The available relative period
      values are:</p><pre class="screen">THIS_WEEK, LAST_WEEK, LAST_4_WEEKS, LAST_12_WEEKS, LAST_52_WEEKS,
THIS_MONTH, LAST_MONTH, THIS_BIMONTH, LAST_BIMONTH, THIS_QUARTER, LAST_QUARTER,
THIS_SIX_MONTH, LAST_SIX_MONTH, MONTHS_THIS_YEAR, QUARTERS_THIS_YEAR,
THIS_YEAR, MONTHS_LAST_YEAR, QUARTERS_LAST_YEAR, LAST_YEAR, LAST_5_YEARS, LAST_12_MONTHS,
LAST_3_MONTHS, LAST_6_BIMONTHS, LAST_4_QUARTERS, LAST_2_SIXMONTHS, THIS_FINANCIAL_YEAR,
LAST_FINANCIAL_YEAR, LAST_5_FINANCIAL_YEARS</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e447"></a>1.5.&nbsp;Identifier Schemes</h2></div></div></div><p>Throughout the Web API we refer to different kinds of id schemes, this section will give a
      explanation to how they can be used. Please note that not all schemes works for all web-api
      calls, and not not all schemes can be used for both input and output (this is outlined in the
      sections explaining the web-apis themself). Setting the <span class="italic">idScheme</span> allows you to override the default for <span class="italic">all</span> schemes, but if other schemes are declared like <span class="italic">dataElementIdScheme</span> this this will be used instead.</p><p>The full range of scheme parameters available
      are:</p><pre class="screen">idScheme, dataElementIdScheme, categoryOptionComboIdScheme, orgUnitIdScheme,
programIdScheme, programStageIdScheme, trackedEntityIdScheme, trackedEntityAttributeIdScheme</pre><p>The default scheme for all parameters are what we call the <span class="italic">stable
        identifiers</span> i.e. UIDs, but we also have different schemes depending on how you
      want object matching to behave.</p><div class="table"><a name="d6099e470"></a><p class="title"><b>Table&nbsp;1.3.&nbsp;Scheme Values</b></p><div class="table-contents"><table class="table" summary="Scheme Values" border="1"><colgroup><col class="c1"><col class="c2"></colgroup><thead><tr><th>Scheme</th><th>Description</th></tr></thead><tbody><tr><td>ID, UID</td><td>Match on DHIS 2 stable Identifier, this is the default id scheme.</td></tr><tr><td>CODE</td><td>Match on DHIS 2 Code, mainly used to exchange data with an external
                system.</td></tr><tr><td>NAME</td><td>Match on DHIS 2 Name, please not that this uses what is available as <span class="italic">object.name</span>, and not the translated name. Also not that
                names are not always unique, and in that case they can not be used.</td></tr><tr><td>ATTRIBUTE:ID</td><td>Match on metadata attribute, this attribute needs to be assigned to the type
                you are matching on, and also that the unique property is set to <span class="italic">true</span>. The main usage of this is also to exchange data
                with external systems, it has some advantages over <span class="italic">CODE</span> since multiple attributes can be added, so it can be used to
                synchronize with more than one system.</td></tr></tbody></table></div></div><p><br class="table-break"></p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e512"></a>1.6.&nbsp;Browsing the Web API</h2></div></div></div><p>The entry point for browsing the Web API is <span class="italic">/api/</span>. This
      resource provide links to all available resources. Four resource representation formats are
      consistently available for all resources: HTML, XML, JSON and JSONP. Some resources will have
      other formats available, like MS Excel, PDF, CSV and PNG. To explore the API from a web
      browser, navigate to the <span class="italic">/api/</span> entry point and follow the
      links to your desired resource, for instance <span class="italic">/api/dataElements</span>. For all resources which return a list of elements certain
      query parameters can be used to modify the response:</p><p>
      </p><div class="table"><a name="d6099e528"></a><p class="title"><b>Table&nbsp;1.4.&nbsp;Query parameters</b></p><div class="table-contents"><table class="table" summary="Query parameters" border="1"><colgroup><col class="c1"><col class="c2"><col class="c3"><col class="c4"></colgroup><thead><tr><th>Param</th><th>Option values</th><th>Default option</th><th>Description</th></tr></thead><tbody><tr><td>paging</td><td>true | false</td><td>true</td><td>Indicates whether to return lists of elements in pages.</td></tr><tr><td>page</td><td>number</td><td>1</td><td>Defines which page number to return.</td></tr><tr><td>pageSize</td><td>number</td><td>50</td><td>Defines the number of elements to return for each page.</td></tr><tr><td>order</td><td>property:asc/iasc/desc/idesc</td><td>&nbsp;</td><td>Order the output using a specified order, only properties that are both
                persisted and simple (no collections, idObjects etc) are supported. iasc and idesc
                are case insensitive sorting.</td></tr></tbody></table></div></div><p><br class="table-break">
    </p><p>An example of how these parameters can be used to get a full list of data element groups
      in XML response format is:</p><pre class="screen">/api/dataElementGroups.xml?links=false&amp;paging=false</pre><p>You can query for elements on the name property instead of returning full list of elements
      using the <span class="italic">query</span> query variable. In this example we query
      for all data elements with the word "anaemia" in the name:</p><pre class="screen">/api/dataElements?query=anaemia</pre><p>You can find an object based on its ID across all object types through the <span class="italic">identifiableObjects</span> resource:</p><pre class="screen">/api/identifiableObjects/&lt;id&gt;</pre><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e601"></a>1.6.1.&nbsp;Translation</h3></div></div></div><p>Support for I18n translation in the web-api was added in 2.19 release. It is supported
        by two parameters:</p><div class="table"><a name="d6099e606"></a><p class="title"><b>Table&nbsp;1.5.&nbsp;Translate options</b></p><div class="table-contents"><table class="table" summary="Translate options" border="1"><colgroup><col class="c1"><col class="newCol2"><col class="c2"></colgroup><thead><tr><th>Parameter</th><th>Values</th><th>Description</th></tr></thead><tbody><tr><td>translate</td><td>true | false</td><td>Translate display* properties in metadata output (displayName,
                  displayShortName, displayDescription, and displayFormName for data
                  elements)</td></tr><tr><td>locale</td><td>Locale to use</td><td>Translate metadata output using a specified locale (implies
                  translate=true)</td></tr></tbody></table></div></div><p><br class="table-break"></p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e636"></a>1.7.&nbsp;Working with the metadata API</h2></div></div></div><p>The metadata resource can be accessed at <span class="italic">/api/metadata</span>.
      This resource lets you read and write the full set of metadata. This section will give a basic
      introduction to working with this API. For specific synchronization issues, please see the
      integration chapter.</p><p>By default, interacting with<span class="italic"> /api/metadata</span> using the
      GET HTTP method will give you all metadata rendered as XML. You can also be more specific
      about the metadata elements you are interested in.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e649"></a>1.7.1.&nbsp;Content types</h3></div></div></div><p>The Web API offers several content types for metadata.</p><p>
        </p><div class="table"><a name="d6099e656"></a><p class="title"><b>Table&nbsp;1.6.&nbsp;Available Content-Types</b></p><div class="table-contents"><table class="table" summary="Available Content-Types" border="1"><colgroup><col class="c1"><col class="newCol2"><col class="c2"></colgroup><thead><tr><th> Content-Type </th><th>URL extension</th><th> Description </th></tr></thead><tbody><tr><td>application/xml</td><td>.xml</td><td>Returns the metadata in XML representation</td></tr><tr><td>application/json</td><td>.json</td><td>Returns the metadata in JSON representation</td></tr><tr><td>application/pdf</td><td>.pdf</td><td>Returns the metadata as a PDF document</td></tr><tr><td>application/csv</td><td>.csv</td><td>Returns the metadata as a CSV file</td></tr><tr><td>application/vnd.ms-excel</td><td>.xls | .xlsx</td><td>Returns the metadata as an Excel workbook</td></tr></tbody></table></div></div><p><br class="table-break">
      </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e708"></a>1.7.2.&nbsp;Query parameters</h3></div></div></div><p>The following query parameters are available for customizing your request.</p><p>
        </p><div class="table"><a name="d6099e715"></a><p class="title"><b>Table&nbsp;1.7.&nbsp;Available Query Filters</b></p><div class="table-contents"><table class="table" summary="Available Query Filters" border="1"><colgroup><col><col><col><col><col></colgroup><thead><tr><th> Param </th><th> Type </th><th> Required </th><th> Options (default first) </th><th> Description </th></tr></thead><tbody><tr><td>assumeTrue</td><td>boolean</td><td>false</td><td>true | false</td><td>Indicates whether to get all resources or no resources by default.</td></tr><tr><td>viewClass</td><td>enum</td><td>false</td><td>export | basic | detailed</td><td>Alternative views of the metadata. Please note that only metadata exported
                  with viewClass=export or detailed can be used for import.</td></tr><tr><td>dryRun</td><td>boolean</td><td>false</td><td>false | true</td><td>If you set this to true, the actual import will not happen. Instead the
                  system will generate a summary of what would have been done.</td></tr><tr><td>{resources}</td><td>boolean</td><td>false</td><td>true | false (default depends on assumeTrue)</td><td>See <span class="italic">/api</span> for available resources.
                  Indicates which resources to include in the response.</td></tr><tr><td>lastUpdated</td><td>date</td><td>false</td><td>Several formats are available: yyyy, yyyy-MM, yyyy-MM-dd, yyyyMM,
                  yyyyMMdd</td><td>Filters the metadata based on the lastUpdated field.</td></tr><tr><td>preheatCache</td><td>boolean</td><td>false</td><td>true | false</td><td>Turn cache-map preheating on/off. This is on by default, turning this off
                  will make initial load time for importer much shorter (but will make the import
                  itself slower). This is mostly used for cases where you have a small XML/JSON file
                  you want to import, and don't want to wait for cache-map preheating.</td></tr><tr><td>strategy</td><td>enum</td><td>false</td><td>CREATE_AND_UPDATE | CREATE | UPDATE | DELETE</td><td>Import strategy to use, see below for more information.</td></tr><tr><td>sharing</td><td>boolean</td><td>false</td><td>false |&nbsp;true</td><td>Should sharing be supported or not. The default is false, which is the old
                  behavior. You can set this to true to allow updating user, publicAccess and
                  userGroupAccesses fields (if not they are cleared out on create, and not touched
                  on update).</td></tr><tr><td>mergeStrategy</td><td>enum</td><td>false</td><td>REPLACE, MERGE</td><td>Strategy for merging of objects when doing updates. REPLACE will just
                  overwrite the propery with the new value provided, MERGE will only set the
                  property if its not null (only if the property was provided).</td></tr><tr><td>async</td><td>boolean</td><td>false</td><td>false |&nbsp;true</td><td>Indicates wether the import should be done async or not, the default is false
                  which means the client will wait until the import is done, this is probably what
                  you want for small imports (as you will get the import summary directly back to
                  you). For large imports, the client might time out, so async=true is recommended,
                  and the client connection will be dropped when the payload is uploaded.</td></tr></tbody></table></div></div><p><br class="table-break">
      </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e846"></a>1.7.3.&nbsp;Available strategies for import</h3></div></div></div><p>When importing data using the metadata resource you can define various strategies for
        import.</p><p>
        </p><div class="table"><a name="d6099e853"></a><p class="title"><b>Table&nbsp;1.8.&nbsp;Available Strategies</b></p><div class="table-contents"><table class="table" summary="Available Strategies" border="1"><colgroup><col><col></colgroup><thead><tr><th> Type </th><th> Description </th></tr></thead><tbody><tr><td>CREATE_AND_UPDATE</td><td>Allows creation and updating of objects.</td></tr><tr><td>CREATE</td><td>Allows creation of objects only.</td></tr><tr><td>UPDATE</td><td>Allows update of objects only.</td></tr><tr><td>DELETE</td><td>Allows deletes of objects only.</td></tr></tbody></table></div></div><p><br class="table-break">
      </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e885"></a>1.7.4.&nbsp;Examples</h3></div></div></div><p>
        <span class="bold"><strong>Example: Get a filtered set of metadata that was updated since August
          1, 2014</strong></span>
      </p><p>As described in the last section, there is a number of options you can apply to
          <span class="italic">/api/metadata</span> to give you a filtered view. The use-case
        we will be looking into here is where you want a nightly job that synchronizes organisation
        units. We will be using <span class="italic">cURL</span> as the HTTP
        client.</p><pre class="screen">curl -H "Accept: application/xml" -u admin:district
  "https://play.dhis2.org/demo/api/metadata?assumeTrue=false&amp;organisationUnits=true&amp;lastUpdated=2014-08-01"</pre><p><span class="bold"><strong>Example: Get metadata that was updated since February
          2014</strong></span></p><p>This example will just the default <span class="italic">assumeTrue</span>
        setting, along with getting the last updates from February 2014. This means that every
        single type that has been updated will be
        retrieved.</p><pre class="screen">curl -H "Accept: application/xml" -u admin:district "https://play.dhis2.org/demo/api/metadata?lastUpdated=2014-02"</pre><p><span class="bold"><strong>Example: Create metadata</strong></span></p><p>The metadata resource can also be used to create or update metadata by using the POST
        HTTP method. The metadata content can be both XML and JSON, using
        "application/xml" and "application/json" content type respectively. The
        request payload content will be accepted in several formats, including plain text, zipped
        and gzipped. POSTing a metadata payload can be done for example like this, where
        metadata.xml is a file in the same directory with the metadata content:</p><pre class="screen">curl -H "Content-Type: application/xml" -u admin:district -d @metadata.xml "https://play.dhis2.org/demo/api/metadata" -X POST -v</pre><p>The import will happen in a asyncronous process which implies that the response will
        return as soon as the process is started. The response status code to be expected is 204 No
        Content.</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e922"></a>1.8.&nbsp;Metadata object filter</h2></div></div></div><p>To filter the metadata there are several filter operations that can be applied to the
      returned list of metadata. The format of the filter itself is straight-forward and follows the
      pattern <span class="italic">property:operator:value</span>, where <span class="italic">property</span> is the property on the metadata you want to filter on,
        <span class="italic">operator</span> is the comparison operator you want to perform
      and <span class="italic">value</span> is the value to check against (not all operators
      require value). Please see the <span class="italic">schema</span> section to discover
      which properties are available. Recursive filtering, ie. filtering on associated objects or
      collection of objects, are supported as well.</p><div class="table"><a name="d6099e942"></a><p class="title"><b>Table&nbsp;1.9.&nbsp;Available Operators</b></p><div class="table-contents"><table class="table" summary="Available Operators" border="1"><colgroup><col><col><col><col></colgroup><thead><tr><th>Operator</th><th>Types</th><th>Value required</th><th>Description</th></tr></thead><tbody><tr><td>eq</td><td> string | boolean | integer | float | enum |&nbsp;collection (checks for size)
                | date </td><td>true</td><td>Equality</td></tr><tr><td>!eq</td><td> string | boolean | integer | float | enum |&nbsp;collection (checks for size)
                | date </td><td>true</td><td>Inequality</td></tr><tr><td>ne</td><td> string | boolean | integer | float | enum |&nbsp;collection (checks for size)
                | date </td><td>true</td><td>Inequality</td></tr><tr><td>like</td><td> string</td><td>true</td><td>Case sensitive string, match anywhere</td></tr><tr><td>!like</td><td>string</td><td>true</td><td>Case sensitive string, not match anywhere</td></tr><tr><td>^like</td><td>string</td><td>true</td><td>Case sensitive string, match start</td></tr><tr><td>!^like</td><td>string</td><td>true</td><td>Case sensitive string, not match start</td></tr><tr><td>$like</td><td>string</td><td>true</td><td>Case sensitive string, match end</td></tr><tr><td>!$like</td><td>string</td><td>true</td><td>Case sensitive string, not match end</td></tr><tr><td>ilike</td><td>string</td><td>true</td><td>Case insensitive string, match anywhere</td></tr><tr><td>!ilike</td><td>string</td><td>true</td><td>Case insensitive string, not match anywhere</td></tr><tr><td>^ilike</td><td>string</td><td>true</td><td>Case insensitive string, match start</td></tr><tr><td>!^ilike</td><td>string</td><td>true</td><td>Case insensitive string, not match start</td></tr><tr><td>$ilike</td><td>string</td><td>true</td><td>Case insensitive string, match end</td></tr><tr><td>!$ilike</td><td>string</td><td>true</td><td>Case insensitive string, not match end</td></tr><tr><td>gt</td><td> string | boolean | integer | float | collection (checks for size) | date </td><td>true</td><td>Greater than</td></tr><tr><td>ge</td><td> string | boolean | integer | float | collection (checks for size) | date </td><td>true</td><td>Greater than or equal</td></tr><tr><td>lt</td><td> string | boolean | integer | float | collection (checks for size) | date </td><td>true</td><td>Less than</td></tr><tr><td>le</td><td> string | boolean | integer | float | collection (checks for size) | date </td><td>true</td><td>Less than or equal</td></tr><tr><td>null</td><td> all</td><td>false</td><td>Property is null</td></tr><tr><td>!null</td><td>all</td><td>false</td><td>Property is not null</td></tr><tr><td>empty</td><td> collection</td><td>false</td><td>Collection is empty</td></tr><tr><td>in</td><td> string | boolean | integer | float | date</td><td>true</td><td>Find objects matching 1 or more values</td></tr><tr><td>!in</td><td> string | boolean | integer | float | date</td><td>true</td><td>Find objects not matching 1 or more values</td></tr></tbody></table></div></div><p><br class="table-break"></p><p>Operators will be applied as logical <span class="bold"><strong>and</strong></span> query, if you
      need a <span class="bold"><strong>or</strong></span> query, you can have a look at our <span class="italic">in</span> filter. The filtering mechanism allows for recursion. See below
      for some examples.</p><p>Get data elements with id property ID1 or
      ID2:</p><pre class="screen">/api/dataElements?filter=id:eq:ID1&amp;filter=id:eq:ID2</pre><p>Get all data elements which has the dataSet with id
      ID1:</p><pre class="screen">/api/dataElements?filter=dataSets.id:eq:ID1</pre><p>Get all data elements with aggregation operator "sum" and value type
      "int":</p><pre class="screen">/api/dataElements.json?filter=aggregationOperator:eq:sum&amp;filter=type:eq:int</pre><p>You can do filtering within collections, e.g. to get data elements which are members of
      the "ANC" data element group you can use the following query using the id property
      of the associated data element
      groups:</p><pre class="screen">/api/dataElements.json?filter=dataElementGroups.id:eq:qfxEYY9xAl6</pre><p>Since all operators are <span class="bold"><strong>and</strong></span> by default, you can't
      find a data element matching more than one id, for that purpose you can use the <span class="italic">in</span>
      operator.</p><pre class="screen">/api/dataElements.json?filter=id:in:[fbfJHSPpUQD,cYeuwXTCPkU]</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e1210"></a>1.9.&nbsp;Metadata field filter</h2></div></div></div><p>In certain situations the default views of the metadata can be too verbose. A client might
      only need a few fields from each object and want to remove unnecessary fields from the
      response. To discover which fields are available for each object please see the <span class="italic">schema</span> section.</p><p>The format for include/exclude is very simple and allows for infinite recursion. To filter
      at the "root" level you can just use the name of the field, i.e. <span class="italic">?fields=id,name</span> which would only display the <span class="italic">id</span> and <span class="italic">name</span> for every object.
      For objects that are either collections or complex objects with properties on their own you
      can use the format <span class="italic">?fields=id,name,dataSets[id,name]</span> which
      would return <span class="italic">id</span>, <span class="italic">name</span> of
      the root, and the <span class="italic">id</span> and <span class="italic">name</span> of every data set on that object. Negation can be done with the exclamation
      operator, and we have a set of presets of field select (see below). Both XML and JSON are
      supported.</p><p><span class="bold"><strong>Example</strong></span>: Get <span class="italic">id</span> and
        <span class="italic">name</span> on the indicators
      resource:</p><pre class="screen">/api/indicators?fields=id,name</pre><p><span class="bold"><strong>Example</strong></span>: Get <span class="italic">id</span> and
        <span class="italic">name</span> from dataElements, and <span class="italic">id</span> and <span class="italic">name</span> from the dataSets on
      dataElements:</p><pre class="screen">/api/dataElements?fields=id,name,dataSets[id,name]</pre><p>To exclude a field from the output you can use the exclamation (!) operator. This is
      allowed anywhere in the query and will simply not include that property (as it might have been
      inserted in some of the presets).</p><p>A few presets (selected fields groups) are available and can be applied using the
      ':' operator.</p><div class="table"><a name="d6099e1278"></a><p class="title"><b>Table&nbsp;1.10.&nbsp;Property operators</b></p><div class="table-contents"><table class="table" summary="Property operators" border="1"><colgroup><col class="c1"><col class="c2"></colgroup><thead><tr><th>Operator</th><th>Description</th></tr></thead><tbody><tr><td>&lt;field-name&gt;</td><td>Include property with name, if it exists.</td></tr><tr><td>&lt;object&gt;[&lt;field-name&gt;, ...]</td><td>Includes a field within either a collection (will be applied to every object in
                that collection), or just on a single object.</td></tr><tr><td>!&lt;field-name&gt;, &lt;object&gt;[!&lt;field-name&gt;</td><td>Do not include this field name, also works inside objects/collections. Useful
                when you use a preset to inlude fields.</td></tr><tr><td>*, &lt;object&gt;[*]</td><td>Include all fields on a certain object, if applied to a collection, it will
                include all fields on all objects on that collection.</td></tr><tr><td>:&lt;preset&gt;</td><td>Alias to select multiple fields. Three presets are currently available, see
                table below for descriptions.</td></tr></tbody></table></div></div><p><br class="table-break"></p><div class="table"><a name="d6099e1316"></a><p class="title"><b>Table&nbsp;1.11.&nbsp;Field presets</b></p><div class="table-contents"><table class="table" summary="Field presets" border="1"><colgroup><col class="c1"><col class="c2"></colgroup><thead><tr><th>Preset</th><th>Description</th></tr></thead><tbody><tr><td>all</td><td>All fields of the object</td></tr><tr><td>*</td><td>Alias for all</td></tr><tr><td>identifiable</td><td>Includes id, name, code, created and lastUpdated fields</td></tr><tr><td>nameable</td><td>Includes id, name, shortName, code, description, created and lastUpdated
              fields</td></tr><tr><td>persisted</td><td>Returns all persisted property on a object, does not take into consideration if
              the object is the owner of the relation.</td></tr><tr><td>owner</td><td>Returns all persisted property on a object where the object is the owner of all
              properties, this payload can be used to update through the web-api.</td></tr></tbody></table></div></div><br class="table-break"><p><span class="bold"><strong>Example</strong></span>: Include all fields from dataSets except
      organisationUnits:</p><pre class="screen">/api/dataSets?fields=:all,!organisationUnits</pre><p><span class="bold"><strong>Example</strong></span>: Include only id, name and the collection of
      organisation units from a data set, but exclude the id from organisation
      units:</p><pre class="screen">/api/dataSets/BfMAe6Itzgt?fields=id,name,organisationUnits[:all,!id]</pre><p><span class="bold"><strong>Example</strong></span>: Include nameable properties from all
      indicators:</p><pre class="screen">/api/indicators.json?fields=:nameable</pre><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e1377"></a>1.9.1.&nbsp;Field transformers</h3></div></div></div><p>In DHIS 2.17 we introduced field transformers, the idea is to allow further
        customization of the properties on the server side. For 2.17 we only supports one
        transformer called <span class="bold"><strong>rename</strong></span>, it can be used like
        this:</p><pre class="screen">/api/dataElements/ID?fields=id|rename(i),name|rename(n)</pre><p>This will rename the <span class="italic">id</span> property to <span class="italic">i</span> and <span class="italic">name</span> property to
          <span class="italic">n</span>. <span class="italic">Please note that the format
          should be considered beta in 2.17, and the format might be changed in
        2.18.</span></p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e1403"></a>1.9.2.&nbsp;Field converters</h3></div></div></div><p>In DHIS 2.17 alongside transformers we also introduced field converters, while field
        transformers usually do minor changes to the data stream (name changes etc), field
        converters can completely change the output of the data. For 2.17 we are including 3 field
          converters:</p><div class="table"><a name="d6099e1408"></a><p class="title"><b>Table&nbsp;1.12.&nbsp;Field converters</b></p><div class="table-contents"><table class="table" summary="Field converters" border="1"><colgroup><col class="c1"><col class="c2"></colgroup><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td>size</td><td>Gives sizes of strings (length) and collections, i.e.
                  /api/dataElements?fields=dataSets::size</td></tr><tr><td>isEmpty</td><td>Is string or collection empty, i.e.
                  /api/dataElements?fields=dataSets::isEmpty</td></tr><tr><td>isNotEmpty</td><td>Is string or collection not empty, i.e.
                  /api/dataElements?fields=dataSets::isNotEmpty</td></tr></tbody></table></div></div><p><br class="table-break"></p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e1436"></a>1.10.&nbsp;Metadata create, read, update, delete, validate</h2></div></div></div><p>While some of the web-api endpoints already contains support for CRUD (create, read,
      update, delete), from version 2.15 this is now supported on all endpoints. It should work as
      you expect, and the subsections will give more detailed information about create, update, and
      delete (read is already covered elsewhere, and have been supported for a long time).</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e1441"></a>1.10.1.&nbsp;Create / update parameters</h3></div></div></div><p>The following query parameters are available for customizing your request.</p><p>
        </p><div class="table"><a name="d6099e1448"></a><p class="title"><b>Table&nbsp;1.13.&nbsp;Available Query Filters</b></p><div class="table-contents"><table class="table" summary="Available Query Filters" border="1"><colgroup><col><col><col><col><col></colgroup><thead><tr><th> Param </th><th> Type </th><th> Required </th><th> Options (default first) </th><th> Description </th></tr></thead><tbody><tr><td>preheatCache</td><td>boolean</td><td>false</td><td>true | false</td><td>Turn cache-map preheating on/off. This is on by default, turning this off
                  will make initial load time for importer much shorter (but will make the import
                  itself slower). This is mostly used for cases where you have a small XML/JSON file
                  you want to import, and don't want to wait for cache-map preheating.</td></tr><tr><td>strategy</td><td>enum</td><td>false</td><td>CREATE_AND_UPDATE | CREATE | UPDATE | DELETE</td><td>Import strategy to use, see below for more information.</td></tr><tr><td>mergeStrategy</td><td>enum</td><td>false</td><td>REPLACE, MERGE</td><td>Strategy for merging of objects when doing updates. REPLACE will just
                  overwrite the propery with the new value provided, MERGE will only set the
                  property if its not null (only if the property was provided).</td></tr></tbody></table></div></div><p><br class="table-break">
      </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e1499"></a>1.10.2.&nbsp;Creating and updating objects</h3></div></div></div><p>For creating new objects you will need to know the endpoint, the type format, and make
        sure that you have the required authorities. As an example , we will create and update an
          <span class="italic">constant</span>. To figure out the format, we can use the new
          <span class="italic">schema</span> endpoint for getting format description. So we
        will start with getting that
        info:</p><pre class="screen">http://&lt;&lt;server&gt;&gt;/api/schemas/constant.json</pre><p> From the
        output, you can see that the required authorities for create are F_CONSTANT_ADD, and the
        important properties are: <span class="italic">name</span> and <span class="italic">value</span>. From this we can create a JSON payload and save it as a
        file called
        constant.json:</p><pre class="screen">{
  "name": "PI",
  "value": "3.14159265359"
}</pre><p>The same content as an XML
        payload:</p><pre class="screen">&lt;constant name="PI" xmlns="http://dhis2.org/schema/dxf/2.0"&gt;
  &lt;value&gt;3.14159265359&lt;/value&gt;
&lt;/constant&gt;</pre><p>We are now ready create the new <span class="italic">constant</span> by sending a
        POST request to the <span class="italic">constants </span>endpoint with the JSON
        payload using curl:
        </p><pre class="screen">curl -d @constant.json "http://server/api/constants" -X POST 
-H "Content-Type: application/json" -u user:password</pre><p>A specific example of posting the constant to the demo server:
        </p><pre class="screen">curl -d @constant.json "https://play.dhis2.org/api/constants" -X POST 
-H "Content-Type: application/json" -u admin:district</pre><p>If everything went well, you should see an output similar
        to:</p><pre class="screen">{
  "status":"SUCCESS",
  "importCount":{"imported":1,"updated":0,"ignored":0,"deleted":0},
  "type":"Constant"
}</pre><p>The process will be exactly the same for updating, you make your changes to the JSON/XML
        payload, find out the <span class="italic">ID</span> of the constant, and then send a
        PUT request to the endpoint including
        ID:</p><pre class="screen">curl -X PUT -d @pi.json -H "Content-Type: application/json" 
-u user:password http://server/api/constants/ID</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e1550"></a>1.10.3.&nbsp;Deleting objects</h3></div></div></div><p>Deleting objects are very straight forward, you will need to know the <span class="italic">ID</span> and the endpoint of the type you want delete, let's
        continue our example from the last section and use a <span class="italic">constant</span>. Let's assume that the id is <span class="italic">abc123</span>, then all you need to do is the send the DELETE request to the endpoint
        + id:</p><pre class="screen">curl -X DELETE -u user:password
http://server/api/constants/ID</pre><p>A successful delete should return HTTP status 204 (no content).</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e1568"></a>1.10.4.&nbsp;Adding and removing objects to/from collections</h3></div></div></div><p>In order to add or remove objects to or from a collection of objects you can use the
        following
        pattern:</p><pre class="screen">/api/{collection-object}/{collection-object-id}/{collection-name}/{object-id}</pre><p>You should use the POST method to add, and the DELETE method to remove an object. The
        components of the pattern are:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>collection object: The type of objects that owns the collection you want to
            modify.</p></li><li class="listitem"><p>collection object id: The identifier of the object that owns the collection you want
            to modify.</p></li><li class="listitem"><p>collection name: The name of the collection you want to modify.</p></li><li class="listitem"><p>object id: The identifier of the object you want to add or remove from the
            collection.</p></li></ul></div><p>As an example, in order to remove a data element with identifier IDB from a data element
        group with identifier IDA you can do a DELETE
        request:</p><pre class="screen">DELETE /api/dataElementGroups/IDA/dataElements/IDB</pre><p>To add a category option with identifier IDB to a category with identifier IDA you can
        do a POST request:</p><pre class="screen">POST /api/categories/IDA/categoryOptions/IDB</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e1598"></a>1.10.5.&nbsp;Validating payloads</h3></div></div></div><p>System wide validation of metadata payloads are enabled from 2.19 release, this means
        that create/update operations on the web-api endpoints will be checked for valid payload
        before allowed changes to be made, to find out what validations are in place for a endpoint,
        please have a look at the /api/schemas endpoint, i.e. to figure out which constraints a data
        element have, you would go to /api/schemas/dataElement.</p><p>You can also validate your payload manually by sending it to the proper schema endpoint.
        If you wanted to validate the constant from the create section before, you would send it
        like this:</p><pre class="screen">POST /api/schemas/constant
{ payload }</pre><p>A simple (non-validating) example would
        be:</p><pre class="screen">curl -X POST -d "{\"name\": \"some name\"}" -H "Content-Type: application/json" 
-u admin:district https://play.dhis2.org/dev/api/schemas/dataElement</pre><p>Which would yield the
        result:</p><pre class="screen">[
   {
      "message" : "Required property missing.",
      "property" : "type"
   },
   {
      "property" : "aggregationOperator",
      "message" : "Required property missing."
   },
   {
      "property" : "domainType",
      "message" : "Required property missing."
   },
   {
      "property" : "shortName",
      "message" : "Required property missing."
   }
]</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e1615"></a>1.10.6.&nbsp;Partial updates</h3></div></div></div><p>For cases where you don't want or need to update all properties on a object (which
        means downloading a potentially huge payload, change one property, then upload again) we now
        support partial update, both for single properties and for multiple properties.</p><p>The format for updating a single property is the same as when you are updating a
        complete object, just with only 1 property in the JSON/XML file,
        i.e.:</p><pre class="screen">curl -X PATCH -d "{\"name\": \"New Name\"}" -H "Content-Type: application/json" 
-u admin:district https://play.dhis2.org/dev/api/dataElements/fbfJHSPpUQD/name</pre><p>Please note that we are including the property name two times, one time in the payload,
        and one time in the endpoint, the generic endpoint for this is <span class="italic">/api/type/id/property-name</span>, and the <span class="italic">Content-Type</span> must also be included as usual (since we support multiple
        formats).</p><p>The format for updating multiple properties are similar, just that we don't include
        the property names in the url,
        i.e.:</p><pre class="screen">{ // file.json
  "name": "Updated Name",
  "zeroIsSignificant": true
}</pre><pre class="screen">curl -X PATCH -d @file.json -H "Content-Type: application/json" 
-u admin:district https://play.dhis2.org/dev/api/dataElements/fbfJHSPpUQD</pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e1638"></a>1.11.&nbsp;CSV metadata import</h2></div></div></div><p>DHIS 2 supports import of metadata in the CSV format. Columns which are not required can
      be omitted in the CSV file, but the order will be affected. If you would like to specify
      columns which appear late in the order but not specify columns which appear early in the order
      you can include empty columns ("") for them. The following object types are
      supported:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Data elements</p></li><li class="listitem"><p>Data element groups</p></li><li class="listitem"><p>Category options</p></li><li class="listitem"><p>Category option groups</p></li><li class="listitem"><p>Organisation units</p></li><li class="listitem"><p>Organisation unit groups</p></li><li class="listitem"><p>Validation rules</p></li><li class="listitem"><p>Translations</p></li><li class="listitem"><p>Option sets</p></li></ul></div><p>The formats for the currently supported object types for CSV import are listed in the
      following sections.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e1673"></a>1.11.1.&nbsp;Data elements</h3></div></div></div><div class="table"><a name="d6099e1676"></a><p class="title"><b>Table&nbsp;1.14.&nbsp;Data Element CSV Format</b></p><div class="table-contents"><table class="table" summary="Data Element CSV Format" border="1"><colgroup><col class="c1"><col class="c2"><col class="newCol3"><col class="c3"></colgroup><thead><tr><th>Column</th><th>Required</th><th>Value (default first)</th><th>Description</th></tr></thead><tbody><tr><td>Name</td><td>Yes</td><td>&nbsp;</td><td>Name. Max 230 char. Unique.</td></tr><tr><td>UID</td><td>No</td><td>UID</td><td>Stable identifier. Exactly 11 alpha-numeric characters, beginning with a
                character. Will be generated by system if not specified.</td></tr><tr><td>Code</td><td>No</td><td>&nbsp;</td><td>Stable code. Max 50 char.</td></tr><tr><td>Short name</td><td>No</td><td>50 first char of name</td><td>Will fall back to first 50 characters of name if unspecified. Max 50 char.
                Unique.</td></tr><tr><td>Description</td><td>No</td><td>&nbsp;</td><td>Free text description.</td></tr><tr><td>Form name</td><td>No</td><td>&nbsp;</td><td>Max 230 char.</td></tr><tr><td>Domain type</td><td>No</td><td>AGGREGATE | TRACKER</td><td>Domain type for data element, can be aggregate or tracker. Max 16 char.</td></tr><tr><td>Value type</td><td>No</td><td>INTEGER | NUMBER | UNIT_INTERVAL | PERCENTAGE | INTEGER_POSITIVE |
                INTEGER_NEGATIVE | INTEGER_ZERO_OR_POSITIVE | FILE_RESOURCE | COORDINATE |TEXT |
                LONG_TEXT | LETTER | PHONE_NUMBER | EMAIL | BOOLEAN | TRUE_ONLY | DATE | DATETIME </td><td>Value type. Max 16 char.</td></tr><tr><td>Aggregation operator</td><td>No</td><td>SUM | AVERAGE | AVERAGE_SUM_ORG_UNIT | COUNT | STDDEV | VARIANCE | MIN | MAX |
                NONE</td><td>Operator indicating how to aggregate data in the time dimension. Max 16
                char.</td></tr><tr><td>Category combination UID</td><td>No</td><td>UID</td><td>UID of category combination. Will default to default category combination if
                not specified.</td></tr><tr><td>Url</td><td>No</td><td>&nbsp;</td><td>URL to data element resource. Max 255 char.</td></tr><tr><td>Zero is significant</td><td>No</td><td>false | true</td><td>Indicates whether zero values will be stored for this data element.</td></tr><tr><td>Option set</td><td>No</td><td>UID</td><td>UID of option set to use for data.</td></tr><tr><td>Comment option set</td><td>No</td><td>UID</td><td>UID of option set to use for comments.</td></tr></tbody></table></div></div><br class="table-break"><p>An example of a CSV file for data elements can be seen below. The first row will always
        be ignored. Note how you can skip columns and rely on default values to be used by the
        system. You can also skip columns which you do not use which appear to the right of the
        ones</p><pre class="screen">name,uid,code,shortname,description
"Women participated in skill development training",,"D0001","Women participated development training"
"Women participated in community organizations",,"D0002","Women participated community organizations"</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e1820"></a>1.11.2.&nbsp;Organisation units</h3></div></div></div><div class="table"><a name="d6099e1823"></a><p class="title"><b>Table&nbsp;1.15.&nbsp;Organisation Unit CSV Format</b></p><div class="table-contents"><table class="table" summary="Organisation Unit CSV Format" border="1"><colgroup><col class="c1"><col class="c2"><col class="c3"><col class="c4"></colgroup><thead><tr><th>Column</th><th>Required</th><th>Value (default first)</th><th>Description</th></tr></thead><tbody><tr><td>Name</td><td>Yes</td><td>&nbsp;</td><td>Name. Max 230 characters. Unique.</td></tr><tr><td>UID</td><td>No</td><td>UID</td><td>Stable identifier. Max 11 char. Will be generated by system if not
                specified.</td></tr><tr><td>Code</td><td>No</td><td>&nbsp;</td><td>Stable code. Max 50 char.</td></tr><tr><td>Parent UID</td><td>No</td><td>UID</td><td>UID of parent organisation unit.</td></tr><tr><td>Short name</td><td>No</td><td>50 first char of name</td><td>Will fall back to first 50 characters of name if unspecified. Max 50
                characters. Unique.</td></tr><tr><td>Description</td><td>No</td><td>&nbsp;</td><td>Free text description.</td></tr><tr><td>UUID</td><td>No</td><td>&nbsp;</td><td>UUID. Max 36 char.</td></tr><tr><td>Opening date</td><td>No</td><td>1970-01-01</td><td>Opening date of organisation unit in YYYY-MM-DD format.</td></tr><tr><td>Closed date</td><td>No</td><td>&nbsp;</td><td>Closed date of organisation unit in YYYY-MM-DD format, skip if currently
                open.</td></tr><tr><td>Comment</td><td>No</td><td>&nbsp;</td><td>Free text comment for organisation unit.</td></tr><tr><td>Feature type</td><td>No</td><td>NONE | MULTI_POLYGON | POLYGON | POINT | SYMBOL</td><td>Geospatial feature type.</td></tr><tr><td>Coordinates</td><td>No</td><td>&nbsp;</td><td>Coordinates used for geospatial analysis in Geo JSON format.</td></tr><tr><td>URL</td><td>No</td><td>&nbsp;</td><td>URL to organisation unit resource. Max 255 char.</td></tr><tr><td>Contact person</td><td>No</td><td>&nbsp;</td><td>Contact person for organisation unit. Max 255 char.</td></tr><tr><td>Address</td><td>No</td><td>&nbsp;</td><td>Address for organisation unit. Max 255 char.</td></tr><tr><td>Email</td><td>No</td><td>&nbsp;</td><td>Email for organisation unit. Max 150 char.</td></tr><tr><td>Phone number</td><td>No</td><td>&nbsp;</td><td>Phone number for organisation unit. Max 150 char.</td></tr></tbody></table></div></div><br class="table-break"><p>A minimal example for importing organisation units with a parent unit looks like
        this:</p><pre class="screen">name,uid,code,parent
"West province",,"WESTP","ImspTQPwCqd"
"East province",,"EASTP","ImspTQPwCqd"</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e1987"></a>1.11.3.&nbsp;Validation rules</h3></div></div></div><div class="table"><a name="d6099e1990"></a><p class="title"><b>Table&nbsp;1.16.&nbsp;Validation Rule CSV Format</b></p><div class="table-contents"><table class="table" summary="Validation Rule CSV Format" border="1"><colgroup><col class="c1"><col class="c2"><col class="c3"><col class="c4"></colgroup><thead><tr><th>Column</th><th>Required</th><th>Value (default first)</th><th>Description</th></tr></thead><tbody><tr><td>Name</td><td>Yes</td><td>&nbsp;</td><td>Name. Max 230 characters. Unique.</td></tr><tr><td>UID</td><td>No</td><td>UID</td><td>Stable identifier. Max 11 char. Will be generated by system if not
                specified.</td></tr><tr><td>Code</td><td>No</td><td>&nbsp;</td><td>Stable code. Max 50 </td></tr><tr><td>Description</td><td>No</td><td>&nbsp;</td><td>Free text description.</td></tr><tr><td>Instruction</td><td>No</td><td>&nbsp;</td><td>Free text instruction.</td></tr><tr><td>Importance</td><td>No</td><td>MEDIUM | HIGH | LOW</td><td>&nbsp;</td></tr><tr><td>Rule type</td><td>No</td><td>VALIDATION | SURVEILLANCE</td><td>&nbsp;</td></tr><tr><td>Operator</td><td>No</td><td>equal_to | not_equal_to | greater_than | greater_than_or_equal_to | less_than |
                less_than_or_equal_to | compulsory_pair</td><td>&nbsp;</td></tr><tr><td>Period type</td><td>No</td><td>Monthly | Daily | Weekly | Quarterly | SixMontly | Yearly</td><td>&nbsp;</td></tr><tr><td>Left side expression</td><td>Yes</td><td>&nbsp;</td><td>Mathematical formula based on data element and option combo UIDs.</td></tr><tr><td>Left side expression description</td><td>Yes</td><td>&nbsp;</td><td>Free text.</td></tr><tr><td>Left side null if blank</td><td>No</td><td>false | true</td><td>Boolean.</td></tr><tr><td>Right side expression</td><td>Yes</td><td>&nbsp;</td><td>Mathematical formula based on data element and option combo UIDs.</td></tr><tr><td>Right side expression description</td><td>Yes</td><td>&nbsp;</td><td>Free text.</td></tr><tr><td>Right side null if blank</td><td>No</td><td>false | true</td><td>Boolean.</td></tr></tbody></table></div></div><br class="table-break"></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e2132"></a>1.11.4.&nbsp;Translations</h3></div></div></div><div class="table"><a name="d6099e2135"></a><p class="title"><b>Table&nbsp;1.17.&nbsp;Translation CSV format</b></p><div class="table-contents"><table class="table" summary="Translation CSV format" border="1"><colgroup><col class="c1"><col class="c2"><col class="c3"><col class="c4"></colgroup><thead><tr><th>Column</th><th>Required</th><th>Value</th><th>&nbsp;</th></tr></thead><tbody><tr><td>ObjectId</td><td>Yes</td><td>UID</td><td>UID of object to translate.</td></tr><tr><td>ClassName</td><td>Yes</td><td>&nbsp;</td><td>Name of class to translate, e.g. DataElement, IndicatorGroupSet.</td></tr><tr><td>Locale</td><td>Yes</td><td>&nbsp;</td><td>Locale value, e.g. "es", "fr".</td></tr><tr><td>Property</td><td>Yes</td><td>name | shortName | description</td><td>Property to translate.</td></tr><tr><td>Value</td><td>Yes</td><td>&nbsp;</td><td>Translation.</td></tr></tbody></table></div></div><br class="table-break"><p>An example of the translations CSV format looks like this:</p><pre class="screen">objectid,classname,locale,property,value
"s46m5MS0hxu","DataElement","fr","name","Doses bcg donn&eacute;s"
"UOlfIjgN8X6","DataElement","fr","name","Enfant compl&egrave;tement vaccin&eacute;"</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e2199"></a>1.11.5.&nbsp;Option sets</h3></div></div></div><div class="table"><a name="d6099e2202"></a><p class="title"><b>Table&nbsp;1.18.&nbsp;Option Set CSV Format</b></p><div class="table-contents"><table class="table" summary="Option Set CSV Format" border="1"><colgroup><col class="c1"><col class="c2"><col class="c3"><col class="c4"></colgroup><thead><tr><th>Column</th><th>Required</th><th>Value (default first)</th><th>Description</th></tr></thead><tbody><tr><td>OptionSetName</td><td>Yes</td><td>&nbsp;</td><td>Name. Max 230 characters. Unique. Should be repeated for each option.</td></tr><tr><td>OptionSetUID</td><td>No</td><td>UID</td><td>Stable identifier. Max 11 char. Will be generated by system if not specified.
                Should be repeated for each option.</td></tr><tr><td>OptionSetCode</td><td>No</td><td>&nbsp;</td><td>Stable code. Max 50 char. Should be repeated for each option.</td></tr><tr><td>OptionName</td><td>Yes</td><td>&nbsp;</td><td>Option name. Max 230 characters. </td></tr><tr><td>OptionUID</td><td>No</td><td>UID</td><td>Stable identifier. Max 11 char. Will be generated by system if not
                specified.</td></tr><tr><td>OptionCode</td><td>Yes</td><td>&nbsp;</td><td>Stable code. Max 50 char.</td></tr></tbody></table></div></div><br class="table-break"><p>The format for option sets is special. The three first values represent an option set.
        The three last values represent an option. The first three values representing the option
        set should be repeated for each option.</p><pre class="screen">optionsetname,optionsetuid,optionsetcode,optionname,optionuid,optioncode
"Color",,"COLOR","Blue",,"BLUE"
"Color",,"COLOR","Green",,"GREEN"
"Color",,"COLOR","Yellow",,"YELLOW"
"Sex",,,"Male",,"MALE"
"Sex",,,"Female",,"FEMALE"
"Sex",,,"Uknown",,"UNKNOWN"
"Result",,,"High",,"HIGH"
"Result",,,"Medium",,"MEDIUM"
"Result",,,"Low",,"LOW"
"Impact","cJ82jd8sd32","IMPACT","Great",,"GREAT"
"Impact","cJ82jd8sd32","IMPACT","Medium",,"MEDIUM"
"Impact","cJ82jd8sd32","IMPACT","Poor",,"POOR"</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e2275"></a>1.11.6.&nbsp;Other objects</h3></div></div></div><div class="table"><a name="d6099e2278"></a><p class="title"><b>Table&nbsp;1.19.&nbsp;Data Element Group, Category Option, Category Option Group, Organisation Unit Group
          CSV Format</b></p><div class="table-contents"><table class="table" summary="Data Element Group, Category Option, Category Option Group, Organisation Unit Group&#xA;          CSV Format" border="1"><colgroup><col class="c1"><col class="c2"><col class="c3"><col class="c4"></colgroup><thead><tr><th>Column</th><th>Required</th><th>Value (default first)</th><th>Description</th></tr></thead><tbody><tr><td>Name</td><td>Yes</td><td>&nbsp;</td><td>Name. Max 230 characters. Unique.</td></tr><tr><td>UID</td><td>No</td><td>UID</td><td>Stable identifier. Max 11 char. Will be generated by system if not
                specified.</td></tr><tr><td>Code</td><td>No</td><td>&nbsp;</td><td>Stable code. Max 50 char.</td></tr></tbody></table></div></div><br class="table-break"><p>An example for category options looks like this:</p><pre class="screen">name,uid,code
"Male",,"MALE"
"Female",,"FEMALE"</pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="fileresource"></a>1.12.&nbsp;File resources</h2></div></div></div><p><span class="italic">File resources</span> are objects used to represent and store
      binary content. The <span class="italic">FileResource</span> object itself contains the
      file meta-data (name, Content-Type, size, etc) as well as a key allowing retrieval of the
      contents from a database-external file store. The <span class="italic">FileResource</span> object is stored in the database like any other but the content
      (file) is stored elsewhere and is retrievable using the contained reference <span class="italic">(storageKey)</span>.</p><pre class="screen">/api/fileResources</pre><p>The contents of a file resources is not directly accessible but is referenced from other
      objects (such as data values) to store binary content of virtually unlimited size.</p><p>Creation of the file resource itself is done through the <span class="italic">api/fileResources</span> endpoint as a multipart upload
      POST-request:</p><pre class="screen">curl -X POST -v -F "file=@/Path/to/file;filename=name-of-file.png" https://server/api/fileResources</pre><p>The only form parameter required is the <span class="italic">file</span> which is
      the file to upload. The filename and content-type should also be included in the request (this
      is handled for you by any Web browser) but will be replaced by defaults when not
      supplied.</p><p>On successfully creating a file resource the returned data will contain a <span class="italic">response</span> field which in turn contains the <span class="italic">fileResource</span> like
      this:</p><pre class="screen">{
  "httpStatus": "Accepted",
  "httpStatusCode": 202,
  "status": "OK",
  "response": {
    "responseType": "FileResource",
    "fileResource": {
      "name": "name-of-file.png",
      "created": "2015-10-16T16:34:20.654+0000",
      "lastUpdated": "2015-10-16T16:34:20.667+0000",
      "externalAccess": false,
      "publicAccess": "--------",
      "user": { ... },
      "displayName": "name-of-file.png",
      "contentType": "image/png",
      "contentLength": 512571,
      "contentMd5": "4e1fc1c3f999e5aa3228d531e4adde58",
      "storageStatus": "PENDING",
      "id": "xm4JwRwke0i"
    }
  }
}</pre><p>Note that the response is a <span class="italic">202 Accepted</span>, indicating
      that the returned resource has been submitted for background processing (persisting to the
      external file store in this case). Also note the <span class="italic">storageStatus</span> field which indicates whether the contents have been stored or
      not. At this point the persistance to the external store is not yet finished (it is likely
      being uploaded to a cloud-based store somewhere) as seen by the <span class="italic">PENDING</span> status.</p><p>Even though the content has not been fully stored yet the file resource can now be used,
      for example as referenced content in a data value (see <a class="xref" href="#datavalue_file" title="1.15.6.1.&nbsp;Working with file data values">Section&nbsp;1.15.6.1, &#8220;Working with file data values&#8221;</a>). If
      we need to check the updated <span class="italic">storageStatus</span> or otherwise
      retrieve the meta-data of the file, the <span class="italic">fileResources</span>
      endpoint can be
      queried.</p><pre class="screen">curl -v https://server/api/fileResources/xm4JwRwke0i -H "Accept: application/json"</pre><p>This request will return the <span class="italic">FileResource</span> object as
      seen in the response of the above example.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e2396"></a>1.12.1.&nbsp;File resource constraints</h3></div></div></div><p>
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>File resources <span class="bold"><strong>must</strong></span> be referenced (assigned) from
              another object in order to be persisted in the long term. A file resource which is
              created but not referenced by another object such as a data value is considered to be
              in <span class="italic">staging</span>. Any file resources which are in this
              state and are older than <span class="bold"><strong>two hours</strong></span> will be marked for
              deletion and will eventually be purged from the system. </p></li><li class="listitem"><p>The ID returned by the initial creation of the file resource is not retrievable
              from any other location unless the file resource has been referenced (in which the ID
              will be stored as the reference), so losing it will require the POST request to be
              repeated and a new object to be created. The <span class="italic">orphaned</span> file resource will be cleaned up automatically.</p></li><li class="listitem"><p>File resource objects are <span class="italic">immutable</span>, meaning
              modification is not allowed and requires creating a completely new resource
              instead.</p></li></ul></div><p>
      </p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e2427"></a>1.13.&nbsp;Metadata Export API 23</h2></div></div></div><p>Currently in <span class="italic">beta</span> this section explain the new metadata
      exporter available from DHIS 2.23, the metatada API is available at <span class="italic">/api/23/metadata</span> endpoint, it should be noted that only JSON is currently
      supported in this exporter.</p><p>The most common parameters are described down below in the "Export Paramter" table, but
      you can also apply this to all available types by using <span class="italic">type:fields=&lt;filter&gt;</span> and <span class="italic">type:filter=&lt;filter&gt;</span>, you can also enable/disable export of certain types by
      setting <span class="italic">type=true/false</span>, please see examples of these down
      below.</p><div class="table"><a name="d6099e2449"></a><p class="title"><b>Table&nbsp;1.20.&nbsp;Export Parameter</b></p><div class="table-contents"><table class="table" summary="Export Parameter" border="1"><colgroup><col class="c1"><col class="c2"><col class="c3"></colgroup><thead><tr><th>Name</th><th>Options</th><th>Description</th></tr></thead><tbody><tr><td>fields</td><td>Same as metadata field filter</td><td>Default field filter to apply for all types, default is <span class="bold"><strong>:owner</strong></span>.</td></tr><tr><td>filter</td><td>Same as metadata object filter</td><td>Default object filter to apply for all types, default is <span class="bold"><strong>none</strong></span>.</td></tr><tr><td>order</td><td>Same as metadata order</td><td>Default order to apply to all types, default is <span class="bold"><strong>name</strong></span> if available, or <span class="bold"><strong>created</strong></span> if
              not.</td></tr></tbody></table></div></div><br class="table-break"><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e2498"></a>1.13.1.&nbsp;Export Examples</h3></div></div></div><p>Export all
        metadata:</p><pre class="screen">curl -u user:pass http://server/api/23/metadata</pre><p>Export all metadata ordered by lastUpdated
        descending:</p><pre class="screen">curl -u user:pass http://server/api/23/metadata?defaultOrder=lastUpdated:desc</pre><p>Export id and displayName for all data elements, ordered by
        displayName:</p><pre class="screen">curl -u user:pass http://server/api/23/metadata?dataElements:fields=id,name&amp;dataElements:order=displayName:desc</pre><p>Export data elements and indicators where name starts with
        'ANC':</p><pre class="screen">curl -u user:pass http://server/api/23/metadata?defaultFilter=name:^like:ANC&amp;dataElements=true&amp;indicators=true</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e2517"></a>1.13.2.&nbsp;Data set and program export with dependencies</h3></div></div></div><p>When you want to move a whole set of data set or program metadata from one server to
        another (possibly empty) server, we have two special endpoints for just that
        purpose:</p><pre class="screen">/api/dataSets/ID/metadata.json</pre><pre class="screen">/api/programs/ID/metadata.json</pre><p>These exports can be imported both using the old importer at <span class="italic">/api/metadata</span> and the new importer at <span class="italic">/api/23/metadata</span>.</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e2534"></a>1.14.&nbsp;Metadata Import API 23</h2></div></div></div><p>Currently in <span class="italic">beta</span> this section explain the new metadata
      importer available from DHIS 2.23, the metatada API is available at <span class="italic">/api/23/metadata</span> endpoint, it should be noted that only JSON is currently
      supported in this importer.</p><p>The importer allows you to import metadata exported with the new exporter, the different
      parameters are listed down below.</p><div class="table"><a name="d6099e2547"></a><p class="title"><b>Table&nbsp;1.21.&nbsp;Import Parameter</b></p><div class="table-contents"><table class="table" summary="Import Parameter" border="1"><colgroup><col class="c1"><col class="c2"><col class="c3"></colgroup><thead><tr><th>Name</th><th>Options (first is default)</th><th>Description</th></tr></thead><tbody><tr><td>importMode</td><td>COMMIT, VALIDATE</td><td>Sets overall import mode, decides whether or not to only <span class="bold"><strong>VALIDATE</strong></span> or also <span class="bold"><strong>COMMIT</strong></span> the metadata,
              this have similar functionality as our old dryRun flag.</td></tr><tr><td>identifier</td><td>UID, CODE, AUTO</td><td>Sets the identifier scheme to use for reference matching. <span class="bold"><strong>AUTO</strong></span> means try <span class="bold"><strong>UID</strong></span> first, then
                <span class="bold"><strong>CODE</strong></span>.</td></tr><tr><td>preheatMode</td><td>REFERENCE,  ALL, NONE</td><td>Sets the preheater mode, used to signal if preheating should be done for
                <span class="bold"><strong>ALL</strong></span> (as it was before with <span class="italic">preheatCache=true</span>) or do a more intelligent scan of the objects to see
              what to preheat (now the default), setting this to <span class="bold"><strong>NONE</strong></span> is not recommended.</td></tr><tr><td>importStrategy</td><td>CREATE_AND_UPDATE, CREATE, UPDATE, DELETE</td><td>Sets import strategy, <span class="bold"><strong>CREATE_AND_UPDATE</strong></span> will try
              and match on identifier, if it doesn't exist, it will create the object.</td></tr><tr><td>atomicMode</td><td>ALL, NONE</td><td>Sets atomic mode, in the old importer we always did a <span class="italic">best effort</span> import, which means that even if some references did not
              exist, we would still import (i.e. missing data elements on a data element group
              import). Default for new importer is to not allow this, and similar reject any
              validation errors. Setting the <span class="bold"><strong>NONE</strong></span> mode emulated the
              old behavior.</td></tr><tr><td>mergeMode</td><td>MERGE, REPLACE</td><td>Sets the merge mode, when doing updates we have two ways of merging the old
              object with the new one, <span class="bold"><strong>MERGE</strong></span> mode will only
              overwrite the old property if the new one is not-null, for <span class="bold"><strong>REPLACE</strong></span> mode all properties are overwritten regardsless of null or
              not.</td></tr><tr><td>flushMode</td><td>AUTO, OBJECT</td><td>Sets the flush mode, decides when to flush the internal cache, <span class="italic">strongly</span> reommended to keep this to <span class="bold"><strong>AUTO</strong></span> (which is the default). Only use <span class="bold"><strong>OBJECT</strong></span> for debugging purposes, where you are seeing hibernate exceptions
              and want to pinpoint the exact place where the stack happens (hibernate will only
              throw when flushing, so it can be hard to know which object had issues).</td></tr><tr><td>skipSharing</td><td>false, true</td><td>Skip sharing properties, does not merge sharing when doing updates, and does not
              add user group accessses when creating new objects.</td></tr><tr><td>skipValidation</td><td>false, true</td><td>Skip validation for import. <span class="bold"><strong>NOT
              RECOMMENDED</strong></span>.</td></tr></tbody></table></div></div><br class="table-break"></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e2677"></a>1.15.&nbsp;Data values</h2></div></div></div><p>This section is about sending and reading data values.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e2682"></a>1.15.1.&nbsp;Sending data values</h3></div></div></div><p>A common use-case for system integration is the need to send a set of data values from a
        third-party system into DHIS. In this example we will use the DHIS 2 demo on <a class="link" href="http://play.dhis2.org/demo" target="_top">http://play.dhis2.org/demo</a> as basis and we recommend that you follow the provided
        links with a web browser while reading (log in with <span class="italic">admin</span><span class="italic">/district</span> as username/password). We
        assume that we have collected case-based data using a simple software client running on
        mobile phones for the <span class="italic">Mortality &lt;5 years</span> data set in
        the community of <span class="italic">Ngelehun CHC</span> (in <span class="italic">Badjia</span> chiefdom, <span class="italic">Bo</span> district) for the month
        of January 2014. We have now aggregated our data into a statistical report and want to send
        that data to the national DHIS 2 instance.</p><p>The resource which is most appropriate for our purpose of sending data values is the
          <span class="italic">dataValueSets</span> resource. A data value set represents a
        set of data values which have a logical relationship, usually from being captured off the
        same data entry form. We follow the link to the HTML representation which will take us to
          <a class="link" href="http://play.dhis2.org/demo/api/dataValueSets" target="_top">http://play.dhis2.org/demo/api/dataValueSets</a>. The format looks like
        this:</p><pre class="screen">&lt;dataValueSet xmlns="http://dhis2.org/schema/dxf/2.0" dataSet="dataSetID"
  completeDate="date" period="period" orgUnit="orgUnitID" attributeOptionCombo="aocID"&gt;
  &lt;dataValue dataElement="dataElementID" categoryOptionCombo="cocID" value="1" comment="comment1"/&gt;
  &lt;dataValue dataElement="dataElementID" categoryOptionCombo="cocID" value="2" comment="comment2"/&gt;
  &lt;dataValue dataElement="dataElementID" categoryOptionCombo="cocID" value="3" comment="comment3"/&gt;
&lt;/dataValueSet&gt;</pre><p>JSON is supported in this
        format:</p><pre class="screen">{
  "dataSet": "dataSetID",
  "completeDate": "date",
  "period": "period",
  "orgUnit": "orgUnitID",
  "attributeOptionCombo", "aocID",
  "dataValues": [
    { "dataElement": "dataElementID", "categoryOptionCombo": "cocID", "value": "1", "comment": "comment1" },
    { "dataElement": "dataElementID", "categoryOptionCombo": "cocID", "value": "2", "comment": "comment2" },
    { "dataElement": "dataElementID", "categoryOptionCombo": "cocID", "value": "3", "comment": "comment3" }
  ]
}</pre><p>CSV is supported in this
        format:</p><pre class="screen">"dataelement","period","orgunit","catoptcombo","attroptcombo","value","storedby","lastupd","comment"
"dataElementID","period","orgUnitID","cocID","aocID","1","username","2015-04-01","comment1"
"dataElementID","period","orgUnitID","cocID","aocID","2","username","2015-04-01","comment2"
"dataElementID","period","orgUnitID","cocID","aocID","3","username","2015-04-01","comment3"</pre><p><span class="italic">Note:</span> Please refer to the date and period section
        above for time formats.</p><p>From the example we can see that we need to identify the period, the data set, the org
        unit (facility) and the data elements for which to report.</p><p>To obtain the identifier for the data set we return to the entry point at <a class="link" href="http://play.dhis2.org/demo/api" target="_top">http://play.dhis2.org/demo/api</a> and follow the embedded link pointing at the
          <span class="italic">dataSets</span> resource located at <a class="link" href="http://play.dhis2.org/demo/api/dataSets" target="_top">http://play.dhis2.org/demo/api/dataSets</a>. From there we find and follow the link to
        the <span class="italic">Mortality &lt; 5 years</span> data set which leads us to
          <a class="link" href="http://play.dhis2.org/demo/api/dataSets/pBOMPrpg1QX" target="_top">http://play.dhis2.org/demo/api/dataSets/pBOMPrpg1QX</a>. The resource
        representation for the <span class="italic">Mortality &lt; 5 years</span> data set
        conveniently advertises links to the data elements which are members of it. From here we can
        follow these links and obtain the identifiers of the data elements. For brevity we will only
        report on three data elements: <span class="italic">Measles</span> with id <span class="italic">f7n9E0hX8qk</span>, <span class="italic">Dysentery</span> with id
          <span class="italic">Ix2HsbDMLea</span> and <span class="italic">Cholera</span> with id <span class="italic">eY5ehpbEsB7</span>.</p><p>What remains is to get hold of the identifier of the facility (org unit). The <span class="italic">dataSet</span> representation conveniently provides link to org units
        which report on it so we search for<span class="italic"> Ngelehun CHC</span> and
        follow the link to the HTML representation at <a class="link" href="http://play.dhis2.org/demo/api/organisationUnits/DiszpKrYNg8" target="_top">http://play.dhis2.org/demo/api/organisationUnits/DiszpKrYNg8</a>, which tells us that
        the identifier of this org unit is <span class="italic">DiszpKrYNg8</span>.</p><p>From our case-based data we assume that we have 12 cases of measles, 14 cases of
        dysentery and 16 cases of cholera. We have now gathered enough information to be able to put
        together the XML data value set message:</p><pre class="screen">&lt;dataValueSet xmlns="http://dhis2.org/schema/dxf/2.0" dataSet="pBOMPrpg1QX"
  completeDate="2014-02-03" period="201401" orgUnit="DiszpKrYNg8"&gt;
  &lt;dataValue dataElement="f7n9E0hX8qk" value="12"/&gt;
  &lt;dataValue dataElement="Ix2HsbDMLea" value="14"/&gt;
  &lt;dataValue dataElement="eY5ehpbEsB7" value="16"/&gt;
&lt;/dataValueSet&gt;</pre><p>In JSON
        format:</p><pre class="screen">{
  "dataSet": "pBOMPrpg1QX",
  "completeData": "2014-02-03",
  "period": "201401",
  "orgUnit": "DiszpKrYNg8",
  "dataValues": [
    { "dataElement": "f7n9E0hX8qk", "value": "1" },
    { "dataElement": "Ix2HsbDMLea", "value": "2" },
    { "dataElement": "eY5ehpbEsB7", "value": "3" }
  ]
}</pre><p>To perform functional testing we will use the cURL tool which provides an easy way of
        transferring data using HTTP. First we save the data value set XML content in a file called
          <span class="italic">datavalueset.xml</span> . From the directory where this file
        resides we invoke the following from the command line:</p><pre class="screen">curl -d @datavalueset.xml "https://play.dhis2.org/demo/api/dataValueSets" 
-H "Content-Type:application/xml" -u admin:district -v</pre><p>For sending JSON content you must set the content-type header
        accordingly:</p><pre class="screen">curl -d @datavalueset.json "https://play.dhis2.org/demo/api/dataValueSets" 
-H "Content-Type:application/json" -u admin:district -v</pre><p>The command will dispatch a request to the demo Web API, set <span class="italic">application/xml</span> as the content-type and authenticate using admin/district as
        username/password. If all goes well this will return a <span class="italic">200
          OK</span> HTTP status code. You can verify that the data has been received by opening
        the data entry module in DHIS 2 and select the org unit, data set and period used in this
        example.</p><p>The API follows normal semantics for error handling and HTTP status codes. If you supply
        an invalid username or password, <span class="italic">401 Unauthorized</span> is
        returned. If you supply a content-type other than application/xml, <span class="italic">415 Unsupported Media Type</span> is returned. If the XML content is invalid
        according to the DXF namespace, <span class="italic">400 Bad Request</span> is
        returned. If you provide an invalid identifier in the XML content, <span class="italic">409 Conflict</span> is returned together with a descriptive message.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e2818"></a>1.15.2.&nbsp;Sending bulks of data values</h3></div></div></div><p>The previous example showed us how to send a set of related data values sharing the same
        period and organisation unit. This example will show us how to send large bulks of data
        values which don't necessarily are logically related.</p><p>Again we will interact with the with <a class="link" href="http://play.dhis2.org/demo/api/dataValueSets" target="_top">http://play.dhis2.org/demo/api/dataValueSets</a> resource. This time we will not
        specify the dataSet and completeDate attributes. Also, we will specify the period and
        orgUnit attributes on the individual data value elements instead of on the outer data value
        set element. This will enable us to send data values for various periods and org
        units:</p><pre class="screen">&lt;dataValueSet xmlns="http://dhis2.org/schema/dxf/2.0"&gt;
  &lt;dataValue dataElement="f7n9E0hX8qk" period="201401" orgUnit="DiszpKrYNg8" value="12"/&gt;
  &lt;dataValue dataElement="f7n9E0hX8qk" period="201401" orgUnit="FNnj3jKGS7i" value="14"/&gt;
  &lt;dataValue dataElement="f7n9E0hX8qk" period="201402" orgUnit="DiszpKrYNg8" value="16"/&gt;
  &lt;dataValue dataElement="f7n9E0hX8qk" period="201402" orgUnit="Jkhdsf8sdf4" value="18"/&gt;
&lt;/dataValueSet&gt;</pre><p>In JSON
        format:</p><pre class="screen">{
  "dataValues": [
    { "dataElement": "f7n9E0hX8qk", "period": "201401", "orgUnit": "DiszpKrYNg8", "value": "12" },
    { "dataElement": "f7n9E0hX8qk", "period": "201401", "orgUnit": "FNnj3jKGS7i", "value": "14" },
    { "dataElement": "f7n9E0hX8qk", "period": "201402", "orgUnit": "DiszpKrYNg8", "value": "16" },
    { "dataElement": "f7n9E0hX8qk", "period": "201402", "orgUnit": "Jkhdsf8sdf4", "value": "18" }
  ]
}</pre><p>In CSV
        format:</p><pre class="screen">"dataelement","period","orgunit","categoryoptioncombo","attributeoptioncombo","value"
"f7n9E0hX8qk","201401","DiszpKrYNg8","bRowv6yZOF2","bRowv6yZOF2","1"
"Ix2HsbDMLea","201401","DiszpKrYNg8","bRowv6yZOF2","bRowv6yZOF2","2"
"eY5ehpbEsB7","201401","DiszpKrYNg8","bRowv6yZOF2","bRowv6yZOF2","3"</pre><p>We test by using cURL to send the data values in XML format:</p><pre class="screen">curl -d @datavalueset.xml "https://play.dhis2.org/demo/api/dataValueSets" 
-H "Content-Type:application/xml" -u admin:district -v</pre><p>Note that when using CSV format you must use the binary data option to preserve the
        line-breaks in the CSV
        file:</p><pre class="screen">curl --data-binary @datavalueset.csv "https://play.dhis2.org/demo/api/dataValueSets" 
-H "Content-Type:application/csv" -u admin:district -v</pre><p>The data value set resource provides an XML response which is useful when you want to
        verify the impact your request had. The first time we send the data value set request above
        the server will respond with the following<span class="italic"> import
        summary</span>:</p><pre class="screen">&lt;importSummary&gt;
  &lt;dataValueCount imported="2" updated="1" ignored="1"/&gt;
  &lt;dataSetComplete&gt;false&lt;/dataSetComplete&gt;
&lt;/importSummary&gt;</pre><p>This message tells us that 3 data values were imported, 1 data value was updated while
        zero data values were ignored. The single update comes as a result of us sending that data
        value in the previous example. A data value will be ignored if it references a non-existing
        data element, period, org unit or data set. In our case this single ignored value was caused
        by the last data value having an invalid reference to org unit. The data set complete
        element will display the date of which the data value set was completed, or false if no data
        element attribute was supplied.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e2854"></a>1.15.3.&nbsp;Import parameters</h3></div></div></div><p>The import process can be customized using a set of import parameters:</p><div class="table"><a name="d6099e2859"></a><p class="title"><b>Table&nbsp;1.22.&nbsp;Import parameters</b></p><div class="table-contents"><table class="table" summary="Import parameters" border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Parameter</th><th>Values (default first)</th><th>Description</th></tr></thead><tbody><tr><td>dataElementIdScheme</td><td>id | name | code |&nbsp;attribute:ID</td><td>Property of the data element object to use to map the data values.</td></tr><tr><td>orgUnitIdScheme</td><td>id | name | code | attribute:ID</td><td>Property of the org unit object to use to map the data values.</td></tr><tr><td>idScheme</td><td>id | name | code|&nbsp;attribute:ID</td><td>Property of all objects including data elements, org units and category option
                combos, to use to map the data values.</td></tr><tr><td>preheatCache</td><td>false | true</td><td>Indicates whether to preload metadata caches before starting to import data
                values, will speed up large import payloads with high metadata cardinality.</td></tr><tr><td>dryRun</td><td>false | true</td><td>Whether to save changes on the server or just return the import
                summary.</td></tr><tr><td>importStrategy</td><td>CREATE |&nbsp;UPDATE |&nbsp;CREATE_AND_UPDATE |&nbsp;DELETE</td><td>Save objects of all, new or update import status on the server.</td></tr><tr><td>skipExistingCheck</td><td>false | true</td><td>Skip checks for existing data values. Improves performance. Only use for empty
                databases or when the data values to import do not exist already.</td></tr><tr><td>async</td><td>false | true</td><td>Indicates whether the import should be done asynchronous or synchronous. The
                former is suitable for very large imports as it ensures that the request does not
                time out, although it has a significant performance overhead. The latter is faster
                but requires the connection to persist until the process is finished.</td></tr></tbody></table></div></div><br class="table-break"><p>All parameters are optional and can be supplied as query parameters in the request URL
        like this:</p><pre class="screen">api/dataValueSets?dataElementIdScheme=code&amp;orgUnitIdScheme=name&amp;dryRun=true&amp;importStrategy=CREATE</pre><p>They can also be supplied as XML attributes on the data value set element like below.
        XML attributes will override query string parameters.</p><pre class="screen">&lt;dataValueSet xmlns="http://dhis2.org/schema/dxf/2.0" dataElementIdScheme="code"
  orgUnitIdScheme="name" dryRun="true" importStrategy="CREATE"&gt;
  ..
&lt;/dataValueSet&gt;</pre><p>Note that the <span class="emphasis"><em>preheatCache</em></span> parameter can have huge impact for
        performance. For small import files, leaving it to false will be fast. For large import
        files which contain a large number of distint data elements and organisation units, setting
        it to true will be orders of magnitude faster.</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="d6099e2941"></a>1.15.3.1.&nbsp;Identifier schemes</h4></div></div></div><p>Regarding the id schemes, by default the identifiers used in the XML messages uses the
          DHIS 2 stable object identifiers referred to as <span class="italic">uid</span>. In
          certain interoperability situations we might experience that external system decides the
          identifiers of the objects. In that case we can use the <span class="italic">code</span> property of the organisation units and other objects to set fixed
          identifiers. When importing data values we hence need to reference the code property
          instead of the identfier property of these metadata objects. Identifier schemes can be
          specified in the XML message as well as in the request as query parameters. To specify it
          in the XML payload you can do this:</p><pre class="screen">&lt;dataValueSet xmlns="http://dhis2.org/schema/dxf/2.0" 
  dataElementIdScheme="CODE" orgUnitIdScheme="UID" idScheme="CODE"&gt;
  ..
&lt;/dataValueSet&gt;</pre><p>The parameter table above explains how the id schemes can be specified as query
          parameters. The following rules apply for what takes precedence: </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Id schemes defined in the XML or JSON payload take precedence over id schemes
                defined as URL query parameters.</p></li><li class="listitem"><p>Specific id schemes including dataElementIdScheme and orgUnitIdScheme take
                precedence over the general idScheme.</p></li><li class="listitem"><p>The default id scheme is UID, which will be used if no explicit id scheme is
                defined.</p></li></ul></div><p>The following identifier schemes are availabe.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>uid (default)</p></li><li class="listitem"><p>code</p></li><li class="listitem"><p>name</p></li><li class="listitem"><p>attribute (followed by UID of attribute)</p></li></ul></div><p>The attribute option is special and refers to meta-data attributes which have been
          marked as "unique". When using this option, "attribute" must be
          immediately followed by the uid of the attribute, e.g.
          "attributeDnrLSdo4hMl".</p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e2983"></a>1.15.4.&nbsp;CSV data value format</h3></div></div></div><p>The following section describes the CSV format used in DHIS2. The first row is assumed
        to be a header row and will be ignored during import.</p><p>
        </p><div class="table"><a name="d6099e2990"></a><p class="title"><b>Table&nbsp;1.23.&nbsp;CSV format of DHIS 2</b></p><div class="table-contents"><table class="table" summary="CSV format of DHIS 2" border="1"><colgroup><col><col><col></colgroup><tbody><tr><td>Column</td><td>Required</td><td>Description</td></tr><tr><td>Data element</td><td>Yes</td><td>Refers to ID by default, can also be name and code based on selected id
                  scheme</td></tr><tr><td>Period</td><td>Yes</td><td>In ISO format</td></tr><tr><td>Org unit</td><td>Yes</td><td>Refers to ID by default, can also be name and code based on selected id
                  scheme</td></tr><tr><td>Category option combo</td><td>No</td><td>Refers to ID</td></tr><tr><td>Attribute option combo</td><td>No</td><td>Refers to ID (from version 2.16)</td></tr><tr><td>Value</td><td>No</td><td>Data value</td></tr><tr><td>Stored by</td><td>No</td><td>Refers to username of user who entered the value</td></tr><tr><td>Last updated</td><td>No</td><td>Date in ISO format</td></tr><tr><td>Comment</td><td>No</td><td>Free text comment</td></tr><tr><td>Follow up</td><td>No</td><td>true or false</td></tr></tbody></table></div></div><p><br class="table-break">
      </p><p>An example of a CSV file which can be imported into DHIS 2 is seen below.</p><pre class="screen">"dataelement","period","orgunit","categoryoptioncombo","attroptioncombo","value","storedby","timestamp"
"DUSpd8Jq3M7","201202","gP6hn503KUX","Prlt0C1RF0s",,"7","bombali","2010-04-17"
"DUSpd8Jq3M7","201202","gP6hn503KUX","V6L425pT3A0",,"10","bombali","2010-04-17"
"DUSpd8Jq3M7","201202","OjTS752GbZE","V6L425pT3A0",,"9","bombali","2010-04-06"</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e3077"></a>1.15.5.&nbsp;Generating data value set template</h3></div></div></div><p>To generate a data value set template for a certain data set you can use the <span class="italic">/api/dataSets/&lt;id&gt;/dataValueSet</span> resource. XML and JSON
        response formats are supported. Example:</p><pre class="screen">api/dataSets/BfMAe6Itzgt/dataValueSet.json</pre><p>The parameters you can use to further adjust the output are described below:</p><div class="table"><a name="d6099e3089"></a><p class="title"><b>Table&nbsp;1.24.&nbsp;Data values query parameters</b></p><div class="table-contents"><table class="table" summary="Data values query parameters" border="1"><colgroup><col class="c1"><col class="c2"><col class="c3"></colgroup><thead><tr><th>Query parameter</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>period</td><td>No</td><td>Period to use, will be included without any checks.</td></tr><tr><td>orgUnit</td><td>No</td><td>Organisation unit to use, supports multiple orgUnits, both id and code can be
                used.</td></tr><tr><td>comment</td><td>No</td><td>Should comments be include, default: Yes.</td></tr><tr><td>orgUnitIdScheme</td><td>No</td><td>Organisation unit scheme to use, supports id | code.</td></tr><tr><td>dataElementIdScheme</td><td>No</td><td>Data-element scheme to use, supports id | code.</td></tr></tbody></table></div></div><br class="table-break"></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e3140"></a>1.15.6.&nbsp;Sending, reading and deleting individual data values</h3></div></div></div><p>This example will show how to send individual data values to be saved in a request. This
        can be achieved by sending a <span class="italic">POST</span> request to the
          <span class="italic">dataValues</span> resource:</p><pre class="screen">https://play.dhis2.org/demo/api/dataValues</pre><p>The following query parameters are supported for this resource:</p><div class="table"><a name="d6099e3155"></a><p class="title"><b>Table&nbsp;1.25.&nbsp;Data values query parameters</b></p><div class="table-contents"><table class="table" summary="Data values query parameters" border="1"><colgroup><col class="c1"><col class="c2"><col class="c3"></colgroup><thead><tr><th>Query parameter</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>de</td><td>Yes</td><td>Data element identifier</td></tr><tr><td>pe</td><td>Yes</td><td>Period identifier</td></tr><tr><td>ou</td><td>Yes</td><td>Organisation unit identifier</td></tr><tr><td>co</td><td>No</td><td>Category option combo identifier, default will be used if omitted</td></tr><tr><td>cc</td><td>No (must combine with cp)</td><td>Attribute combo identifier</td></tr><tr><td>cp</td><td>No (must combine with cc)</td><td>Attribute option identifiers, separated with ; for multiple values</td></tr><tr><td>value</td><td>No</td><td>Data value</td></tr><tr><td>comment</td><td>No</td><td>Data comment</td></tr><tr><td>followUp</td><td>No</td><td>Follow up on data value, will toggle the current boolean value</td></tr></tbody></table></div></div><br class="table-break"><p>If any of the identifiers given are invalid, if the data value or comment are invalid or
        if the data is locked, the response will contain the <span class="italic">409
          Conflict</span> status code and descriptive text message. If the operation lead to a
        saved or updated value, <span class="italic">200 OK</span> will be returned. An
        example of a request looks like this:</p><pre class="screen">curl "https://play.dhis2.org/demo/api/dataValues?de=s46m5MS0hxu&amp;pe=201301&amp;ou=DiszpKrYNg8&amp;co=Prlt0C1RF0s&amp;value=12"
-X POST -u admin:district -v</pre><p>This resource also allows a special syntax for associating the value to an attribute
        option combination. This can be done by sending the identifier of the attribute combination,
        together with the identifier(s) of the attribute option(s) which the value represents within
        the combination. An example looks like this:</p><pre class="screen">curl "https://play.dhis2.org/demo/api/dataValues?de=s46m5MS0hxu&amp;ou=DiszpKrYNg8&amp;pe=201308&amp;cc=dzjKKQq0cSO&amp;cp=wbrDrL2aYEc;btOyqprQ9e8&amp;value=26"
-X POST -u admin:district -v</pre><p>You can retrieve a data value with a request using the <span class="italic">GET</span> method. The value, comment and followUp params are not applicable in this
        regard:</p><pre class="screen">curl "https://play.dhis2.org/demo/api/dataValues?de=s46m5MS0hxu&amp;pe=201301&amp;ou=DiszpKrYNg8&amp;co=Prlt0C1RF0s"
-X GET -u admin:district -v</pre><p>You can delete a data value with a request using the <span class="italic">DELETE</span> method. </p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="datavalue_file"></a>1.15.6.1.&nbsp;Working with file data values</h4></div></div></div><p>When dealing with data values which have a data element of type <span class="italic">file</span> there is some deviation from the method described above.
          These data values are special in that the contents of the value is a UID reference to a
            <span class="italic">FileResource</span> object instead of a self-contained
          constant. These data values will behave just like other data values which store text
          content, but should be handled differently in order to produce meaningful input and
          output.</p><p>The process of storing one of these data values roughly goes like this:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Upload the file to the <span class="italic">api/fileResources</span>
                endpoint as described in <a class="xref" href="#fileresource" title="1.12.&nbsp;File resources">Section&nbsp;1.12, &#8220;File resources&#8221;</a>.</p></li><li class="listitem"><p>Retrieve the 'id' property of the returned <span class="italic">FileResource</span>.</p></li><li class="listitem"><p>Store the retrieved id <span class="bold"><strong>as the value</strong></span> to the data
                value using any of the methods described above.</p></li></ol></div><p>Only one-to-one relationships between data values and file resources are allowed. This
          is enforced internally so that saving a file resource id in several data values is not
          allowed and will return an error. Deleting the data value will delete the referenced file
          resource. Direct deletion of file resources are not possible.</p><p>The data value can now be retrieved as any other but the returned data will be the UID
          of the file resource. In order to retrieve the actual contents (meaning the file which is
          stored in the file resource mapped to the data value) a GET request must be made to
            <span class="italic">api/dataValues/files</span> mirroring the query parameters
          as they would be for the data value itself. The <span class="italic">dataValues/files</span> endpoint only supports GET requests.</p><p>It is worth noting that due to the underlying storage mechanism working asynchronously
          the file content might not be immediately ready for download from the <span class="italic">dataValues/files</span> endpoint. This is especially true for large
          files which might require time consuming uploads happening in the background to a an
          external file store (depending on the system configuration). Retrieving the file resource
          meta-data from the <span class="italic">api/fileResources/&lt;id&gt;</span>
          endpoint allows checking the <span class="italic">storageStatus</span> of the
          content before attempting to download it.</p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e3315"></a>1.15.7.&nbsp;Reading data values</h3></div></div></div><p>This section explains how to retrieve data values from the Web API by interacting with
        the <span class="italic">dataValueSets</span> resource. Data values can be retrieved
        in <span class="italic">XML</span>, <span class="italic">JSON</span> and
          <span class="italic">CSV</span> format. Since we want to read data we will use the
          <span class="italic">GET</span> HTTP verb. We will also specify that we are
        interested in the XML resource representation by including an <span class="italic">Accept</span> HTTP header with our request. The following query parameters are
        required:</p><div class="table"><a name="d6099e3338"></a><p class="title"><b>Table&nbsp;1.26.&nbsp;Data value set query parameters</b></p><div class="table-contents"><table class="table" summary="Data value set query parameters" border="1"><colgroup><col class="c1"><col class="c2"></colgroup><thead><tr><th> Parameter </th><th> Description </th></tr></thead><tbody><tr><td>dataSet</td><td>Data set identifier. Can be repeated any number of times.</td></tr><tr><td>period</td><td>Period identifier in ISO format. Can be repeated any number of times.</td></tr><tr><td>startDate</td><td>Start date for the time span of the values to export.</td></tr><tr><td>endDate</td><td>End date for the time span of the values to export.</td></tr><tr><td>orgUnit</td><td>Organisation unit identifier. Can be repeated any number of times.</td></tr><tr><td>children</td><td>Whether to include the children in the hierarchy of the organisation
                units.</td></tr><tr><td>lastUpdated</td><td>Include only data values which are updated after the given time stamp.</td></tr><tr><td>limit</td><td>The max number of results in the response.</td></tr><tr><td>idScheme</td><td>Property of meta data objects to use for data values in response.</td></tr><tr><td>dataElementIdScheme</td><td>Property of the data element object to use for data values in response.</td></tr><tr><td>orgUnitIdScheme</td><td>Property of the org unit object to use for data values in response.</td></tr><tr><td>categoryOptionComboIdScheme</td><td>Property of the category option combo object to use for data values in
                response.</td></tr></tbody></table></div></div><br class="table-break"><p>The following response formats are supported:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>xml (application/xml)</p></li><li class="listitem"><p>json (application/json)</p></li><li class="listitem"><p>csv (application/csv)</p></li><li class="listitem"><p>adx (application/xml+adx)</p></li></ul></div><p>Assuming that we have posted data values to DHIS according to the previous section
        called "Sending data values" we can now put together our request for a single data
        value set and request it using cURL:</p><pre class="screen">curl "https://play.dhis2.org/demo/api/dataValueSets?dataSet=pBOMPrpg1QX&amp;period=201401&amp;orgUnit=DiszpKrYNg8"
-H "Accept:application/xml" -u admin:district -v</pre><p>We can also use the start and end dates query parameters to request a larger bulk of
        data values. I.e. you can also request data values for multiple data sets and org units and
        a time span in order to export larger chunks of data. Note that the period query parameter
        takes presedence over the start and end date parameters. An exampe looks like this:</p><pre class="screen">curl "https://play.dhis2.org/demo/api/dataValueSets?dataSet=pBOMPrpg1QX&amp;dataSet=BfMAe6Itzgt&amp;startDate=2013-01-01
&amp;endDate=2013-01-31&amp;orgUnit=YuQRtpLP10I&amp;orgUnit=vWbkYPRmKyS&amp;children=true" 
-H "Accept:application/xml" -u admin:district -v</pre><p>The response will look like this:</p><pre class="screen">&lt;?xml version='1.0' encoding='UTF-8'?&gt;
&lt;dataValueSet xmlns="http://dhis2.org/schema/dxf/2.0" dataSet="pBOMPrpg1QX"
  completeDate="2014-01-02" period="201401" orgUnit="DiszpKrYNg8"&gt;
&lt;dataValue dataElement="eY5ehpbEsB7" period="201401" orgUnit="DiszpKrYNg8"
  categoryOptionCombo="bRowv6yZOF2" value="10003"/&gt;
&lt;dataValue dataElement="Ix2HsbDMLea" period="201401" orgUnit="DiszpKrYNg8"
  categoryOptionCombo="bRowv6yZOF2" value="10002"/&gt;
&lt;dataValue dataElement="f7n9E0hX8qk" period="201401" orgUnit="DiszpKrYNg8"
  categoryOptionCombo="bRowv6yZOF2" value="10001"/&gt;
&lt;/dataValueSet&gt;</pre><p>You can request the data in JSON format like
        this:</p><pre class="screen">https://play.dhis2.org/demo/api/dataValueSets.json?dataSet=pBOMPrpg1QX&amp;period=201401&amp;orgUnit=DiszpKrYNg8</pre><p>The response will look something like
        this:</p><pre class="screen">{
  "dataSet": "pBOMPrpg1QX",
  "completeData": "2014-02-03",
  "period": "201401",
  "orgUnit": "DiszpKrYNg8",
  "dataValues": [
    { "dataElement": "eY5ehpbEsB7", "categoryOptionCombo": "bRowv6yZOF2", "period": "201401",
      "orgUnit": "DiszpKrYNg8", "value": "10003" },
    { "dataElement": "Ix2HsbDMLea", "categoryOptionCombo": "bRowv6yZOF2", "period": "201401",
      "orgUnit": "DiszpKrYNg8", "value": "10002" },
    { "dataElement": "f7n9E0hX8qk", "categoryOptionCombo": "bRowv6yZOF2", "period": "201401",
      "orgUnit": "DiszpKrYNg8", "value": "10001" }
  ]
}</pre><p>You can also request data in CSV format like
        this:</p><pre class="screen">https://play.dhis2.org/demo/api/dataValueSets.csv?dataSet=pBOMPrpg1QX&amp;period=201401&amp;orgUnit=DiszpKrYNg8</pre><p>The response will look like
        this:</p><pre class="screen">dataelement,period,orgunit,categoryoptioncombo,attributeoptioncombo,value,storedby,lastupdated,comment,followup
f7n9E0hX8qk,201401,DiszpKrYNg8,bRowv6yZOF2,bRowv6yZOF2,12,system,2015-04-05T19:58:12.000,comment1,false
Ix2HsbDMLea,201401,DiszpKrYNg8,bRowv6yZOF2,bRowv6yZOF2,14,system,2015-04-05T19:58:12.000,comment2,false
eY5ehpbEsB7,201401,DiszpKrYNg8,bRowv6yZOF2,bRowv6yZOF2,16,system,2015-04-05T19:58:12.000,comment3,false
FTRrcoaog83,201401,DiszpKrYNg8,bRowv6yZOF2,bRowv6yZOF2,12,system,2014-03-02T21:45:05.519,comment4,false</pre><p>The following constraints apply to the data value sets resource:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>At least one data set must be specified.</p></li><li class="listitem"><p>Either at least one period or a start date and end date must be specified.</p></li><li class="listitem"><p>At least one organisation unit must be specified.</p></li><li class="listitem"><p>Organisation units must be within the hierarchy of the organisation units of the
              authenticated user.</p></li><li class="listitem"><p>Limit cannot be less than zero.</p></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e3472"></a>1.16.&nbsp;ADX formatted data</h2></div></div></div><p>From version 2.20 we have included support for an international standard for aggregate
      data exchange called ADX. ADX is developed and maintained by the Quality Research and Public
      Health committee of the IHE (Integerating the HealthCare Enterprise). The wiki page detailing
      QRPH activity can be found at <a class="link" href="http://wiki.ihe.net/index.php?title=Quality,_Research_and_Public_Health#Current_Domain_Activities" target="_top">wiki.ihe.net</a>. ADX is still under active development and has now been published for
      trial implementation. Note that what is implemented currently in DHIS 2 is the functionality
      to read and write adx formatted data, i.e. what is described as Content Consumer and Content
      Producer actors in the ADX profile.</p><p>The structure of an ADX data message is quite similar to what you might already be
      familiar with from DXF 2 data described earlier. There are a few important differences. We
      will describe these differences with reference to a small example:
      </p><pre class="screen">&lt;adx xmlns="urn:ihe:qrph:adx:2015" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="urn:ihe:qrph:adx:2015 ../schema/adx_loose.xsd" exported="2015-02-08T19:30:00Z"&gt;

  &lt;group orgUnit="OU_559" period="2015-06-01/P1M" completeDate="2015-07-01" dataSet="(TB/HIV)VCCT"&gt;

    &lt;dataValue dataElement="VCCT_0" GENDER="FMLE" HIV_AGE="AGE0-14" value="32"/&gt;
    &lt;dataValue dataElement="VCCT_1" GENDER="FMLE" HIV_AGE="AGE0-14" value="20"/&gt;
    &lt;dataValue dataElement="VCCT_2" GENDER="FMLE" HIV_AGE="AGE0-14" value="10"/&gt;
    &lt;dataValue dataElement="PLHIV_TB_0" GENDER="FMLE" HIV_AGE="AGE0-14" value="10"/&gt;
    &lt;dataValue dataElement="PLHIV_TB_1" GENDER="FMLE" HIV_AGE="AGE0-14" value="10"/&gt;

    &lt;dataValue dataElement="VCCT_0" GENDER="MLE" HIV_AGE="AGE0-14" value="32"/&gt;
    &lt;dataValue dataElement="VCCT_1" GENDER="MLE" HIV_AGE="AGE0-14" value="20"/&gt;
    &lt;dataValue dataElement="VCCT_2" GENDER="MLE" HIV_AGE="AGE0-14" value="10"/&gt;
    &lt;dataValue dataElement="PLHIV_TB_0" GENDER="MLE" HIV_AGE="AGE0-14" value="10"/&gt;
    &lt;dataValue dataElement="PLHIV_TB_1" GENDER="MLE" HIV_AGE="AGE0-14" value="10"/&gt;

    &lt;dataValue dataElement="VCCT_0" GENDER="FMLE" HIV_AGE="AGE15-24" value="32"/&gt;
    &lt;dataValue dataElement="VCCT_1" GENDER="FMLE" HIV_AGE="AGE15-24" value="20"/&gt;
    &lt;dataValue dataElement="VCCT_2" GENDER="FMLE" HIV_AGE="AGE15-24" value="10"/&gt;
    &lt;dataValue dataElement="PLHIV_TB_0" GENDER="FMLE" HIV_AGE="AGE15-24" value="10"/&gt;
    &lt;dataValue dataElement="PLHIV_TB_1" GENDER="FMLE" HIV_AGE="AGE15-24" value="10"/&gt;

    &lt;dataValue dataElement="VCCT_0" GENDER="MLE" HIV_AGE="AGE15-24" value="32"/&gt;
    &lt;dataValue dataElement="VCCT_1" GENDER="MLE" HIV_AGE="AGE15-24" value="20"/&gt;
    &lt;dataValue dataElement="VCCT_2" GENDER="MLE" HIV_AGE="AGE15-24" value="10"/&gt;
    &lt;dataValue dataElement="PLHIV_TB_0" GENDER="MLE" HIV_AGE="AGE15-24" value="10"/&gt;
    &lt;dataValue dataElement="PLHIV_TB_1" GENDER="MLE" HIV_AGE="AGE15-24" value="10"/&gt;

  &lt;/group&gt;
&lt;/adx&gt;</pre><p>
    </p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e3485"></a>1.16.1.&nbsp;The adx root element</h3></div></div></div><p>The adx root element has only one manadatory attribute, which is the
          <span class="emphasis"><em>exported</em></span> timestamp. In common with other adx elements, the schema is
        extensible in that it does not restrict additional application specific attributes.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e3493"></a>1.16.2.&nbsp;The group element</h3></div></div></div><p>Unlike dxf2, adx requires that the datavalues are grouped according to orgUnit, period
        and dataSet. The example above shows a data report for the "(TB/HIV) VCCT" dataset
        from the online demo database. This example is using codes as identifiers instead of dhis2
        uids. Codes are the preferred form of identifiier when using adx.</p><p>The orgUnit, period and dataSet attributes are mandatory in adx. The group element may
        contain additional attributes. In our DHIS2 implementation any additional attributes are
        simply passed through to the underlying importer. This means that all attributes which
        currently have meaning in dxf2 (such as completeDate in the example above) can continue be
        used in adx and they will be processed in the same way.</p><p>A significant difference between adx and dxf2 is in the way that periods are encoded.
        Adx makes strict use of ISO8601 and encodes the reporting period as
        (date|datetime)/(duration). So the period in the example above is a period of 1 month (P1M)
        starting on 2015-06-01. So it is the data for June 2015. The notation is a bit more verbose,
        but it is very flexible and allows us to support all existing period types in DHIS2</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e3502"></a>1.16.3.&nbsp;Data values</h3></div></div></div><p>The dataValue element in adx is very similar to its equivalent in DXF. The mandatory
        attributes are <span class="emphasis"><em>dataElement</em></span> and <span class="emphasis"><em>value</em></span>.
          <span class="emphasis"><em>orgUnit</em></span> and <span class="emphasis"><em>period</em></span> attributes don't appear
        in the dataValue as they are required at the <span class="emphasis"><em>group</em></span> level.</p><p>The most significant difference is the way that disaggregation is represented. DXF uses
        the categoryOptionCombo to indicate disaggregation of data. In adx the disaggregations (eg
        AGE_GROUP and SEX) are expressed explicitly as attributes. One important constraint on using
        adx is that the categories used for dataElements in the dataSet MUST have a code assigned to
        them, and further, that code must be of a form which is suitable for use as an XML
        attribute. The exact constraint on an XML attribute name is described in the W3C XML
        standard - in practice this means no spaces, no non-alphanumeric chracters other than
        '_' and it may not start with a letter. The example above shows examples of
        'good' category codes ('GENDER' and 'HIV_AGE').</p><p>This restriction on the form of codes applies only to categories. Currently the
        convention is not enforced by DHIS2 when you are assigning codes, but you will get an
        informative error message if you try to import adx data and the category codes are either
        not assigned or not suitable.</p><p>The main benefits of using explicit dimensions of disaggregated data are that </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>The system producing the data does not have to be synched with the
              categoryOptionCombo within DHIS2.</p></li><li class="listitem"><p>The producer and consumer can match their codes to a 3rd party authoritative
              source, such as a vterminology service. Note that in the example above the Gender and
              AgeGroup codes are using code lists from the <a class="link" href="http://apps.who.int/gho/data/node.resources.api" target="_top">WHO Global Health
                Observatory</a>.</p></li></ul></div><p>Note that this feature may be extremely useful, for example when producing disaggregated
        data from an EMR system, but there may be cases where a
          <span class="emphasis"><em>categoryOptionCombo</em></span> mapping is easier or more desirable. The DHIS2
        implementation of adx will check for the existence of a
          <span class="emphasis"><em>categoryOptionCombo</em></span> attribute and, if it exists, it will use that it
        preference to exploded dimension attributes. Similarly, an
          <span class="emphasis"><em>attributeOptionCombo</em></span> attribute on the <span class="emphasis"><em>group</em></span>
        element will be processed in the legacy way. Otherwise the attributeOptionCombo can be
        treated as exploded categories just as on the <span class="emphasis"><em>dataValue</em></span>.</p><p>In the simple example above, each of the dataElements in the dataSet have the same
        dimensionality (categorycombo) so the data is neatly rectangular. This need not be the case.
        dataSets may contain dataElements with different categoryCombos, resulting in a
          <span class="emphasis"><em>ragged-right</em></span> adx data message.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e3560"></a>1.16.4.&nbsp;Importing data - HTTP POST</h3></div></div></div><p>DHIS2 exposes an endpoint for POST adx data at <span class="emphasis"><em>/api/dataValueSets</em></span>
        using <span class="italic">application/xml+adx</span> as content type. So, for
        example, the following curl command can be used to POST the example data above to the DHIS2
        demo server:
        </p><pre class="screen">curl -u admin:district -X POST -H "Content-Type: application/xml+adx"
-d @data.xml "https://play.dhis2.org/demo/api/dataValueSets?dataElementIdScheme=code&amp;orgUnitIdScheme=code"</pre><p>
        Note the query parameters are the same as are used with DXF data. The adx endpoint should
        interpret all the existing DXF parameters with the same semantics as DXF.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e3574"></a>1.16.5.&nbsp;Exporting data - HTTP GET</h3></div></div></div><p>DHIS2 exposes an endpoint to GET adx data sets at
          <span class="emphasis"><em>/api/dataValueSets</em></span> using <span class="italic">application/xml+adx</span> as the accepted content type. So, for example, the
        following curl command can be used to retrieve the adx data:
        </p><pre class="screen">curl -u admin:district -X POST -H "Accept: application/xml+adx"
 "https://play.dhis2.org/demo/api/dataValueSets?dataValueSets?orgUnit=M_CLINIC&amp;dataSet=MALARIA&amp;period=201501"</pre><p>
        Note the query parameters are the same as are used with DXF data. An important difference is
        that the identifiers for dataSet and orgUnit are assumed to be codes rather than
        uids.</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e3588"></a>1.17.&nbsp;Events</h2></div></div></div><p>This section is about sending and reading events.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e3593"></a>1.17.1.&nbsp;Sending events</h3></div></div></div><p>DHIS 2 supports three kinds of events: single events with no registration (also referred
        to as anonymous events), single event with registration and multiple events with
        registration. Registration implies that the data is linked to a tracked entity instance
        which is identified using some sort of identifier.</p><p>To send events to DHIS 2 you must interact with the <span class="italic">events</span> resource. The approach to sending events is similar to sending
        aggregate data values. You will need a <span class="italic">program</span> which can
        be looked up using the <span class="italic">programs</span> resource, an <span class="italic">orgUnit</span> which can be looked up using the <span class="italic">organisationUnits</span> resource, and a list of valid data element identifiers which
        can be looked up using the <span class="italic">dataElements</span> resource. For
        events with registration, a <span class="italic">tracked entity instance</span>
        identifier is required, read about how to get this in the section about the <span class="italic">trackedEntityInstances</span> resource. For sending events to programs
        with multiple stages, you will need to also include the <span class="italic">programStage</span> identifier, the identifiers for programStages can be found in the
          <span class="italic">programStages</span> resource.</p><p>A simple single event with no registration example payload in XML format where we send
        events from the "Inpatient morbidity and mortality" program for the "Ngelehun
        CHC" facility in the demo database can be seen below:</p><pre class="screen">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;event program="eBAyeGv0exc" orgUnit="DiszpKrYNg8" eventDate="2013-05-17" status="COMPLETED" storedBy="admin"&gt;
  &lt;coordinate latitude="59.8" longitude="10.9" /&gt;
  &lt;dataValues&gt;
    &lt;dataValue dataElement="qrur9Dvnyt5" value="22" /&gt;
    &lt;dataValue dataElement="oZg33kd9taw" value="Male" /&gt;
    &lt;dataValue dataElement="msodh3rEMJa" value="2013-05-18" /&gt;
  &lt;/dataValues&gt;
&lt;/event&gt;</pre><p>To perform some testing we can save the XML payload as a file called<span class="italic"> event.xml</span> and send it as a POST request to the events resource
        in the API using curl with the following command:</p><pre class="screen">curl -d @event.xml "https://play.dhis2.org/demo/api/events" 
-H "Content-Type:application/xml" -u admin:district -v</pre><p>The same payload in JSON format looks like this:</p><pre class="screen">{
  "program": "eBAyeGv0exc",
  "orgUnit": "DiszpKrYNg8",
  "eventDate": "2013-05-17",
  "status": "COMPLETED",
  "storedBy": "admin",
  "coordinate": {
    "latitude": "59.8",
    "longitude": "10.9"
  },
  "dataValues": [
    { "dataElement": "qrur9Dvnyt5", "value": "22" },
    { "dataElement": "oZg33kd9taw", "value": "Male" },
    { "dataElement": "msodh3rEMJa", "value": "2013-05-18" }
  ]
}</pre><p>To send this you can save it to a file called <span class="italic">event.json</span> and use curl like this:</p><pre class="screen">curl -d @event.json "localhost/api/events" -H "Content-Type:application/json" -u admin:district -v</pre><p>We also support sending multiple events at the same time. A payload in XML format might
        look like this: </p><pre class="screen">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;events&gt;
    &lt;event program="eBAyeGv0exc" orgUnit="DiszpKrYNg8" eventDate="2013-05-17" status="COMPLETED" storedBy="admin"&gt;
      &lt;coordinate latitude="59.8" longitude="10.9" /&gt;
      &lt;dataValues&gt;
        &lt;dataValue dataElement="qrur9Dvnyt5" value="22" /&gt;
        &lt;dataValue dataElement="oZg33kd9taw" value="Male" /&gt;
      &lt;/dataValues&gt;
    &lt;/event&gt;
    &lt;event program="eBAyeGv0exc" orgUnit="DiszpKrYNg8" eventDate="2013-05-17" status="COMPLETED" storedBy="admin"&gt;
      &lt;coordinate latitude="59.8" longitude="10.9" /&gt;
      &lt;dataValues&gt;
        &lt;dataValue dataElement="qrur9Dvnyt5" value="26" /&gt;
        &lt;dataValue dataElement="oZg33kd9taw" value="Female" /&gt;
      &lt;/dataValues&gt;
    &lt;/event&gt;
&lt;/events&gt;</pre><p>You will receive an import summary with the response which can be inspected in order to
        get information about the outcome of the request, like how many values were imported
        successfully. The payload in JSON format looks like this:</p><pre class="screen">{
  "events": [
  {
    "program": "eBAyeGv0exc",
    "orgUnit": "DiszpKrYNg8",
    "eventDate": "2013-05-17",
    "status": "COMPLETED",
    "storedBy": "admin",
    "coordinate": {
      "latitude": "59.8",
      "longitude": "10.9"
    },
    "dataValues": [
      { "dataElement": "qrur9Dvnyt5", "value": "22" },
      { "dataElement": "oZg33kd9taw", "value": "Male" }
    ] },
  {
    "program": "eBAyeGv0exc",
    "orgUnit": "DiszpKrYNg8",
    "eventDate": "2013-05-17",
    "status": "COMPLETED",
    "storedBy": "admin",
    "coordinate": {
      "latitude": "59.8",
      "longitude": "10.9"
    },
    "dataValues": [
      { "dataElement": "qrur9Dvnyt5", "value": "26" },
      { "dataElement": "oZg33kd9taw", "value": "Female" }
    ] }
  ]
}</pre><p>As part of the import summary you will also get the identifier <span class="italic">reference</span> to the event you just sent, together with a <span class="italic">href</span> element which points to the server location of this event. The table
        below describes the meaning of each element.</p><div class="table"><a name="d6099e3668"></a><p class="title"><b>Table&nbsp;1.27.&nbsp;Events resource format</b></p><div class="table-contents"><table class="table" summary="Events resource format" border="1"><colgroup><col width="140pt" class="c1"><col width="88pt" class="c2"><col width="84pt" class="c3"><col width="315pt" class="c4"><col width="394pt" class="c5"></colgroup><thead><tr><th> Parameter </th><th> Type </th><th> Required </th><th> Options (default first)</th><th> Description </th></tr></thead><tbody><tr><td>program</td><td>string</td><td>true</td><td>&nbsp;</td><td>Identifier of the single event with no registration program</td></tr><tr><td>orgUnit</td><td>string</td><td>true</td><td>&nbsp;</td><td>Identifier of the organisation unit where the event took place</td></tr><tr><td>eventDate</td><td>date</td><td>true</td><td>&nbsp;</td><td>The date of when the event occured</td></tr><tr><td>status</td><td>enum</td><td>false</td><td>ACTIVE |&nbsp;COMPLETED |&nbsp;VISITED | SCHEDULE |&nbsp;OVERDUE
                |&nbsp;SKIPPED</td><td>Whether the event is complete or not</td></tr><tr><td>storedBy</td><td>string</td><td>false</td><td>Defaults to current user</td><td>Who stored this event (can be username, system-name etc)</td></tr><tr><td>coordinate</td><td>double</td><td>false</td><td>&nbsp;</td><td>Refers to wher the event took place geographically (latitude and
                longitude)</td></tr><tr><td>dataElement</td><td>string</td><td>true</td><td>&nbsp;</td><td>Identifier of data element</td></tr><tr><td>value</td><td>string</td><td>true</td><td>&nbsp;</td><td>Data value or measure for this event</td></tr></tbody></table></div></div><br class="table-break"><p><span class="bold"><strong>OrgUnit matching</strong></span>: By default the orgUnit parameter will
        match on the ID, you can also select the orgUnit id matching scheme by using the parameter
        orgUnitIdScheme=SCHEME, where the options are: <span class="italic">ID</span>,
          <span class="italic">UID</span>, <span class="italic">UUID</span>, <span class="italic">CODE</span>, and <span class="italic">NAME</span>. There is also
        the <span class="italic">ATTRIBUTE:</span> scheme, which matches on a <span class="italic">unique</span> metadata attribute value.</p><p><span class="bold"><strong>Update</strong></span>: To update an existing event, the format of the
        payload is the same, but the URL you are posting to must add the identifier to the end of
        the URL string and the request must be PUT.
        </p><pre class="screen">curl -X PUT -d @updated_event.xml "localhost/api/events/ID" 
-H "Content-Type:application/xml" -u admin:district -v</pre><pre class="screen">curl -X PUT -d @updated_event.json "localhost/api/events/ID" 
-H "Content-Type:application/json" -u admin:district -v</pre><p><span class="bold"><strong>Delete</strong></span>: To delete an existing event, all you need is to
        send a DELETE request with a identifier reference to the server you are
        using.</p><pre class="screen">curl -X DELETE "localhost/api/events/ID" -u admin:district -v</pre><p><span class="bold"><strong>Get</strong></span>: To get an existing event you can issue a GET
        request including the identifier like
        this:</p><pre class="screen">curl "localhost/api/events/ID" -H "Content-Type:application/xml" -u admin:district -v</pre><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="d6099e3817"></a>1.17.1.1.&nbsp;Import parameters</h4></div></div></div><p>The import process can be customized using a set of import parameters:</p><div class="table"><a name="d6099e3822"></a><p class="title"><b>Table&nbsp;1.28.&nbsp;Import parameters</b></p><div class="table-contents"><table class="table" summary="Import parameters" border="1"><colgroup><col><col><col></colgroup><thead><tr><th> Parameter </th><th> Values (default first) </th><th> Description </th></tr></thead><tbody><tr><td>dataElementIdScheme</td><td>id | name | code |&nbsp;attribute:ID</td><td>Property of the data element object to use to map the data values.</td></tr><tr><td>orgUnitIdScheme</td><td>id | name | code | attribute:ID</td><td>Property of the org unit object to use to map the data values.</td></tr><tr><td>idScheme</td><td>id | name | code|&nbsp;attribute:ID</td><td>Property of all objects including data elements, org units and category option
                  combos, to use to map the data values.</td></tr><tr><td>dryRun</td><td>false | true</td><td>Whether to save changes on the server or just return the import
                  summary.</td></tr><tr><td>importStrategy</td><td>CREATE |&nbsp;UPDATE |&nbsp;CREATE_AND_UPDATE |&nbsp;DELETE</td><td>Save objects of all, new or update import status on the server.</td></tr><tr><td>sendNotifications</td><td>true | false</td><td>Indicates whether to send notifications for completed events.</td></tr></tbody></table></div></div><br class="table-break"></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e3877"></a>1.17.2.&nbsp;CSV Import / Export</h3></div></div></div><p>In addition to XML and JSON for event import/export, in DHIS 2.17 we introduced support
        for the CSV format. Support for this format builds on what was described in the last
        section, so here we will only write about what the CSV specific parts are.</p><p>To use the CSV format you must either use the <span class="italic">/api/events.csv</span> endpoint, or add <span class="italic">content-type:
          text/csv</span> for import, and <span class="italic">accept: text/csv</span>
        for export when using the <span class="italic">/api/events</span> endpoint.</p><p>The order of column in the CSV which are used for both export and import is as
        follows:</p><p>
        </p><div class="table"><a name="d6099e3900"></a><p class="title"><b>Table&nbsp;1.29.&nbsp;CSV column</b></p><div class="table-contents"><table class="table" summary="CSV column" border="1"><colgroup><col><col><col><col></colgroup><thead><tr><th>Index</th><th> Key</th><th> Type </th><th> Description </th></tr></thead><tbody><tr><td>1</td><td>event</td><td>identifier</td><td>Identifier of event</td></tr><tr><td>2</td><td>status</td><td>enum</td><td>Status of event, can be ACTIVE | COMPLETED | VISITED | SCHEDULED | OVERDUE
                  |&nbsp;SKIPPED</td></tr><tr><td>3</td><td>program</td><td>identifier</td><td>Identifier of program</td></tr><tr><td>4</td><td>programStage</td><td>identifier</td><td>Identifier of program stage</td></tr><tr><td>5</td><td>enrollment</td><td>identifier</td><td>Identifier of enrollment (program stage instance)</td></tr><tr><td>6</td><td>orgUnit</td><td>identifier</td><td>Identifier of organisation unit</td></tr><tr><td>7</td><td>eventDate</td><td>date</td><td>Event date</td></tr><tr><td>8</td><td>dueDate</td><td>date</td><td>Due Date</td></tr><tr><td>9</td><td>latitude</td><td>double</td><td>Latitude where event happened</td></tr><tr><td>10</td><td>longitude</td><td>double</td><td>Longitude where event happened</td></tr><tr><td>11</td><td>dataElement</td><td>identifier</td><td>Identifier of data element</td></tr><tr><td>12</td><td>value</td><td>string</td><td>Value / measure of event</td></tr><tr><td>13</td><td>storedBy</td><td>string</td><td>Event was stored by (defaults to current user)</td></tr><tr><td>14</td><td>providedElsewhere</td><td>boolean</td><td>Was this value collected somewhere else</td></tr></tbody></table></div></div><p><br class="table-break">
      </p><p><span class="italic">Example of 2 events with 2 different data value
        each:</span></p><pre class="screen">EJNxP3WreNP,COMPLETED,&lt;pid&gt;,&lt;psid&gt;,&lt;enrollment-id&gt;,&lt;ou&gt;,2016-01-01,2016-01-01,,,&lt;de&gt;,1,,
EJNxP3WreNP,COMPLETED,&lt;pid&gt;,&lt;psid&gt;,&lt;enrollment-id&gt;,&lt;ou&gt;,2016-01-01,2016-01-01,,,&lt;de&gt;,2,,
qPEdI1xn7k0,COMPLETED,&lt;pid&gt;,&lt;psid&gt;,&lt;enrollment-id&gt;,&lt;ou&gt;,2016-01-01,2016-01-01,,,&lt;de&gt;,3,,
qPEdI1xn7k0,COMPLETED,&lt;pid&gt;,&lt;psid&gt;,&lt;enrollment-id&gt;,&lt;ou&gt;,2016-01-01,2016-01-01,,,&lt;de&gt;,4,,</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e4047"></a>1.17.3.&nbsp;Querying and reading events</h3></div></div></div><p>This section explains how to read out the events that have been stored in the DHIS2
        instance. For more advanced uses of the event data, please see the section on event
        analytics. The output format from the <span class="italic">/api/events</span>
        endpoint will match the format that is used to send events to it (which the analytics event
        api does not support). Both XML and JSON are supported, either through adding .json/.xml or
        by setting the appropriate <span class="italic">Accept</span> header. The query is
        paged by default and the default page size is 50 events, <span class="italic">field</span> filtering works as it does for metadata, add the <span class="italic">fields</span> parameter and include your wanted properties, i.e. <span class="italic">?fields=program,status</span>.</p><p>
        </p><div class="table"><a name="d6099e4069"></a><p class="title"><b>Table&nbsp;1.30.&nbsp;Events resource query parameters</b></p><div class="table-contents"><table class="table" summary="Events resource query parameters" border="1"><colgroup><col><col><col><col></colgroup><thead><tr><th> Key </th><th> Type </th><th> Required </th><th> Description </th></tr></thead><tbody><tr><td>program</td><td>identifier</td><td>true (if not programStage is provided)</td><td>Identifier of program</td></tr><tr><td>programStage</td><td>identifier</td><td>false</td><td>Identifier of program stage</td></tr><tr><td>programStatus</td><td>enum</td><td>false</td><td>Status of event in program, ca be ACTIVE | COMPLETED | CANCELLED</td></tr><tr><td>followUp</td><td>boolean</td><td>false</td><td>Whether event is considered for follow up in program, can be true | false or
                  omitted.</td></tr><tr><td>trackedEntityInstance</td><td>identifier</td><td>false</td><td>Identifier of tracked entity instance</td></tr><tr><td>orgUnit</td><td>identifier</td><td>true</td><td>Identifier of organisation unit</td></tr><tr><td>ouMode</td><td>enum</td><td>false</td><td>Org unit selection mode, can be SELECTED | CHILDREN | DESCENDANTS </td></tr><tr><td>startDate</td><td>date</td><td>false</td><td>Only events newer than this date</td></tr><tr><td>endDate</td><td>date</td><td>false</td><td>Only events older than this date</td></tr><tr><td>status</td><td>enum</td><td>false</td><td>Status of event, can be ACTIVE | COMPLETED | VISITED | SCHEDULED | OVERDUE
                  |&nbsp;SKIPPED</td></tr><tr><td>lastUpdated</td><td>date</td><td>false</td><td>Filter for events which were updated after this date.</td></tr><tr><td>skipMeta</td><td>boolean</td><td>false</td><td>Exclude the meta data part of response (improves performance)</td></tr><tr><td>page</td><td>integer</td><td>false</td><td>Page number</td></tr><tr><td>pageSize</td><td>integer</td><td>falase</td><td>Number of items in each page</td></tr><tr><td>totalPages</td><td>boolean</td><td>false</td><td>Indicates whether to include the total number of pages in the paging
                  response.</td></tr><tr><td>skipPaging</td><td>boolean</td><td>false</td><td>Indicates whether to skip paging in the query and return all events.</td></tr><tr><td>dataElementIdScheme</td><td>string</td><td>false</td><td>Data element ID scheme to use for export, valid options are UID and
                  CODE</td></tr><tr><td>categoryOptionComboIdScheme</td><td>string</td><td>false</td><td>Category Option Combo ID scheme to use for export, valid options are UID and
                  CODE</td></tr><tr><td>orgUnitIdScheme</td><td>string</td><td>false</td><td>Organisation Unit ID scheme to use for export, valid options are UID and
                  CODE</td></tr><tr><td>programIdScheme</td><td>string</td><td>false</td><td>Program ID scheme to use for export, valid options are UID and CODE</td></tr><tr><td>programStageIdScheme</td><td>string</td><td>false</td><td>Program Stage ID scheme to use for export, valid options are UID and
                  CODE</td></tr><tr><td>idScheme</td><td>string</td><td>false</td><td>Allows to set id scheme for data element, category option combo, orgUnit,
                  program and program stage at once.</td></tr><tr><td>order</td><td>string</td><td>false</td><td>The order of which to retreive the events from the API. Usage: 
                  order=(property):asc/desc - Ascending order is default. Properties: event | 
                  program | programStage | enrollment | enrollmentStatus | orgUnit | orgUnitName |
                  trackedEntityInstance | eventDate | followup | status | dueDate | storedBy | 
                  created | lastUpdated | completedBy |&nbsp;completedDate
                </td></tr><tr><td>event</td><td>comma delimited strings</td><td>false</td><td>Filter the result down to a limited set of IDs by using <span class="italic">event=id1;id2</span>.</td></tr></tbody></table></div></div><p><br class="table-break">
      </p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="d6099e4304"></a>1.17.3.1.&nbsp;Examples</h4></div></div></div><p>Query for all events with children of a certain organisation unit:
          </p><pre class="screen">api/events.json?orgUnit=YuQRtpLP10I&amp;ouMode=CHILDREN</pre><p>Query for all events with all descendants of a certain organisation unit, implying all
          organisation units in the
          sub-hierarchy:</p><pre class="screen">api/events.json?orgUnit=O6uvpzGd5pu&amp;ouMode=DESCENDANTS</pre><p>Query for all events with a certain program and organisation unit:
          </p><pre class="screen">api/events.json?orgUnit=DiszpKrYNg8&amp;program=eBAyeGv0exc</pre><p>Query for all events with a certain program and organisation unit, sorting by due date ascending:
          </p><pre class="screen">api/events.json?orgUnit=DiszpKrYNg8&amp;program=eBAyeGv0exc&amp;order=dueDate</pre><p>Query for the 10 events with the newest event date in a certain program and organisation unit -
          by paging and ordering by due date descending:
          </p><pre class="screen">api/events.json?orgUnit=DiszpKrYNg8&amp;program=eBAyeGv0exc&amp;
order=eventDate:desc&amp;pageSize=10&amp;page=1</pre><p>Query for all events with a certain program and organisation unit for a specific
          tracked entity instance:
          </p><pre class="screen">api/events.json?orgUnit=DiszpKrYNg8&amp;
program=eBAyeGv0exc&amp;trackedEntityInstance=gfVxE3ALA9m</pre><p>Query for all events with a certain program and organisation unit older or equal to
          2014-02-03:
          </p><pre class="screen">api/events.json?orgUnit=DiszpKrYNg8&amp;program=eBAyeGv0exc&amp;endDate=2014-02-03</pre><p>Query for all events with a certain program stage, organisation unit and tracked
          entity instance in the year 2014:
          </p><pre class="screen">api/events.json?orgUnit=DiszpKrYNg8&amp;program=eBAyeGv0exc
&amp;trackedEntityInstance=gfVxE3ALA9m&amp;startDate=2014-01-01&amp;endDate=2014-12-31</pre></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e4339"></a>1.18.&nbsp;Program rules</h2></div></div></div><p>This section is about sending and reading program rules, and explains the program rules
      data model. The program rules gives functionality to configure dynamic behavior in the
      programs in DHIS.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e4344"></a>1.18.1.&nbsp;Program rules model</h3></div></div></div><p>The program rules data model consists of programRuleVariables, programRules and
        programRuleActions. The programRule contains an expression - when this expression is true,
        the child programRuleActions is triggered. The programRuleVariables is used to address data
        elements, tracked entity data values and other data values needed to run the expressions.
        All programRules in a program share the same library of programRuleVariables, and one
        programRuleVariable can be used in several programRules' expressions. </p><div class="screenshot"><p class="title"><b>DHIS2 Login screen</b></p><div class="mediaobject"><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="80%"><tr><td><img src="resources/images/program_rules/program-rule-model.jpg" width="100%"></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="d6099e4356"></a>1.18.1.1.&nbsp;programRule model details</h4></div></div></div><p>The following table gives a detailed overview over the programRule model.</p><div class="table"><a name="d6099e4361"></a><p class="title"><b>Table&nbsp;1.31.&nbsp; programRule </b></p><div class="table-contents"><table class="table" summary=" programRule " border="1"><colgroup><col class="c1"><col class="c2"><col></colgroup><thead><tr><th>name</th><th>description</th><th>Compulsory</th></tr></thead><tbody><tr><td>program</td><td>The program of which the programRule is executed in.</td><td>Compulsory</td></tr><tr><td>name</td><td>The name with which the program rule will be displayed to dhis configurators.
                  Not visisble to the end user of the program.</td><td>Compulsory</td></tr><tr><td>description</td><td>The description of the program rule, can be used by configurators to describe
                  the rule. Not visisble to the end user of the program.</td><td>Compulsory</td></tr><tr><td>programStage</td><td>If a programStage is set for a program rule, the rule will only be evaluated
                  inside the specified program stage.</td><td>optional</td></tr><tr><td>condition</td><td>The expression that needs to be evaluated to true in order for the program
                  rule to trigger its child actions. The expression is written using operators,
                  function calls, hard coded values, constants and program rule variables.
                  <pre class="screen">d2:hasValue('hemoglobin') &amp;&amp; #{hemoglobin} &lt;= 7</pre></td><td>Compulsory</td></tr><tr><td>priority</td><td>The priority to run the rule in cases where the order of the rules matters.
                  In most cases the rules does not depend on being run before or after other rules,
                  and in these cases the priority can be omitted. If no priority is set, the rule
                  will be run after any rules that has a priority defined. If a priority(integer) is
                  set, the rule with the lowest priority will be run before rules with higher
                  priority.</td><td>optional</td></tr></tbody></table></div></div><br class="table-break"></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="d6099e4421"></a>1.18.1.2.&nbsp;programRuleAction model details</h4></div></div></div><p>The following table gives a detailed overview over the programRuleAction model.</p><div class="table"><a name="d6099e4426"></a><p class="title"><b>Table&nbsp;1.32.&nbsp; programRuleAction </b></p><div class="table-contents"><table class="table" summary=" programRuleAction " border="1"><colgroup><col class="c1"><col class="c2"><col></colgroup><thead><tr><th>name</th><th>description</th><th>Compulsory</th></tr></thead><tbody><tr><td>programRule</td><td>The programRule that is the parent of this action.</td><td>Compulsory</td></tr><tr><td>programRule- ActionType</td><td>The type of action that is to be performed. <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><span class="bold"><strong>DISPLAYTEXT</strong></span> - Displays a text in a
                        given widget.</p></li><li class="listitem"><p><span class="bold"><strong>DISPLAYKEYVALUEPAIR</strong></span> - Displays a key
                        and value pair(like a program indicator) in a given widget.</p></li><li class="listitem"><p><span class="bold"><strong>HIDEFIELD</strong></span> - Hide a specified
                        dataElement or trackedEntityAttribute.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><span class="italic">content</span> - if defined, the text in
                              <span class="italic">content</span> will be displayed to the
                            end user in the instance where a value is previously entered into a
                            field that is now about to be hidden (and therefore blanked). If
                              <span class="italic">content</span> is not defined, a standard
                            message will be shown to the user in this instance. </p></li><li class="listitem"><p><span class="italic">dataElement</span> - if defined*, the
                            HIDEFIELD action will hide this dataElement when the rule is
                            effective.</p></li><li class="listitem"><p><span class="italic">trackedEntityDataValue</span> - if
                            defined*, the HIDEFIELD action will hide this trackedEntityDataValue
                            when the rule is effective. </p></li></ul></div></li><li class="listitem"><p><span class="bold"><strong>HIDESECTION</strong></span> - Hide a specified
                        section.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><span class="italic">programStageSection</span> - must be
                            defined. This is the programStageSection that will be hidden in case the
                            parent rule is effective.</p></li></ul></div></li><li class="listitem"><p><span class="bold"><strong>ASSIGN</strong></span> - Assign a dataElement a
                        value(help the user calculate something or fill in an obvious value
                        somewhere)</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><span class="italic">content</span> - if defined*, the value
                            in <span class="italic">data</span> is assigned to this variable.
                            If content id defined, and thus a variable is assigned for use in other
                            rules, it is important to also assign a <span class="italic">
                              programRule.priority</span> to make sure the rule with an ASSIGN
                            action runs before the rule that will in turn evaluate the assigned
                            variable.</p></li><li class="listitem"><p><span class="italic">data</span> - must be defined, data
                            forms an expression that is evaluated and assigned to either a
                            variable(#{myVariable}), a dataElement, or both.</p></li><li class="listitem"><p><span class="italic">dataElement</span> - if defined*, the
                            value in <span class="italic">data</span> is assigned to this
                            data element.</p></li></ul></div><p>* Either the content or dataElement must be defined for the ASSIGN
                        action to be effective.</p></li><li class="listitem"><p><span class="bold"><strong>SHOWWARNING</strong></span> - Show a warning to the
                        user, not blocking the user from completing the event or
                        registration.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><span class="italic">content</span> - if defined, content is
                            a static part that is displayed at the end of the error message.</p></li><li class="listitem"><p><span class="italic">data</span> - if defined, data forms an
                            expression that is evaluated and added to the end of the warning
                            message.</p></li><li class="listitem"><p><span class="italic">dataElement</span> - if defined*, the
                            warning message is displayed next to this data element.</p></li><li class="listitem"><p><span class="italic">trackedEntityAttribute</span> - if
                            defined*, the warning message is displayed next to this tracked entity
                            attribute.</p></li></ul></div><p>*Either dataElement or trackedEntityAttribute must be specified.</p></li><li class="listitem"><p><span class="bold"><strong>SHOWERROR</strong></span> - Show an error to the user,
                        blocking the user from completing the event or registration.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><span class="italic">content</span> - if defined, content is
                            a static part that is displayed in the start of the error
                            message.</p></li><li class="listitem"><p><span class="italic">data</span> - if defined, data forms an
                            expression that is evaluated and added to the end of the error
                            message.</p></li><li class="listitem"><p><span class="italic">dataElement</span> - if defined*, the
                            error message is linked to this data element.</p></li><li class="listitem"><p><span class="italic">trackedEntityAttribute</span> - if
                            defined*, the error message is linked to this tracked entity
                            attribute.</p></li></ul></div><p>*Either dataElement or trackedEntityAttribute must be specified.</p></li><li class="listitem"><p><span class="bold"><strong>CREATEEVENT</strong></span> - Create an event within
                        the same enrollment.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><span class="italic">content</span></p></li><li class="listitem"><p><span class="italic">data</span> - if defined, contains data
                            values to assign the created event. The format is &lt;uid&gt;:&lt;data
                            value&gt;. Where several values is specified, these are separated with
                            comma.
                            </p><pre class="screen">AcMrnleqHqc:100,AqK1IHqCkEE:'Polyhydramnios'</pre></li><li class="listitem"><p><span class="italic">programStage</span> - must be defined,
                            and designates the program stage that the rule shall create an event
                            of.</p></li></ul></div></li></ul></div></td><td>Compulsory</td></tr><tr><td>location</td><td>Used for actionType DISPLAYKEYVALUEPAIR and DISPLAYTEXT to designate which
                  widget to display the text or keyvalyepair in. Compulsory for DISPLAYKEYVALUEPAIR
                  and DISPLAYTEXT.</td><td>See description</td></tr><tr><td>content</td><td>Used for user messages in the different actions. See the actionType overview
                  for a detailed explanation for how it is used in each of the action types.
                  Compulsory for SHOWWARNING, SHOWERROR, DISPLAYTEXT and DISPLAYKEYVALUEPAIR.
                  Optional for HIDEFIELD and ASSIGN.</td><td>See description</td></tr><tr><td>data</td><td>Used for expressions in the different actions. See the actionType overview
                  for a detailed explanation for how it is used in each of the action types.
                  Compulsory for ASSIGN. Optional for SHOWWARNING, SHOWERROR, DISPLAYTEXT,
                  CREATEEVENT and DISPLAYKEYVALUEPAIR</td><td>See description</td></tr><tr><td>dataElement</td><td>Used for linking rule actions to dataElements. See the actionType overview
                  for a detailed explanation for how it is used in each of the action types.
                  Optional for SHOWWARNING, SHOWERROR, ASSIGN and HIDEFIELD</td><td>See description</td></tr><tr><td>trackedEntity- Attribute</td><td>Used for linking rule actions to trackedEntityAttributes. See the actionType
                  overview for a detailed explanation for how it is used in each of the action
                  types. Optional for SHOWWARNING, SHOWERROR and HIDEFIELD.</td><td>See description</td></tr><tr><td>programStage</td><td>Only used for CREATEEVENT rule actions. Compulsory for CREATEEEVENT.</td><td>See description</td></tr><tr><td>programStage- Section</td><td>Only used for HIDESECTION rule actions. Compulsory for HIDESECTION</td><td>See description</td></tr></tbody></table></div></div><br class="table-break"></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="d6099e4664"></a>1.18.1.3.&nbsp;programRuleVariable model details</h4></div></div></div><p>The following table gives a detailed overview over the programRuleVariable
          model.</p><div class="table"><a name="d6099e4669"></a><p class="title"><b>Table&nbsp;1.33.&nbsp; programRuleVariable </b></p><div class="table-contents"><table class="table" summary=" programRuleVariable " border="1"><colgroup><col class="c1"><col class="c2"><col></colgroup><thead><tr><th>name</th><th>description</th><th>Compulsory</th></tr></thead><tbody><tr><td>name</td><td>the name for the programRuleVariable - this name is used in expressions.
                  <pre class="screen">#{myVariable} &gt; 5</pre></td><td>Compulsory</td></tr><tr><td>sourceType</td><td>Defines how this variable is populated with data from the enrollment and
                  events. <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>DATAELEMENT_NEWEST_EVENT_PROGRAM_STAGE - In tracker capture, gets the 
                        newest value that exists for a dataelement, within the events of a given 
                        program stage in the current enrollment. In event capture, gets the newest
                        value among the 10 newest events on the organisation unit.</p></li><li class="listitem"><p>DATAELEMENT_NEWEST_EVENT_PROGRAM - In tracker capture, get the newest 
                        value that exists for a dataelement across the whole enrollment. 
                        In event capture, gets the newest value among the 10 newest events on the 
                        organisation unit.
                      </p></li><li class="listitem"><p>DATAELEMENT_CURRENT_EVENT - Gets the value of the given dataelement in
                        the current event only.</p></li><li class="listitem"><p>DATAELEMENT_PREVIOUS_EVENT - In tracker capture, gets the newest value that 
                        exists among events in the program that precedes the current event. In event 
                        capture, gets the newvest value among the 10 preceeding events registered
                        on the organisation unit.</p></li><li class="listitem"><p>CALCULATED_VALUE - Used to reserve a variable name that will be assigned
                        by a ASSIGN program rule action</p></li><li class="listitem"><p>TEI_ATTRIBUTE - Gets the value of a given tracked entity
                        attribute</p></li></ul></div></td><td>Compulsory</td></tr><tr><td>dataElement</td><td>Used for linking the programRuleVariable to a dataElement. Compulsory for all
                  sourceTypes that starts with DATAELEMENT_.</td><td>See description</td></tr><tr><td>trackedEntity- Attribute</td><td>Used for linking the programRuleVariable to a trackedEntityAttribute.
                  Compulsory for sourceType TEI_ATTRIBUTE.</td><td>See description</td></tr><tr><td>programStage</td><td>Used for specifying a specific program stage to retreive the
                  programRuleVariable value from. Compulsory for
                  DATAELEMENT_NEWEST_EVENT_PROGRAM_STAGE.</td><td>See description</td></tr></tbody></table></div></div><br class="table-break"></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e4741"></a>1.18.2.&nbsp;Posting rules through the API</h3></div></div></div><p>-coming-</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e4746"></a>1.19.&nbsp;Forms</h2></div></div></div><p>To retrieve information about a form (which corresponds to a data set and its sections)
      you can interact with the <span class="italic">form</span> resource. The form response
      is accessible as XML and JSON and will provide information about each section (group) in the
      form as well as each field in the sections, including label and identifiers. By supplying
      period and organisation unit identifiers the form response will be populated with data values. </p><div class="table"><a name="d6099e4754"></a><p class="title"><b>Table&nbsp;1.34.&nbsp;Form query parameters</b></p><div class="table-contents"><table class="table" summary="Form query parameters" border="1"><colgroup><col class="c1"><col class="newCol2"><col class="c2"></colgroup><thead><tr><th>Parameter</th><th>Option</th><th>Description</th></tr></thead><tbody><tr><td>pe</td><td>ISO period</td><td>Period for which to populate form data values.</td></tr><tr><td>ou</td><td>UID</td><td>Organisation unit for which to populate form data values.</td></tr><tr><td>metaData</td><td>false | true</td><td>Whether to include metadata about each data element of form sections.</td></tr></tbody></table></div></div><br class="table-break"><p>To retrieve the form for a data set you can do a GET request like this:</p><pre class="screen">api/dataSets/&lt;dataset-id&gt;/form.json</pre><p>To retrieve the form for the data set with identifier "BfMAe6Itzgt" in
      XML:</p><pre class="screen">api/dataSets/BfMAe6Itzgt/form</pre><p>To retrieve the form including metadata in JSON:</p><pre class="screen">api/dataSets/BfMAe6Itzgt/form.json?metaData=true</pre><p>To retrieve the form filled with data values for a specific period and organisation unit
      in XML:</p><pre class="screen">api/dataSets/BfMAe6Itzgt/form.xml?ou=DiszpKrYNg8&amp;pe=201401</pre><p>When it comes to custom data entry forms, this resource also allows for creating such
      forms directly for a data set. This can be done through a POST or PUT request with content
      type text/html where the payload is the custom form markup such as:</p><pre class="screen">curl -d @form.html "localhost/api/dataSets/BfMAe6Itzgt/form" 
-H "Content-Type:text/html" -u admin:district -X PUT -v</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e4811"></a>1.20.&nbsp;Validation</h2></div></div></div><p>To generate a data validation summary you can interact with the validation resource. The
      dataSet resource is optimized for data entry clients for validating a data set / form, and can
      be accessed like
      this:</p><pre class="screen">api/validation/dataSet/QX4ZTUbOt3a.json?pe=201501&amp;ou=DiszpKrYNg8</pre><p>The first path variable is an identifier referring to the data set to validate. XML and
      JSON resource representations are supported. The response contains violations to validation
      rules. This will be extended with more validation types in coming versions.</p><p>To retrieve validation rules which are relevant for a specific data set, meaning
      validation rules with formulas where all data elements are part of the specific data set, you
      can make a GET request to to <span class="italic">validationRules</span> resource like
      this:</p><pre class="screen">api/validationRules?dataSet=&lt;dataset-id&gt;</pre><p>The validation rules have a left side and a right side, which is compared for validity
      according to an operator. The valid operator values are found in the table below.</p><p>
      </p><div class="table"><a name="d6099e4831"></a><p class="title"><b>Table&nbsp;1.35.&nbsp;Operators</b></p><div class="table-contents"><table class="table" summary="Operators" border="1"><colgroup><col class="c1"><col class="c2"></colgroup><thead><tr><th>Value</th><th>Description</th></tr></thead><tbody><tr><td>equal_to</td><td>Equal to</td></tr><tr><td>not_equal_to</td><td>Not equal to</td></tr><tr><td>greater_than</td><td>Greater than</td></tr><tr><td>greater_than_or_equal_to</td><td>Greater than or equal to</td></tr><tr><td>less_than</td><td>Less than</td></tr><tr><td>less_than_or_equal_to</td><td>Less than or equal to</td></tr></tbody></table></div></div><p><br class="table-break">
    </p><p>The left side and right side expressions are mathematical expressions which can contain
      references to data elements and category option combinations on the following
      format:</p><pre class="screen">${&lt;dataelement-id&gt;.&lt;catoptcombo-id&gt;}</pre><p>The left side and right side expressions have a <span class="italic">missing value
        strategy</span>. This refers to how the system should treat data values which are
      missing for data elements / category option combination references in the formula in terms of
      whether the validation rule should be checked for validity or skipped. The valid missing value
      strategies are found in the table below.</p><p>
      </p><div class="table"><a name="d6099e4886"></a><p class="title"><b>Table&nbsp;1.36.&nbsp;Missing value strategies</b></p><div class="table-contents"><table class="table" summary="Missing value strategies" border="1"><colgroup><col class="c1"><col class="c2"></colgroup><thead><tr><th>Value</th><th>Description</th></tr></thead><tbody><tr><td>SKIP_IF_ANY_VALUE_MISSING</td><td>Skip validation rule if any data value is missing</td></tr><tr><td>SKIP_IF_ALL_VALUES_MISSING</td><td>Skip validation rule if all data values are missing</td></tr><tr><td>NEVER_SKIP</td><td>Never skip validation rule irrespective of missing data values</td></tr></tbody></table></div></div><p><br class="table-break">
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e4915"></a>1.21.&nbsp;Data integrity</h2></div></div></div><p>The data integrity capabilities of the data administration module are available through
      the web API. This section describes how to run the data integrity process as well as
      retrieving the result. The details of the analysis performed are described in the user
      manual.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e4920"></a>1.21.1.&nbsp;Running data integrity</h3></div></div></div><p>The operation of measuring data integrity is a fairly resource (and time) demanding
        task. It is therefore run as an asynchronous process and only when explicitly requested.
        Starting the task is done by forming an empty POST request to the <span class="italic">dataIntegrity</span> endpoint like so (demonstrated in curl
        syntax):</p><pre class="screen">curl -X POST https://dhis.domain/api/dataIntegrity</pre><p>If successful the request will return HTTP 202 immediately. The location header of the
        response points to the resource used to check the status of the request. Forming a GET
        request to the given location yields an empty JSON response if the task has not yet
        completed and a JSON taskSummary object when the task is done. Polling (conservatively) to
        this resource can hence be used to wait for the task to finish.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e4932"></a>1.21.2.&nbsp;Fetching the result</h3></div></div></div><p>Once data integrity is finished running the result can be fetched from the <span class="italic">system/taskSummaries</span> resource like
        so:</p><pre class="screen">curl -X GET https://dhis.domain/api/system/taskSummaries/DATAINTEGRITY</pre><p>The returned object contains a summary for each point of analysis, listing the names of
        the relevant integrity violations. As stated in the leading paragraph for this section the
        details of the analysis (and the resulting data) can be found in the user manual chapter on
        Data Administration.</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e4944"></a>1.22.&nbsp;Indicators</h2></div></div></div><p>This section describes indicators and indicator expressions.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e4949"></a>1.22.1.&nbsp;Aggregate indicators</h3></div></div></div><p>To retrieve indicators you can make a GET request to the indicators resource like
        this:</p><pre class="screen">/api/indicators</pre><p>Indicators represent expressions which can be calculated and presented as a result. The
        indicator expressions are split into a numerator and denominator. The numerators and
        denominators are mathematical expressions which can contain references to data elements,
        constants and organisation unit groups. The variables will be substituted with data values
        when used e.g. in reports. Variables which are allowed in expressions are described in the
        following table.</p><p>
        </p><div class="table"><a name="d6099e4960"></a><p class="title"><b>Table&nbsp;1.37.&nbsp;Indicator variables</b></p><div class="table-contents"><table class="table" summary="Indicator variables" border="1"><colgroup><col class="c1"><col class="newCol2"><col class="c2"></colgroup><thead><tr><th>Variable</th><th>Object</th><th>Description</th></tr></thead><tbody><tr><td>#{&lt;dataelement-id&gt;.&lt;catoptcombo-id&gt;}</td><td>Data element operand</td><td>Refers to a combination of an aggregate data element and a category option
                  combination.</td></tr><tr><td>#{&lt;dataelement-id&gt;}</td><td>Aggregate data element</td><td>Refers to the total value of an aggregate data element across all category
                  option combinations.</td></tr><tr><td>D{&lt;program-id&gt;.&lt;dataelement-id&gt;</td><td>Program data element</td><td>Refers to the value of a tracker data element within a program.</td></tr><tr><td>A{&lt;program-id&gt;.&lt;attribute-id&gt;</td><td>Program tracked entity attribute</td><td>Refers to the value of a tracked entity attribute within a program.</td></tr><tr><td>I{program-indicator-id&gt;</td><td>Program indicator</td><td>Refers to the value of a program indicator.</td></tr><tr><td>C{&lt;constant-id&gt;}</td><td>Constant</td><td>Refers to a constant value.</td></tr><tr><td>OUG{&lt;orgunitgroup-id&gt;}</td><td>Organisation unit group</td><td>Refers to the count of organisation units within an organisation unit
                  group.</td></tr></tbody></table></div></div><p><br class="table-break">
      </p><p>The syntax looks like
        this:</p><pre class="screen">#{&lt;dataelement-id&gt;.&lt;catoptcombo-id&gt;} + C{&lt;constant-id&gt;} + OUG{&lt;orgunitgroup-id&gt;}</pre><p>A corresponding example looks like
        this:</p><pre class="screen">#{P3jJH5Tu5VC.S34ULMcHMca} + C{Gfd3ppDfq8E} + OUG{CXw2yu5fodb}</pre><p>Note that for data element variables the category option combo identifier can be
        omitted. The variable will then represent the total for the data element, e.g. across all
        category option combos. Example:</p><pre class="screen">#{P3jJH5Tu5VC} + 2</pre><p>An example which use a program data element and a program
        attribute:</p><pre class="screen">( D{eBAyeGv0exc.vV9UWAZohSf} * A{IpHINAT79UW.cejWyOfXge6} ) / D{eBAyeGv0exc.GieVkTxp4HH}</pre><p>An example which combines program indicators and aggregate
        indicators:</p><pre class="screen">I{EMOt6Fwhs1n} * 1000 / #{WUg3MYWQ7pt}</pre><p>Expressions can be any kind of valid mathematical expression, as an
        example:</p><pre class="screen">( 2 * #{P3jJH5Tu5VC.S34ULMcHMca} ) / ( #{FQ2o8UBlcrS.S34ULMcHMca} - 200 ) * 25</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e5050"></a>1.22.2.&nbsp;Program indicators</h3></div></div></div><p>To retrieve program indicators you can make a GET request to the program indicators
        resource like this:</p><pre class="screen">api/programIndicators</pre><p>Program indicators can contain information collected in a program. Indicators have an
        expression which can contain references to data elements, attributes, constants and program
        variables. Variables which are allowed in expressions are described in the following
        table.</p><p>
        </p><div class="table"><a name="d6099e5061"></a><p class="title"><b>Table&nbsp;1.38.&nbsp;Program indicator variables</b></p><div class="table-contents"><table class="table" summary="Program indicator variables" border="1"><colgroup><col class="c1"><col class="c2"></colgroup><thead><tr><th>Variable</th><th>Description</th></tr></thead><tbody><tr><td>#{&lt;programstage-id&gt;.&lt;dataelement-id&gt;}</td><td>Refers to a combination of program stage and data element id.</td></tr><tr><td>#{&lt;attribute-id&gt;}</td><td>Refers to a tracked entity attribute.</td></tr><tr><td>V{&lt;varible-id&gt;}</td><td>Refers to a program variable.</td></tr><tr><td>C{&lt;constant-id&gt;}</td><td>Refers to a constant.</td></tr></tbody></table></div></div><p><br class="table-break">
      </p><p>The syntax looks like
        this:</p><pre class="screen">#{&lt;programstage-id&gt;.&lt;dataelement-id&gt;} + #{&lt;attribute-id&gt;} + V{&lt;varible-id&gt;} + C{&lt;constant-id&gt;}</pre><p>A corresponding example looks like this:
        </p><pre class="screen">#{A03MvHHogjR.a3kGcGDCuk6} + A{OvY4VVhSDeJ} + V{incident_date} + C{bCqvfPR02Im}</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e5103"></a>1.22.3.&nbsp;Expressions</h3></div></div></div><p>Expressions are mathematical formulas which can contain references to data elements,
        constants and organisation unit groups. To validate and get the textual description of an
        expression you can make a GET request to the expressions
        resource:</p><pre class="screen">api/expressions/description?expression=&lt;expression-string&gt;</pre><p>The response follows the standard JSON web message format. The <span class="italic">status</span> property indicates the outcome of the validation and will be
        "OK" if successful and "ERROR" if failed. The <span class="italic">message</span> property will be "Valid" if successful and provide a textual
        description of the reason why the validation failed if not. The <span class="italic">description</span> provides a textual description of the
        expression.</p><pre class="screen">{
    "httpStatus": "OK",
    "httpStatusCode": 200,
    "status": "OK",
    "message": "Valid",
    "description": "Acute Flaccid Paralysis"
}</pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e5123"></a>1.23.&nbsp;Complete data set registrations</h2></div></div></div><p>This section is about complete data set registrations for data sets. A registration marks
      as a data set as completely captured.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e5128"></a>1.23.1.&nbsp;Completing and un-completing data sets</h3></div></div></div><p>This section explains how you can register and un-register a data set as complete. To
        complete or un-complete a data set you will interact with the completeDataSetRegistrations
        resource:</p><pre class="screen">/api/completeDataSetRegistrations</pre><p>This resource supports the methods <span class="italic">POST</span> for
        registration and <span class="italic">DELETE</span> for un-registration. The
        following query parameters are supported:</p><div class="table"><a name="d6099e5143"></a><p class="title"><b>Table&nbsp;1.39.&nbsp;Complete data set registrations query parameters</b></p><div class="table-contents"><table class="table" summary="Complete data set registrations query parameters" border="1"><colgroup><col class="c1"><col class="c2"><col class="c3"></colgroup><thead><tr><th>Query parameter</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>ds</td><td>Yes</td><td>Data set identifier</td></tr><tr><td>pe</td><td>Yes</td><td>Period identifier</td></tr><tr><td>ou</td><td>Yes</td><td>Organisation unit identifier</td></tr><tr><td>cc</td><td>No (must combine with cp)</td><td>Attribute combo identifier (for locking check)</td></tr><tr><td>cp</td><td>No (must combine with cp)</td><td>Attribute option identifiers, separated with ; for multiple values (for locking
                check)</td></tr><tr><td>multiOu</td><td>No (default false)</td><td>Whether registration applies to sub units</td></tr></tbody></table></div></div><br class="table-break"></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e5201"></a>1.23.2.&nbsp;Reading complete data set registrations</h3></div></div></div><p>This section explains how to retrieve data set completeness registrations. We will be
        using the <span class="italic">completeDataSetRegistrations</span> resource. The
        query parameters to use are these:</p><div class="table"><a name="d6099e5209"></a><p class="title"><b>Table&nbsp;1.40.&nbsp;Data value set query parameters</b></p><div class="table-contents"><table class="table" summary="Data value set query parameters" border="1"><colgroup><col width="95pt" class="c1"><col width="425pt" class="c2"></colgroup><thead><tr><th>Parameter</th><th>Description</th></tr></thead><tbody><tr><td>dataSet</td><td>Data set identifier, can be specified multiple times</td></tr><tr><td>period</td><td>PeriodType</td></tr><tr><td>startDate</td><td>Start date for the time span of the values to export</td></tr><tr><td>endDate</td><td>End date for the time span of the values to export</td></tr><tr><td>orgUnit</td><td>Organisation unit identifier, can be specified multiple times</td></tr><tr><td>children</td><td>Whether to include the children in the hierarchy of the organisation
                units</td></tr></tbody></table></div></div><br class="table-break"><p>The dataSet and orgUnit parameters can be repeated in order to include multiple data
        sets and organisation units. An example request looks like
        this:</p><pre class="screen">curl "https://play.dhis2.org/demo/api/completeDataSetRegistrations?
dataSet=pBOMPrpg1QX&amp;dataSet=pBOMPrpg1QX&amp;startDate=2014-01-01&amp;endDate=2014-01-31
&amp;orgUnit=YuQRtpLP10I&amp;orgUnit=vWbkYPRmKyS&amp;children=true" -H "Accept:application/xml" -u admin:district -v</pre><p>You can get the response in <span class="italic">xml</span> and <span class="italic">json</span> format. You can indicate which response format you prefer
        through the <span class="italic">Accept</span> HTTP header like in the example above.
        For xml you use <span class="italic">application/xml</span>; for json you use
          <span class="italic">application/json</span>.</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e5273"></a>1.24.&nbsp;Data approval</h2></div></div></div><p>This section explains how to approve, unapprove and check approval status using the
        <span class="italic">dataApprovals</span> resource. Approval is done per data set,
      period, organisation unit and attribute option
      combo.</p><pre class="screen">/api/dataApprovals</pre><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e5283"></a>1.24.1.&nbsp;Get approval status</h3></div></div></div><p>To get approval information for a data set you can issue a GET request similar to
        this:</p><pre class="screen">GET http://server.com/api/dataApprovals?ds=aLpVgfXiz0f&amp;pe=2013&amp;ou=DiszpKrYNg8</pre><div class="table"><a name="d6099e5290"></a><p class="title"><b>Table&nbsp;1.41.&nbsp;Data approval query parameters</b></p><div class="table-contents"><table class="table" summary="Data approval query parameters" border="1"><colgroup><col class="c1"><col class="c2"><col class="c3"></colgroup><thead><tr><th>Query parameter</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>ds</td><td>Yes</td><td>Data set identifier</td></tr><tr><td>pe</td><td>Yes</td><td>Period identifier</td></tr><tr><td>ou</td><td>Yes</td><td>Organisation unit identifier</td></tr></tbody></table></div></div><br class="table-break"><p>This will give you a response something like this:</p><pre class="screen">{
  "mayApprove": false,
  "mayUnapprove": false,
  "mayAccept": false,
  "mayUnaccept": false,
  "state": "UNAPPROVED_ELSEWHERE"
}</pre><p>The returned parameters are:</p><div class="table"><a name="d6099e5333"></a><p class="title"><b>Table&nbsp;1.42.&nbsp;Data approval query parameters</b></p><div class="table-contents"><table class="table" summary="Data approval query parameters" border="1"><colgroup><col class="c1"><col class="c2"></colgroup><thead><tr><th>Return Parameter</th><th>Description</th></tr></thead><tbody><tr><td>mayApprove</td><td>Whether the current user may approve this data selection.</td></tr><tr><td>mayUnapprove</td><td>Whether the current user may unapprove this data selection.</td></tr><tr><td>mayAccept</td><td>Whether the current user may accept this data selection.</td></tr><tr><td>mayUnaccept</td><td>Whether the current user may unaccept this data selection.</td></tr><tr><td>state</td><td>One of the data approval states from the table below.</td></tr></tbody></table></div></div><br class="table-break"><div class="table"><a name="d6099e5371"></a><p class="title"><b>Table&nbsp;1.43.&nbsp;Data approval states</b></p><div class="table-contents"><table class="table" summary="Data approval states" border="1"><colgroup><col class="c1"><col class="c2"></colgroup><thead><tr><th>State</th><th>Description</th></tr></thead><tbody><tr><td>UNAPPROVABLE</td><td>Data approval does not apply to this selection. (Data is neither
                "approved" nor "unapproved".)</td></tr><tr><td>UNAPPROVED_WAITING</td><td>Data could be approved for this selection, but is waiting for some lower-level
                approval before it is ready to be approved.</td></tr><tr><td>UNAPPROVED_ELSEWHERE</td><td>Data is unapproved, and is waiting for approval somewhere else (not approvable
                here.)</td></tr><tr><td>UNAPPROVED_READY</td><td>Data is unapproved, and is ready to be approved for this selection.</td></tr><tr><td>APPROVED_HERE</td><td>Data is approved, and was approved here (so could be unapproved here.)</td></tr><tr><td>APPROVED_ELSEWHERE</td><td>Data is approved, but was not approved here (so cannot be unapproved here.)
                This covers the following cases: <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Data is approved at a higher level.</p></li><li class="listitem"><p>Data is approved for wider scope of category options.</p></li><li class="listitem"><p>Data is approved for all sub-periods in selected period.</p></li></ul></div> In the first two cases, there is a single data approval object that
                covers the selection. In the third case there is not. </td></tr><tr><td>ACCEPTED_HERE</td><td>Data is approved and accepted here (so could be unapproved here.)</td></tr><tr><td>ACCEPTED_ELSEWHERE</td><td>Data is approved and accepted, but elsewhere.</td></tr></tbody></table></div></div><br class="table-break"><p>Note that when querying for the status of data approval, you may specify any combination
        of the query parameters. The combination you specify does not need to describe the place
        where data is to be approved at one of the approval levels. For example:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>The organisation unit might not be at an approval level. The approval status is
            determined by whether data is approved at an approval level for an ancestor of the
            organisation unit.</p></li><li class="listitem"><p>You may specify individual attribute category options. The approval status is
            determined by whether data is approved for an attribute category option combination that
            includes one or more of these options.</p></li><li class="listitem"><p>You may specify a time period that is longer than the period for the data set at
            which the data is entered and approvede. The approval status is determined by whether
            the data is approved for all the data set periods within the period you specify.</p></li></ul></div><p>For data sets which are associated with a category combo you might want to fetch data
        approval records for individual attribute option combos from the following
        resource:</p><pre class="screen">GET api/dataApprovals/categoryOptionCombos?ds=aLpVgfXiz0f&amp;pe=2013&amp;ou=DiszpKrYNg8</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e5451"></a>1.24.2.&nbsp;Approve data</h3></div></div></div><p>To approve data you can issue a <span class="italic">POST</span> request to the
          <span class="italic">dataApprovals</span> resource. To un-approve data you can
        issue a <span class="italic">DELETE</span> request to the dataApprovals
        resource.</p><pre class="screen">POST DELETE api/dataApprovals</pre><p>To accept data you can issue a <span class="italic">POST</span> request to the
          <span class="italic">dataApprovals/acceptances</span> resource. To un-accept data
        you can issue a <span class="italic">DELETE</span> request to the <span class="italic">dataApprovals/acceptances</span> resource.</p><pre class="screen">POST DELETE dataApprovals/acceptances</pre><p>These requests contain the following parameters:</p><div class="table"><a name="d6099e5485"></a><p class="title"><b>Table&nbsp;1.44.&nbsp;Data approval action parameters</b></p><div class="table-contents"><table class="table" summary="Data approval action parameters" border="1"><colgroup><col class="c1"><col class="c2"><col class="c3"></colgroup><thead><tr><th>Action parameter</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>ds</td><td>Yes</td><td>Data set identifier</td></tr><tr><td>pe</td><td>Yes</td><td>Period identifier</td></tr><tr><td>ou</td><td>Yes</td><td>Organisation unit identifier</td></tr></tbody></table></div></div><br class="table-break"><p>Note that, unlike querying the data approval status, you must specify parameters that
        correspond to a selection of data that could be approved. In particular, all of the
        following must be true:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>The organisation unit's level must be specified by an approval level.</p></li><li class="listitem"><p>The time period specified must match the period type of the data set.</p></li><li class="listitem"><p>The data set must specify that data can be approved for this data set.</p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e5534"></a>1.24.3.&nbsp;Bulk approve data</h3></div></div></div><p>You can approve a bulk of data records by posting to the<span class="italic">
          api/dataApprovals/approvals</span>
        resource.</p><pre class="screen">POST api/dataApprovals/approvals</pre><p>You can unapprove a bulk of data records by posting to the <span class="italic">api/dataApprovals/unapprovals</span>
        resource.</p><pre class="screen">POST api/dataApprovals/unapprovals</pre><p>You can accept a bulk of records by posting to the <span class="italic">api/dataAcceptances/acceptances</span>
        resource.</p><pre class="screen">POST api/dataAcceptances/acceptances</pre><p>You can unaccept a bulk of records by posting to the <span class="italic">api/dataAcceptances/unacceptances</span>
        resource.</p><pre class="screen">POST api/dataAcceptances/unacceptances</pre><p>The approval payload is supported as JSON and looks like
        this:</p><pre class="screen">{
  "ds": [
    "pBOMPrpg1QX", "lyLU2wR22tC"
  ],
  "pe": [
    "201601", "201602"
  ],
  "approvals": [{
      "ou": "cDw53Ej8rju",
      "aoc": "ranftQIH5M9"
    }, {
      "ou": "cDw53Ej8rju",
      "aoc": "fC3z1lcAW5x"
    }]
}</pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e5569"></a>1.25.&nbsp;Auditing</h2></div></div></div><p>DHIS 2 does automatic auditing on all update and deletions of aggregate data values,
      tracked entity data values, tracked entity attribute values, and this chapter will explain the
      web-api available for fetching this data back out again.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e5574"></a>1.25.1.&nbsp;Aggregate data value audits</h3></div></div></div><p>The endpoint for aggregate data value audits is located at <span class="italic">/api/audits/dataValue</span>, and the available parameters are displayed in the table
        below.</p><p>
        </p><div class="table"><a name="d6099e5584"></a><p class="title"><b>Table&nbsp;1.45.&nbsp;Aggregate data value query parameters</b></p><div class="table-contents"><table class="table" summary="Aggregate data value query parameters" border="1"><colgroup><col class="c1"><col class="newCol2"><col class="c2"></colgroup><thead><tr><th>Parameter</th><th>Option</th><th>Description</th></tr></thead><tbody><tr><td>ds</td><td>Data Set</td><td>One or more data set identifiers to get data elements from.</td></tr><tr><td>de</td><td>Data Element</td><td>One or more data element identifiers.</td></tr><tr><td>pe</td><td>ISO Period</td><td>One or more period ISO identifiers.</td></tr><tr><td>ou</td><td>Organisation Unit</td><td>One or more org unit identifiers.</td></tr><tr><td>auditType</td><td>UPDATE | DELETE</td><td>Filter by audit type.</td></tr><tr><td>skipPaging</td><td>false | true</td><td>Turn paging on / off</td></tr><tr><td>page</td><td>1 (default)</td><td>If paging is enabled, this parameter decides which page to show</td></tr></tbody></table></div></div><p><br class="table-break">
      </p><p>Get all audits for data set with ID
        "lyLU2wR22tC":</p><pre class="screen">/api/audits/dataValue?ds=lyLU2wR22tC</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e5654"></a>1.25.2.&nbsp;Tracked entity data value audits</h3></div></div></div><p>The endpoint for tracked entity data value audits is located at <span class="italic">/api/audits/trackedEntityDataValue</span>, and the available parameters are displayed
        in the table below.</p><div class="table"><a name="d6099e5662"></a><p class="title"><b>Table&nbsp;1.46.&nbsp;Tracked entity data value query parameters</b></p><div class="table-contents"><table class="table" summary="Tracked entity data value query parameters" border="1"><colgroup><col class="c1"><col class="newCol2"><col class="c2"></colgroup><thead><tr><th>Parameter</th><th>Option</th><th>Description</th></tr></thead><tbody><tr><td>de</td><td>Data Element</td><td>One or more data element identifiers.</td></tr><tr><td>ps</td><td>Program Stage Entity</td><td>One or more program stage instance identifiers.</td></tr><tr><td>auditType</td><td>UPDATE | DELETE</td><td>Filter by audit type.</td></tr><tr><td>skipPaging</td><td>false | true</td><td>Turn paging on / off</td></tr><tr><td>page</td><td>1 (default)</td><td>If paging is enabled, this parameter decides which page to show</td></tr></tbody></table></div></div><br class="table-break"><p>Get all audits which have data element ID eMyVanycQSC or
        qrur9Dvnyt5:</p><pre class="screen">/api/audits/trackedEntityDataValue?de=eMyVanycQSC&amp;de=qrur9Dvnyt5</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e5717"></a>1.25.3.&nbsp;Tracked entity attribute value audits</h3></div></div></div><p>The endpoint for tracked entity attribute value audits is located at <span class="italic">/api/audits/trackedEntityAttributeValue</span>, and the available
        parameters are displayed in the table below.</p><div class="table"><a name="d6099e5725"></a><p class="title"><b>Table&nbsp;1.47.&nbsp;Tracked entity attribute value query parameters</b></p><div class="table-contents"><table class="table" summary="Tracked entity attribute value query parameters" border="1"><colgroup><col class="c1"><col class="newCol2"><col class="c2"></colgroup><thead><tr><th>Parameter</th><th>Option</th><th>Description</th></tr></thead><tbody><tr><td>tea</td><td>Tracked Entity Attributes</td><td>One or more tracked entity attribute identifiers.</td></tr><tr><td>te</td><td>Tracked Entity Instances</td><td>One or more tracked entity instance identifiers.</td></tr><tr><td>auditType</td><td>UPDATE | DELETE</td><td>Filter by audit type.</td></tr><tr><td>skipPaging</td><td>false | true</td><td>Turn paging on / off</td></tr><tr><td>page</td><td>1 (default)</td><td>If paging is enabled, this parameter decides which page to show</td></tr></tbody></table></div></div><br class="table-break"><p>Get all audits which have attribute with ID
        VqEFza8wbwA:</p><pre class="screen">/api/audits/trackedEntityAttributeValue?tea=VqEFza8wbwA</pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e5780"></a>1.26.&nbsp;Message conversations</h2></div></div></div><p>DHIS 2 features a mechanism for sending messages for purposes such as user feedback,
      notifications and general information to users. Messages are grouped into conversations. To
      interact with message conversations you can send POST and GET request to the <span class="italic">messageConversations</span>
      resource.</p><pre class="screen">/api/messageConversations</pre><p>Messages are delivered to the DHIS 2
      message inbox but can also be sent to the user's email addresses and mobile phones as
      SMS. In this example we will see how we can utilize the Web API to send, read and manage
      messages. We will pretend to be the <span class="italic">DHIS Administrator</span> user
      and send a message to the <span class="italic">Mobile</span> user. We will then pretend
      to be the mobile user and read our new message. Following this we will manage the admin user
      inbox by marking and removing messages.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e5797"></a>1.26.1.&nbsp;Writing and reading messages</h3></div></div></div><p>The resource we need to interact with when sending and reading messages is the <span class="italic">messageConversations</span> resource. We start by visiting the Web API
        entry point at <a class="link" href="http://play.dhis2.org/demo/api" target="_top">http://play.dhis2.org/demo/api</a> where we find and follow the
        link to the <span class="italic">messageConversations</span> resource at <a class="link" href="http://play.dhis2.org/demo/api/messageConversations" target="_top">http://play.dhis2.org/demo/api/messageConversations</a>. The description tells us that
        we can use a POST request to create a new message using the following XML format for sending
        to multiple users:</p><p>
        </p><pre class="screen">&lt;message xmlns="http://dhis2.org/schema/dxf/2.0"&gt;
  &lt;subject&gt;This is the subject&lt;/subject&gt;
  &lt;text&gt;This is the text&lt;/text&gt;
  &lt;users&gt;
    &lt;user id="user1ID" /&gt;
    &lt;user id="user2ID" /&gt;
    &lt;user id="user3ID" /&gt;
  &lt;/users&gt;
&lt;/message&gt;</pre><p>
      </p><p>For sending to all users contained in one or more user groups, we can use:</p><p>
        </p><pre class="screen">&lt;message xmlns="http://dhis2.org/schema/dxf/2.0"&gt;
  &lt;subject&gt;This is the subject&lt;/subject&gt;
  &lt;text&gt;This is the text&lt;/text&gt;
  &lt;userGroups&gt;
    &lt;userGroup id="userGroup1ID" /&gt;
    &lt;userGroup id="userGroup2ID" /&gt;
    &lt;userGroup id="userGroup3ID" /&gt;
  &lt;/userGroups&gt;
&lt;/message&gt;</pre><p>
      </p><p>For sending to all users connected to one or more organisation units, we can use:</p><p>
        </p><pre class="screen">&lt;message xmlns="http://dhis2.org/schema/dxf/2.0"&gt;
  &lt;subject&gt;This is the subject&lt;/subject&gt;
  &lt;text&gt;This is the text&lt;/text&gt;
  &lt;organisationUnits&gt;
    &lt;organisationUnit id="ou1ID" /&gt;
    &lt;organisationUnit id="ou2ID" /&gt;
    &lt;organisationUnit id="ou3ID" /&gt;
  &lt;/organisationUnits&gt;
&lt;/message&gt;</pre><p>
      </p><p>Since we want to send a message to our friend the mobile user we need to look up her
        identifier. We do so by going to the Web API entry point and follow the link to the
          <span class="italic">users</span> resource at <a class="link" href="http://play.dhis2.org/demo/api/users" target="_top">http://play.dhis2.org/demo/api/users</a>. We continue by following link to the mobile
        user at <a class="link" href="http://play.dhis2.org/demo/api/users/PhzytPW3g2J" target="_top">http://play.dhis2.org/demo/api/users/PhzytPW3g2J</a> where we learn that
        her identifier is <span class="italic">PhzytPW3g2J</span>. We are now ready to put
        our XML message together to form a message where we want to ask the mobile user whether she
        has reported data for January 2014:</p><pre class="screen">&lt;message xmlns="http://dhis2.org/schema/dxf/2.0"&gt;
  &lt;subject&gt;Mortality data reporting&lt;/subject&gt;
  &lt;text&gt;Have you reported data for the Mortality data set for January 2014?&lt;/text&gt;
  &lt;users&gt;
    &lt;user id="PhzytPW3g2J" /&gt;
  &lt;/users&gt;
&lt;/message&gt;</pre><p>To test this we save the XML content into a file called <span class="italic">message.xml</span>. We use cURL to dispatch the message the the DHIS 2 demo instance
        where we indicate that the content-type is XML and authenticate as the <span class="italic">admin</span> user:</p><pre class="screen">curl -d @message.xml "https://play.dhis2.org/demo/api/messageConversations" 
-H "Content-Type:application/xml" -u admin:district -X POST -v</pre><p>A corresponding payload in JSON and POST command look like this:</p><pre class="screen">{
  "subject": "Hey",
  "text": "How are you?",
  "users": [
    {
      "id": "OYLGMiazHtW"
    },
    {
      "id": "N3PZBUlN8vq"
    }
  ],
  "userGroups": [
    {
      "id": "ZoHNWQajIoe"
    }
  ],
  "organisationUnits": [
    {
      "id": "DiszpKrYNg8"
    }
  ]
}      </pre><pre class="screen">curl -d @message.json "https://play.dhis2.org/demo/api/messageConversations" -H "Content-Type:application/json" -u admin:district -X POST -v</pre><p>If all is well we receive a <span class="italic">201 Created</span> HTTP status
        code. Also note that we receive a <span class="italic">Location </span>HTTP header
        which value informs us of the URL of the newly created message conversation resource - this
        can be used by a consumer to perform further action.</p><p>We will now pretend to be the mobile user and read te message which was just sent by
        dispatching a GET request to the <span class="italic">messageConversations</span>
        resource. We supply an <span class="italic">Accept</span> header with <span class="italic">application/xml</span> as the value to indicate that we are interested
        in the XML resource representation and we authenticate as the <span class="italic">mobile</span> user:</p><pre class="screen">curl "https://play.dhis2.org/demo/api/messageConversations" 
-H "Accept:application/xml" -u mobile:district -X GET -v</pre><p>In response we get the following XML:</p><pre class="screen">&lt;messageConversations xmlns="http://dhis2.org/schema/dxf/2.0"
  link="https://play.dhis2.org/demo/api/messageConversations"&gt;
  &lt;messageConversation name="Mortality data reporting" id="ZjHHSjyyeJ2"
    link="https://play.dhis2.org/demo/api/messageConversations/ZjHHSjyyeJ2"/&gt;
  &lt;messageConversation name="DHIS version 2.7 is deployed" id="GDBqVfkmnp2"
    link="https://play.dhis2.org/demo/api/messageConversations/GDBqVfkmnp2"/&gt;
&lt;/messageConversations&gt;</pre><p>From the response we are able to read the identifier of the newly sent message which is
          <span class="italic">ZjHHSjyyeJ2</span>. Note that the link to the specific
        resource is embedded and can be followed in order to read the full message. From the
        description at <a class="link" href="http://play.dhis2.org/demo/api/messageConversations" target="_top">http://play.dhis2.org/demo/api/messageConversations</a> we learned
        that we can reply directly to an existing message conversation once we know the URL by
        including the message text as the request payload (body). We are now able to construct a URL
        for sending our reply:</p><pre class="screen">curl -d "Yes the Mortality data set has been reported" 
"https://play.dhis2.org/demo/api/messageConversations/ZjHHSjyyeJ2" 
-H "Content-Type:text/plain" -u mobile:district -X POST -v</pre><p>If all went according to plan you will receive a <span class="italic">200
          OK</span> status code.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e5903"></a>1.26.2.&nbsp;Managing messages</h3></div></div></div><p><span class="emphasis"><em>Note: the Web-API calls discussed in this section were introduced in DHIS
          2.17</em></span></p><p>As users receive and send messages, conversations will start to pile up in their
        inboxes, eventually becoming laborious to track. We will now have a look at managing a users
        message inbox by removing and marking conversations through the Web-API. We will do so by
        performing some maintenance in the inbox of the <span class="italic">DHIS
          Administrator</span> user.</p><p>First, let's have a look at removing a few messages from the inbox. Be sure to note
        that all removal operations described here only remove the relation between a user and a
        message conversation. In practical terms this means that we are not deleting the messages
        themselves (or any content for that matter) but are simply removing the message thread from
        the user such that it is not longer listed in the <span class="italic">/api/messageConversations</span> resource.</p><p>To remove a message conversation from a users inbox we need to issue a <span class="italic">DELETE</span> request to the resource identified by the id of the
        message conversation and the participating user. For example, to remove the user with id
          <span class="italic">xE7jOejl9FI</span> from the conversation with id <span class="italic">jMe43trzrdi</span>:</p><pre class="screen">curl https://play.dhis2.org/demo/api/messageConversations/jMe43</pre><p>If the request was successful the server will reply with a <span class="italic">200
          OK</span>. The response body contains an XML or JSON object (according to the accept
        header of the request) containing the id of the removed
        user.</p><pre class="screen">{ "removed" : ["xE7jOejl9FI"] }</pre><p>On failure the returned object will contain a message payload which describes the
        error.</p><pre class="screen">{ "message" : "No user with uid: dMV6G0tPAEa" }</pre><p>The observant reader will already have noticed that the object returned on success in
        our example is actually a list of ids (containing a single entry). This is due to the
        endpoint also supporting batch removals. The request is made to the same <span class="italic">messageConversations</span> resource but follows slightly different
        semantics. For batch operations the conversation ids are given as query string parameters.
        The following example removes two separate message conversations for the current
        user:</p><pre class="screen">curl "https://play.dhis2.org/demo/api/messageConversations?mc=WzMRrCosqc0&amp;mc=lxCjiigqrJm" 
-X DELETE -u admin:district -v</pre><p>If you have sufficient permissions, conversations can be removed on behalf of another
        user by giving an optional user id
        parameter.</p><pre class="screen">curl "https://play.dhis2.org/demo/api/messageConversations?mc=WzMRrCosqc0&amp;mc=lxCjiigqrJm&amp;user=PhzytPW3g2J" 
-X DELETE -u admin:district -v</pre><p>As indicated, batch removals will return the same message format as for single
        operations. The list of removed objects will reflect successful removals performed.
        Partially errorenous requests (i.e. non-existing id) will therefore not cancel the entire
        batch operation.</p><p>Messages carry a boolean <span class="italic">read</span> property. This allows
        tracking whether a user has seen (opened) a message or not. In a typical application
        scenario (e.g. the DHIS 2 web portal) a message will be marked read as soon as the user
        opens it for the first time. However, users might want to manage the read or unread status
        of their messages in order to keep track of certains conversations.</p><p>Marking messages read or unread follows similar semantics as batch removals, and also
        supports batch operations. To mark messages as read we issue a <span class="italic">POST</span> to the <span class="italic">messageConversations/read</span>
        resource with a request body containing one or more message ids. To mark messages as unread
        we issue an identical request to the <span class="italic">messageConversations/unread</span> resource. As is the case for removals, an optional
          <span class="italic">user</span> request parameter can be given.</p><p>Let's mark a couple of messages as read by the current
        user:</p><pre class="screen">curl "https://play.dhis2.org/dev/api/messageConversations/read" 
-d '["ZrKML5WiyFm","Gc03smoTm6q"]'  -X POST 
-H "Content-Type: application/json" -u admin:district -v</pre><p>The response is a <span class="italic">200 OK</span> with the following JSON
        body:</p><pre class="screen">{ "markedRead" : [ "ZrKML5WiyFm", "Gc03smoTm6q" ] }</pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e5986"></a>1.27.&nbsp;Interpretations</h2></div></div></div><p>For certain analysis-related resources in DHIS, like charts, maps and report tables, one
      can write and share a data interpretation. An interpretation is simply a link to the the
      relevant resource together with a text expressing some insight about the data. Interpretations
      access control follows the access given for the interpreted object.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e5991"></a>1.27.1.&nbsp;Reading interpretations</h3></div></div></div><p>To read interpretations we will interact with the <span class="italic">api/interpretations</span> resource. The output in JSON response format could look
        like below (use e.g. api/interpretations.json):</p><pre class="screen">{
    "interpretations": [{
        "created": "2013-10-07T11:37:19.273+0000",
        "lastUpdated": "2013-10-07T12:08:58.028+0000",
        "type": "map",
        "href": "https://play.dhis2.org/demo/api/interpretations/d3BukolfFZI",
        "id": "d3BukolfFZI"
    }, {
        "created": "2013-05-30T10:24:06.181+0000",
        "lastUpdated": "2013-05-30T10:25:08.066+0000",
        "type": "reportTable",
        "href": "https://play.dhis2.org/demo/api/interpretations/XSHiFlHAhhh",
        "id": "XSHiFlHAhhh"
    }, {
        "created": "2013-05-29T14:47:13.081+0000",
        "lastUpdated": "2013-05-29T14:47:13.081+0000",
        "type": "chart",
        "href": "https://play.dhis2.org/demo/api/interpretations/kr4AnZmYL43",
        "id": "kr4AnZmYL43"
    }]
}</pre><p>An interpretation contains properties for identifier, date of creation and date of last
        modification. The type property refers to the kind of object is being interpreted, and is
        useful to show an appropriate visual clue in a client. Valid options are "chart",
        "map", "reportTable" and "dataSetReport". By following the
        link given in the "href" property one can get more information about a specific
        interpretation. In the case of the map interpretation, the response will look like
        this:</p><pre class="screen">{
    "created": "2013-10-07T11:37:19.273+0000",
    "lastUpdated": "2014-10-07T12:08:58.028+0000",
    "map": {
        "name": "ANC: ANC 2 Coverage",
        "created": "2014-11-13T12:01:21.918+0000",
        "lastUpdated": "2014-11-13T12:01:21.918+0000",
        "href": "https://play.dhis2.org/demo/api/maps/bhmHJ4ZCdCd",
        "id": "bhmHJ4ZCdCd"
    },
    "text": "We can see that the ANC 2 coverage of Kasonko and Lei districts are under 40 %.",
    "comments": [{
        "created": "2014-10-07T12:08:58.026+0000",
        "lastUpdated": "2014-10-07T12:08:58.026+0000",
        "text": "Due to the rural environment, getting women to the facilities is a challenge.",
        "href": "https://play.dhis2.org/demo/api/null/iB4Etq8yTE6",
        "id": "iB4Etq8yTE6"
    }],
    "type": "map",
    "href": "https://play.dhis2.org/demo/api/interpretations/d3BukolfFZI",
    "id": "d3BukolfFZI"
}</pre><p>The map interpretation contains identifier and type information in the "id"
        and "type" properties. The interpretation text is available in the
        "text" property and references to any comments in the "comments" list.
        It also contains information about the interpreted object, in this case the "map"
        property. Note that you can follow the link to the actual map through the "href"
        property. For all analytical objects you can append <span class="italic">/data</span>
        to the URL to retrieve the data associated with the resource, as apposed to the metadata. As
        an example, by following the map link and appending /data one can retrieve a PNG (image)
        representation of the thematic map through the following URL:</p><pre class="screen">https://play.dhis2.org/demo/api/maps/bhmHJ4ZCdCd/data</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e6012"></a>1.27.2.&nbsp;Writing interpretations</h3></div></div></div><p>We will start by writing an interpretation for the chart with identifier <span class="italic">EbRN2VIbPdV</span>. To write chart interpretations we will interact with
        the <a class="link" href="http://play.dhis2.org/demo/api/interpretations/chart/{chartId}" target="_top">http://play.dhis2.org/demo/api/interpretations/chart/{chartId}</a> resource.
        The interpretation will be the request body. Based on this we can put together the following
        request using cURL:</p><pre class="screen">curl -d "This chart shows a significant ANC 1-3 dropout" 
"https://play.dhis2.org/demo/api/interpretations/chart/EbRN2VIbPdV" \
-H "Content-Type:text/plain" -u admin:district -v</pre><p>Second we will write a comment on the interpretation we just wrote. By looking at the
        interpretation response you will see that a <span class="italic">Location</span>
        header is returned. This header tells us the URL of the newly created interpretation and
        from that we can read its identifier. This identifier is randomly generated so you will have
        to replace the one in the command below with your own. To write a comment we can interact
        with the <a class="link" href="http://play.dhis2.org/demo/api/interpretations/{interpretationId}/comment" target="_top">http://play.dhis2.org/demo/api/interpretations/{interpretationId}/comment</a> like
        this:</p><pre class="screen">curl -d "An intervention is needed" 
"https://play.dhis2.org/demo/api/interpretations/j8sjHLkK8uY/comment"
-H "Content-Type:text/plain" -u admin:district -v</pre><p>You can also write interpretations for report tables in a similar way by interacting
        with the <a class="link" href="http://app.dhis2.org/demo/api/interpretations/reportTable/{reportTableId}" target="_top">http://app.dhis2.org/demo/api/interpretations/reportTable/{reportTableId}</a>. For
        report tables you can also provide an optional <span class="italic">ou</span> query
        parameter to supply an organisation unit identifier in the case where the report table has
        an organisation unit report parameter:</p><pre class="screen">curl -d "This table reveals poor data quality" 
"https://play.dhis2.org/demo/api/interpretations/reportTable/xIWpSo5jjT1?ou=O6uvpzGd5pu"
-H "Content-Type:text/plain" -u admin:district -v</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e6042"></a>1.27.3.&nbsp;Creating, updating and removing interpretation comments</h3></div></div></div><p> Creating comments to existing interpretations:
        </p><pre class="screen">POST "plain-text comment" to /api/interpretations/ID/comments</pre><p> Updating comments in existing interpretations:
        </p><pre class="screen">PUT "plain-text comment" to /api/interpretations/ID/comments/ID</pre><p> Removing comments in existing interpretations:
        </p><pre class="screen">DELETE /api/interpretations/ID/comments/ID</pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e6057"></a>1.28.&nbsp;Viewing analytical resource representations</h2></div></div></div><p>DHIS 2 has several resources for data analysis. These resources include <span class="italic">charts</span>, <span class="italic">maps</span>, <span class="italic">reportTables</span>, <span class="italic">reports</span> and
        <span class="italic">documents</span>. By visiting these resources you will retrieve
      information about the resource. For instance, by navigating to <span class="italic">api/charts/R0DVGvXDUNP</span> the response will contain the name, last date of
      modication and so on for the chart. To retrieve the analytical representation, for instance a
      PNG representation of the chart, you can append <span class="italic">/data</span> to
      all these resources. For instance, by visiting <span class="italic">api/charts/R0DVGvXDUNP/data</span> the system will return a PNG image of the
      chart.</p><div class="table"><a name="d6099e6086"></a><p class="title"><b>Table&nbsp;1.48.&nbsp;Analytical resources</b></p><div class="table-contents"><table class="table" summary="Analytical resources" border="1"><colgroup><col class="c1"><col class="c2"><col class="c3"><col class="newCol4"></colgroup><thead><tr><th>Resource</th><th>Description</th><th>Data URL</th><th>Resource representations</th></tr></thead><tbody><tr><td>charts</td><td>Charts</td><td>api/charts/&lt;identifier&gt;/data</td><td>png</td></tr><tr><td>eventCharts</td><td>Event charts</td><td>api/eventCharts/&lt;identifier&gt;/data</td><td>png</td></tr><tr><td>maps</td><td>Maps</td><td>api/maps/&lt;identifier&gt;/data</td><td>png</td></tr><tr><td>reportTables</td><td>Pivot tables</td><td>api/reportTables/&lt;identifier&gt;/data</td><td>json | jsonp | html | xml | pdf | xls | csv</td></tr><tr><td>reports</td><td>Standard reports</td><td>api/reports/&lt;identifier&gt;/data</td><td>pdf | xls | html</td></tr><tr><td>documents</td><td>Resources</td><td>api/documents/&lt;identifier&gt;/data</td><td>&lt;follows document&gt;</td></tr></tbody></table></div></div><br class="table-break"><p>The data content of the analytical representations can be modified by providing a
        <span class="italic">date</span> query parameter. This requires that the analytical
      resource is set up for relative periods for the period dimension.</p><div class="table"><a name="d6099e6164"></a><p class="title"><b>Table&nbsp;1.49.&nbsp;Data query parameters</b></p><div class="table-contents"><table class="table" summary="Data query parameters" border="1"><colgroup><col class="c1"><col class="c2"><col class="c3"></colgroup><thead><tr><th>Query parameter</th><th>Value</th><th>Description</th></tr></thead><tbody><tr><td>date</td><td>Date in yyyy-MM-dd format</td><td>Basis for relative periods in report (requires relative periods)</td></tr></tbody></table></div></div><br class="table-break"><div class="table"><a name="d6099e6187"></a><p class="title"><b>Table&nbsp;1.50.&nbsp;Query parameters for png / image types (charts, maps)</b></p><div class="table-contents"><table class="table" summary="Query parameters for png / image types (charts, maps)" border="1"><colgroup><col class="c1"><col class="c2"></colgroup><thead><tr><th>Query parameter</th><th>Description</th></tr></thead><tbody><tr><td>width</td><td>Width of image in pixels</td></tr><tr><td>height</td><td>Height of image in pixels</td></tr></tbody></table></div></div><br class="table-break"><p>Some examples of valid URLs for retrieving various analytical representations are listed
      below.</p><pre class="screen">api/charts/R0DVGvXDUNP/data
api/charts/R0DVGvXDUNP/data?date=2013-06-01

api/reportTables/jIISuEWxmoI/data.html
api/reportTables/jIISuEWxmoI/data.html?date=2013-01-01
api/reportTables/FPmvWs7bn2P/data.xls
api/reportTables/FPmvWs7bn2P/data.pdf

api/maps/DHE98Gsynpr/data
api/maps/DHE98Gsynpr/data?date=2013-07-01

api/reports/OeJsA6K1Otx/data.pdf
api/reports/OeJsA6K1Otx/data.pdf?date=2014-01-01</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e6214"></a>1.29.&nbsp;Plugins</h2></div></div></div><p>DHIS 2 comes with plugins which enables you to embed live data directly in your web portal
      or web site. Currently, plugins exist for charts, maps and pivot tables.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e6219"></a>1.29.1.&nbsp;Embedding pivot tables with the Pivot Table plug-in</h3></div></div></div><p>In this example we will see how we can embed good-looking, light-weight html pivot
        tables with data served from a DHIS back-end into a Web page. To accomplish this we will use
        the Pivot table plug-in. The plug-in is written in Javascript and depends on the Ext JS
        library only. A complete working example can be found at <a class="link" href="http://play.dhis2.org/portal/table.html" target="_top">http://play.dhis2.org/portal/table.html</a>. Open the page in a web browser and view
        the source to see how it is set up.</p><p>We start by having a look at what the complete html file could look like. This setup
        puts two tables in our web page. The first one is referring to an existing table. The second
        is configured inline.
        </p><pre class="screen">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
  &lt;link rel="stylesheet" type="text/css" href="http://dhis2-cdn.org/v215/ext/resources/css/ext-plugin-gray.css" /&gt;
  &lt;script src="https://dhis2-cdn.org/v215/ext/ext-all.js"&gt;&lt;/script&gt;
  &lt;script src="https://dhis2-cdn.org/v215/plugin/table.js"&gt;&lt;/script&gt;

  &lt;script&gt;
    var base = "https://play.dhis2.org/demo";

    // Login - if OK, call the setLinks function

    Ext.onReady( function() {
      Ext.Ajax.request({
        url: base + "dhis-web-commons-security/login.action",
        method: "POST",
        params: { j_username: "portal", j_password: "Portal123" },
        success: setLinks
      });
    });

    function setLinks() {

      // Referring to an existing table through the id parameter, render to "table1" div

      DHIS.getTable({ url: base, el: "table1", id: "R0DVGvXDUNP" });

      // Full table configuration, render to "table2" div

      DHIS.getTable({
        url: base,
        el: "table2",
        columns: [
          {dimension: "de", items: [{id: "YtbsuPPo010"}, {id: "l6byfWFUGaP"}]}
        ],
        rows: [
          {dimension: "pe", items: [{id: "LAST_12_MONTHS"}]}
        ],
        filters: [
          {dimension: "ou", items: [{id: "USER_ORGUNIT"}]}
        ],
        // All following options are optional
        showTotals: false,
        showSubTotals: false,
        hideEmptyRows: true,
        showHierarchy: true,
        displayDensity: "comfortable",
        fontSize: "large",
        digitGroupSeparator: "comma",
        legendSet: {id: "BtxOoQuLyg1"}
      });
    }
  &lt;/script&gt;
&lt;/head&gt;

&lt;body&gt;
  &lt;div id="table1"&gt;&lt;/div&gt;
  &lt;div id="table2"&gt;&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</pre><p>
      </p><p>Three files are included in the header section of the HTML document. The first two files
        are the Ext JS javascript library (we use the DHIS 2 content delivery network in this case)
        and its css stylesheet. The third file is the Pivot table plug-in. Make sure the path is
        pointing to your DHIS server installation.</p><pre class="screen">&lt;link rel="stylesheet" type="text/css" href="http://dhis2-cdn.org/v215/ext/resources/css/ext-plugin-gray.css" /&gt;
&lt;script src="http://dhis2-cdn.org/v215/ext/ext-all.js"&gt;&lt;/script&gt;
&lt;script src="http://dhis2-cdn.org/v215/plugin/table.js"&gt;&lt;/script&gt;</pre><p>To authenticate with the DHIS server we use the same approach as in the previous
        section. In the header of the HTML document we include the following Javascript inside a
        script element. The <span class="italic">setLinks</span> method will be implemented
        later. Make sure the <span class="italic">base</span> variable is pointing to your
        DHIS installation.</p><pre class="screen">var base = "https://play.dhis2.org/demo/";

Ext.onReady( function() {
  Ext.Ajax.request({
    url: base + "dhis-web-commons-security/login.action",
    method: "POST",
    params: { j_username: "portal", j_password: "Portal123" },
      success: setLinks
  });
});</pre><p>Now let us have a look at the various options for the Pivot table plug-in. Two properies
        are required: <span class="italic">el</span> and <span class="italic">url</span> (please refer to the table below). Now, if you want to refer to
        pre-defined tables already made inside DHIS it is sufficient to provide the additional
          <span class="italic">id</span> parameter. If you instead want to configure a pivot
        table dynamically you shoud omit the id parameter and provide data dimensions inside a
          <span class="italic">columns</span> array, a <span class="italic">rows</span> array and optionally a <span class="italic">filters</span> array
        instead.</p><p>A data dimension is defined as an object with a text property called <span class="italic">dimension</span>. This property accepts the following values: <span class="italic">in</span> (indicator), <span class="italic">de</span> (data
        element), <span class="italic">ds</span> (data set), <span class="italic">dc</span> (data element operand), <span class="italic">pe</span> (period),
          <span class="italic">ou</span> (organisation unit) or the id of any organisation
        unit group set or data element group set (can be found in the web api). The data dimension
        also has an array property called <span class="italic">items</span> which accepts
        objects with an <span class="italic">id</span> property.</p><p>To sum up, if you want to have e.g. "ANC 1 Coverage", "ANC 2
        Coverage" and "ANC 3 Coverage" on the columns in your table you can make the
        following <span class="italic">columns</span> config:</p><pre class="screen">columns: [{
  dimension: "in", // "in", "de", "ds", "dc", "pe", "ou" or any dimension id
  items: [
    {id: "Uvn6LCg7dVU"}, // the id of ANC 1 Coverage
    {id: "OdiHJayrsKo"}, // the id of ANC 2 Coverage
    {id: "sB79w2hiLp8"}  // the id of ANC 3 Coverage
  ]
}]</pre><div class="table"><a name="d6099e6301"></a><p class="title"><b>Table&nbsp;1.51.&nbsp;Pivot table plug-in configuration</b></p><div class="table-contents"><table class="table" summary="Pivot table plug-in configuration" border="1"><colgroup><col><col><col><col><col></colgroup><thead><tr><th> Param </th><th> Type </th><th> Required </th><th> Options (default first) </th><th> Description </th></tr></thead><tbody><tr><td>el</td><td>string</td><td>Yes</td><td>&nbsp;</td><td>Identifier of the HTML element to render the table in your web page</td></tr><tr><td>url</td><td>string</td><td>Yes</td><td>&nbsp;</td><td>Base URL of the DHIS server</td></tr><tr><td>id</td><td>string</td><td>No</td><td>&nbsp;</td><td>Identifier of a pre-defined table (favorite) in DHIS</td></tr><tr><td>columns</td><td>array</td><td>Yes (if no id provided)</td><td>&nbsp;</td><td>Data dimensions to include in table as columns</td></tr><tr><td>rows</td><td>array</td><td>Yes (if no id provided)</td><td>&nbsp;</td><td>Data dimensions to include in table as rows</td></tr><tr><td>filter</td><td>array</td><td>No</td><td>&nbsp;</td><td>Data dimensions to include in table as filters</td></tr><tr><td>showTotals</td><td>boolean</td><td>No</td><td>true | false</td><td>Whether to display totals for columns and rows</td></tr><tr><td>showSubTotals</td><td>boolean</td><td>No</td><td>true | false</td><td>Whether to display sub-totals for columns and rows</td></tr><tr><td>hideEmptyRows</td><td>boolean</td><td>No</td><td>false | true</td><td>Whether to hide rows with no data</td></tr><tr><td>showHierarchy</td><td>boolean</td><td>No</td><td>false | true</td><td>Whether to extend orgunit names with the name of all anchestors</td></tr><tr><td>displayDensity</td><td>string</td><td>No</td><td>"normal" | "comfortable" | "compact"</td><td>The amount of space inside table cells</td></tr><tr><td>fontSize</td><td>string</td><td>No</td><td>"normal" | "large" | "small"</td><td>Table font size</td></tr><tr><td>digitGroupSeparator</td><td>string</td><td>No</td><td>"space" | "comma" | "none"</td><td>How values are formatted: 1 000 | 1,000 | 1000</td></tr><tr><td>legendSet</td><td>object</td><td>No</td><td>&nbsp;</td><td>Show a color indicator next to the values (currently reusing legend sets from
                GIS)</td></tr><tr><td>userOrgUnit</td><td>string / array</td><td>No</td><td>&nbsp;</td><td>Organisation unit identifiers, overrides organisation units associated with
                curretn user, single or array</td></tr></tbody></table></div></div><br class="table-break"><p>We continue by adding one pre-defined and one dynamic pivot table to our HTML document.
        You can browse the list of available pivot tables using the Web API here: <a class="link" href="http://play.dhis2.org/demo/api/reportTables" target="_top">http://play.dhis2.org/demo/api/reportTables</a>.</p><pre class="screen">function setLinks() {
  DHIS.getTable({ url: base, el: "table1", id: "R0DVGvXDUNP" });

  DHIS.getTable({
 url: base,
 el: "table2",
 columns: [
   {dimension: "de", items: [{id: "YtbsuPPo010"}, {id: "l6byfWFUGaP"}]}
 ],
 rows: [
   {dimension: "pe", items: [{id: "LAST_12_MONTHS"}]}
 ],
 filters: [
   {dimension: "ou", items: [{id: "USER_ORGUNIT"}]}
 ],
 // All following options are optional
 showTotals: false,
 showSubTotals: false,
 hideEmptyRows: true,
 showHierarchy: true,
 displayDensity: "comfortable",
 fontSize: "large",
 digitGroupSeparator: "comma",
 legendSet: {id: "BtxOoQuLyg1"}
  });
}</pre><p>Finally we include some <span class="italic">div</span> elements in the body
        section of the HTML document with the identifiers referred to in the plug-in
        Javascript.</p><pre class="screen">&lt;div id="table1"&gt;&lt;/div&gt;
&lt;div id="table2"&gt;&lt;/div&gt;</pre><p>To see a complete working example please visit <a class="link" href="http://play.dhis2.org/portal/table.html" target="_top">http://play.dhis2.org/portal/table.html</a>.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e6492"></a>1.29.2.&nbsp;Embedding charts with the Visualizer chart plug-in</h3></div></div></div><p>In this example we will see how we can embed good-looking Ext JS charts (<a class="link" href="http://www.sencha.com/products/extjs" target="_top">http://www.sencha.com/products/extjs</a>) with data served from a DHIS back-end into a
        Web page. To accomplish this we will use the DHIS Visualizer plug-in. The plug-in is written
        in Javascript and depends on the Ext JS library only. A complete working example can be
        found at <a class="link" href="http://play.dhis2.org/portal/chart.html" target="_top">http://play.dhis2.org/portal/chart.html</a>. Open the page in a web
        browser and view the source to see how it is set up.</p><p>We start by having a look at what the complete html file could look like. This setup
        puts two charts in our web page. The first one is referring to an existing chart. The second
        is configured inline.
        </p><pre class="screen">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
  &lt;link rel="stylesheet" type="text/css" href="http://dhis2-cdn.org/v215/ext/resources/css/ext-plugin-gray.css" /&gt;
  &lt;script src="http://dhis2-cdn.org/v215/ext/ext-all.js"&gt;&lt;/script&gt;
  &lt;script src="http://dhis2-cdn.org/v215/plugin/chart.js"&gt;&lt;/script&gt;

  &lt;script&gt;
    var base = "https://play.dhis2.org/demo";

    // Login - if OK, call the setLinks function

    Ext.onReady( function() {
      Ext.Ajax.request({
        url: base + "dhis-web-commons-security/login.action",
        method: "POST",
        params: { j_username: "portal", j_password: "Portal123" },
        success: setLinks
      });
    });

    function setLinks() {

      // Referring to an existing chart through the id parameter, render to "chart1" div

      DHIS.getChart({ url: base, el: "chart1", id: "R0DVGvXDUNP" });

      // Full chart configuration, render to "chart2" div

      DHIS.getChart({
        url: base,
        el: "chart2",
        type: "stackedBar",
        columns: [ // Chart series
          {dimension: "de", items: [{id: "YtbsuPPo010"}, {id: "l6byfWFUGaP"}]}
        ],
        rows: [ // Chart categories
          {dimension: "pe", items: [{id: "LAST_12_MONTHS"}]}
        ],
        filters: [
          {dimension: "ou", items: [{id: "USER_ORGUNIT"}]}
        ],
        // All following options are optional
        showData: false,
        targetLineValue: 70,
        baseLineValue: 20,
        showTrendLine: true,
        hideLegend: true,
        title: "My chart title",
        domainAxisTitle: "Periods",
        rangeAxisTitle: "Percent"
      });
    }
  &lt;/script&gt;
&lt;/head&gt;

&lt;body&gt;
  &lt;div id="chart1"&gt;&lt;/div&gt;
  &lt;div id="chart2"&gt;&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</pre><p>
      </p><p>Three files are included in the header section of the HTML document. The first two files
        are the Ext JS javascript library (we use the DHIS 2 content delivery network in this case)
        and its stylesheet. The third file is the Visualizer plug-in. Make sure the path is pointing
        to your DHIS server installation.</p><pre class="screen">&lt;link rel="stylesheet" type="text/css" href="http://dhis2-cdn.org/v215/ext/resources/css/ext-plugin-gray.css" /&gt;
&lt;script src="http://dhis2-cdn.org/v215/ext/ext-all.js"&gt;&lt;/script&gt;
&lt;script src="http://dhis2-cdn.org/v215/plugin/chart.js"&gt;&lt;/script&gt;</pre><p>To authenticate with the DHIS server we use the same approach as in the previous
        section. In the header of the HTML document we include the following Javascript inside a
        script element. The <span class="italic">setLinks</span> method will be implemented
        later. Make sure the <span class="italic">base</span> variable is pointing to your
        DHIS installation.</p><pre class="screen">var base = "https://play.dhis2.org/demo/";

Ext.onReady( function() {
  Ext.Ajax.request({
    url: base + "dhis-web-commons-security/login.action",
    method: "POST",
    params: { j_username: "portal", j_password: "Portal123" },
    success: setLinks
  });
});</pre><p>Now let us have a look at the various options for the Visualizer plug-in. Two properies
        are required: <span class="italic">el</span> and <span class="italic">url</span> (please refer to the table below). Now, if you want to refer to
        pre-defined charts already made inside DHIS it is sufficient to provide the additional
          <span class="italic">id</span> parameter. If you instead want to configure a chart
        dynamically you shoud omit the id parameter and provide data dimensions inside a <span class="italic">columns</span> array (chart series), a <span class="italic">rows</span> array (chart categories) and optionally a <span class="italic">filters</span> array instead.</p><p>A data dimension is defined as an object with a text property called <span class="italic">dimension</span>. This property accepts the following values: <span class="italic">in</span> (indicator), <span class="italic">de</span> (data
        element), <span class="italic">ds</span> (data set), <span class="italic">dc</span> (data element operand), <span class="italic">pe</span> (period),
          <span class="italic">ou</span> (organisation unit) or the id of any organisation
        unit group set or data element group set (can be found in the web api). The data dimension
        also has an array property called <span class="italic">items</span> which accepts
        objects with an <span class="italic">id</span> property.</p><p>To sum up, if you want to have e.g. "ANC 1 Coverage", "ANC 2
        Coverage" and "ANC 3 Coverage" as series in your chart you can make the
        following <span class="italic">columns</span> config:</p><pre class="screen">columns: [{
  dimension: "in", // could be "in", "de", "ds", "dc", "pe", "ou" or any dimension id
  items: [
    {id: "Uvn6LCg7dVU"}, // the id of ANC 1 Coverage
    {id: "OdiHJayrsKo"}, // the id of ANC 2 Coverage
    {id: "sB79w2hiLp8"}  // the id of ANC 3 Coverage
  ]
}]</pre><div class="table"><a name="d6099e6576"></a><p class="title"><b>Table&nbsp;1.52.&nbsp;Visualizer chart plug-in configuration</b></p><div class="table-contents"><table class="table" summary="Visualizer chart plug-in configuration" border="1"><colgroup><col><col><col><col><col></colgroup><thead><tr><th> Param </th><th> Type </th><th> Required </th><th> Options (default first) </th><th> Description </th></tr></thead><tbody><tr><td>el</td><td>string</td><td>Yes</td><td>&nbsp;</td><td>Identifier of the HTML element to render the chart in your web page</td></tr><tr><td>url</td><td>string</td><td>Yes</td><td>&nbsp;</td><td>Base URL of the DHIS server</td></tr><tr><td>id</td><td>string</td><td>No</td><td>&nbsp;</td><td>Identifier of a pre-defined chart (favorite) in DHIS</td></tr><tr><td>type</td><td>string</td><td>No</td><td>column | stackedcolumn | bar | stackedbar | line | area | pie</td><td>Chart type</td></tr><tr><td>columns</td><td>array</td><td>Yes (if no id provided)</td><td>&nbsp;</td><td>Data dimensions to include in chart as series</td></tr><tr><td>rows</td><td>array</td><td>Yes (if no id provided)</td><td>&nbsp;</td><td>Data dimensions to include in chart as category</td></tr><tr><td>filter</td><td>array</td><td>No</td><td>&nbsp;</td><td>Data dimensions to include in chart as filters</td></tr><tr><td>showData</td><td>boolean</td><td>No</td><td>false | true</td><td>Whether to display data on the chart</td></tr><tr><td>showTrendLine</td><td>boolean</td><td>No</td><td>false | true</td><td>Whether to display trend line(s) on the chart</td></tr><tr><td>hideLegend</td><td>boolean</td><td>No</td><td>false | true</td><td>Whether to hide the chart legend</td></tr><tr><td>hideTitle</td><td>boolean</td><td>No</td><td>false | true</td><td>Whether to hide the chart title</td></tr><tr><td>targetLineValue</td><td>double</td><td>No</td><td>&nbsp;</td><td>Value of target line to display on the chart</td></tr><tr><td>targetLineLabel</td><td>string</td><td>No</td><td>&nbsp;</td><td>Label for target line</td></tr><tr><td>baseLineValue</td><td>double</td><td>No</td><td>&nbsp;</td><td>Value of baseline to display on the chart</td></tr><tr><td>baseLineLabel</td><td>string</td><td>No</td><td>&nbsp;</td><td>Label for baseline</td></tr><tr><td>domainAxisTitle</td><td>string</td><td>No</td><td>&nbsp;</td><td>Title for the domain axis</td></tr><tr><td>rangeAxisTitle</td><td>string</td><td>No</td><td>&nbsp;</td><td>Title for the range axis</td></tr><tr><td>width</td><td>integer</td><td>No</td><td>&nbsp;</td><td>Width of chart</td></tr><tr><td>height</td><td>integer</td><td>No</td><td>&nbsp;</td><td>Height of chart</td></tr><tr><td>userOrgUnit</td><td>string / array</td><td>No</td><td>&nbsp;</td><td>Organisation unit identifiers, overrides organisation units associated with
                curretn user, single or array</td></tr></tbody></table></div></div><br class="table-break"><p>We continue by including two pre-defined charts and to dynamic charts to our HTML
        document. You can browse the list of available charts using the Web API here: <a class="link" href="http://play.dhis2.org/demo/api/charts" target="_top">http://play.dhis2.org/demo/api/charts</a>.</p><pre class="screen">function setLinks() {
  DHIS.getChart({ url: base, el: "chart1", id: "R0DVGvXDUNP" });

  DHIS.getChart({
 url: base,
 el: "chart2",
 type: "stackedBar",
 columns: [ // Chart series
   {dimension: "de", items: [{id: "YtbsuPPo010"}, {id: "l6byfWFUGaP"}]}
 ],
 rows: [ // Chart categories
   {dimension: "pe", items: [{id: "LAST_12_MONTHS"}]}
 ],
 filters: [
   {dimension: "ou", items: [{id: "USER_ORGUNIT"}]}
 ],
 // All following options are optional
 showData: false,
 targetLineValue: 70,
 baseLineValue: 20,
 showTrendLine: true,
 hideLegend: true,
 title: "My chart title",
 domainAxisTitle: "Periods",
 rangeAxisTitle: "Percent"
  });
}</pre><p>Finally we include some <span class="italic">div</span> elements in the body
        section of the HTML document with the identifiers referred to in the plug-in
        Javascript.</p><pre class="screen">&lt;div id="chart1"&gt;&lt;/div&gt;
&lt;div id="chart2"&gt;&lt;/div&gt;
</pre><p>To see a complete working example please visit <a class="link" href="http://play.dhis2.org/portal/chart.html" target="_top">http://play.dhis2.org/portal/chart.html</a>.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e6815"></a>1.29.3.&nbsp;Embedding maps with the GIS map plug-in</h3></div></div></div><p>In this example we will see how we can embed maps with data served from a DHIS back-end
        into a Web page. To accomplish this we will use the GIS map plug-in. The plug-in is written
        in Javascript and depends on the Ext JS library only. A complete working example can be
        found at <a class="link" href="http://play.dhis2.org/portal/map.html" target="_top">http://play.dhis2.org/portal/map.html</a>. Open the page in a web
        browser and view the source to see how it is set up.</p><p>We start by having a look at what the complete html file could look like. This setup
        puts two maps in our web page. The first one is referring to an existing map. The second is
        configured inline.
        </p><pre class="screen">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
  &lt;link rel="stylesheet" type="text/css" href="http://dhis2-cdn.org/v215/ext/resources/css/ext-plugin-gray.css" /&gt;
  &lt;script src="http://dhis2-cdn.org/v215/ext/ext-all.js"&gt;&lt;/script&gt;
  &lt;script src="https://maps.google.com/maps/api/js?sensor=false"&gt;&lt;/script&gt;
  &lt;script src="http://dhis2-cdn.org/v215/openlayers/OpenLayers.js"&gt;&lt;/script&gt;
  &lt;script src="http://dhis2-cdn.org/v215/plugin/map.js"&gt;&lt;/script&gt;

  &lt;script&gt;
    var base = "https://play.dhis2.org/demo";

    // Login - if OK, call the setLinks function

    Ext.onReady( function() {
      Ext.Ajax.request({
        url: base + "dhis-web-commons-security/login.action",
        method: "POST",
        params: { j_username: "portal", j_password: "Portal123" },
        success: setLinks
      });
    });

    function setLinks() {
      DHIS.getMap({ url: base, el: "map1", id: "ytkZY3ChM6J" });

      DHIS.getMap({
        url: base,
        el: "map2",
        mapViews: [{
          columns: [{dimension: "in", items: [{id: "Uvn6LCg7dVU"}]}], // data
          rows: [{dimension: "ou", items: [{id: "LEVEL-3"}, {id: "ImspTQPwCqd"}]}], // organisation units,
          filters: [{dimension: "pe", items: [{id: "LAST_3_MONTHS"}]}], // period
          // All following options are optional
          classes: 7,
          colorLow: "02079c",
          colorHigh: "e5ecff",
          opacity: 0.9,
          legendSet: {id: "fqs276KXCXi"}
        }]
      });
    }
  &lt;/script&gt;
&lt;/head&gt;

&lt;body&gt;
  &lt;div id="map1"&gt;&lt;/div&gt;
  &lt;div id="map2"&gt;&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</pre><p>Four files and Google Maps are included in the header section of the HTML document. The
        first two files are the Ext JS javascript library (we use the DHIS 2 content delivery
        network in this case) and its stylesheet. The third file is the OpenLayers javascript
        mapping framework (<a class="link" href="http://openlayers.org" target="_top">http://openlayers.org</a>) and finally we include the GIS map
        plug-in. Make sure the path is pointing to your DHIS server installation.</p><pre class="screen">&lt;link rel="stylesheet" type="text/css" href="http://dhis2-cdn.org/v215/ext/resources/css/ext-plugin-gray.css" /&gt;
&lt;script src="http://dhis2-cdn.org/v215/ext/ext-all.js"&gt;&lt;/script&gt;
&lt;script src="https://maps.google.com/maps/api/js?sensor=false"&gt;&lt;/script&gt;
&lt;script src="http://dhis2-cdn.org/v215/openlayers/OpenLayers.js"&gt;&lt;/script&gt;
&lt;script src="http://dhis2-cdn.org/v215/plugin/map.js"&gt;&lt;/script&gt;</pre><p>To authenticate with the DHIS server we use the same approach as in the previous
        section. In the header of the HTML document we include the following Javascript inside a
        script element. The <span class="italic">setLinks</span> method will be implemented
        later. Make sure the <span class="italic">base</span> variable is pointing to your
        DHIS installation.</p><pre class="screen">Ext.onReady( function() {
  Ext.Ajax.request({
    url: base + "dhis-web-commons-security/login.action",
    method: "POST",
    params: { j_username: "portal", j_password: "Portal123" },
    success: setLinks
  });
});</pre><p>Now let us have a look at the various options for the GIS plug-in. Two properies are
        required: <span class="italic">el</span> and <span class="italic">url</span>
        (please refer to the table below). Now, if you want to refer to pre-defined maps already
        made in the DHIS 2 GIS it is sufficient to provide the additional <span class="italic">id</span> parameter. If you instead want to configure a map dynamically you shoud
        omit the id parameter and provide <span class="italic">mapViews</span> (layers)
        instead. They should be configured with data dimensions inside a <span class="italic">columns</span> array, a <span class="italic">rows</span> array and optionally
        a <span class="italic">filters</span> array instead.</p><p>A data dimension is defined as an object with a text property called <span class="italic">dimension</span>. This property accepts the following values: <span class="italic">in</span> (indicator), <span class="italic">de</span> (data
        element), <span class="italic">ds</span> (data set), <span class="italic">dc</span> (data element operand), <span class="italic">pe</span> (period),
          <span class="italic">ou</span> (organisation unit) or the id of any organisation
        unit group set or data element group set (can be found in the web api). The data dimension
        also has an array property called <span class="italic">items</span> which accepts
        objects with an <span class="italic">id</span> property.</p><p>To sum up, if you want to have a layer with e.g. "ANC 1 Coverage" in your map
        you can make the following <span class="italic">columns</span> config:</p><pre class="screen">columns: [{
  dimension: "in", // could be "in", "de", "ds", "dc", "pe", "ou" or any dimension id
  items: [{id: "Uvn6LCg7dVU"}], // the id of ANC 1 Coverage
}]</pre><div class="table"><a name="d6099e6901"></a><p class="title"><b>Table&nbsp;1.53.&nbsp;GIS map plug-in configuration</b></p><div class="table-contents"><table class="table" summary="GIS map plug-in configuration" border="1"><colgroup><col><col><col><col><col></colgroup><thead><tr><th> Param </th><th> Type </th><th> Required </th><th> Options (default first) </th><th> Description </th></tr></thead><tbody><tr><td>el</td><td>string</td><td>Yes</td><td>&nbsp;</td><td>Identifier of the HTML element to render the map in your web page</td></tr><tr><td>url</td><td>string</td><td>Yes</td><td>&nbsp;</td><td>Base URL of the DHIS server</td></tr><tr><td>id</td><td>string</td><td>No</td><td>&nbsp;</td><td>Identifier of a pre-defined map (favorite) in DHIS</td></tr><tr><td>baseLayer</td><td>string/boolean</td><td>No</td><td>'gs', 'googlestreets' | 'gh',
                'googlehybrid' | 'osm', 'openstreetmap' | false, null,
                'none', 'off'</td><td>Show background map</td></tr><tr><td>hideLegend</td><td>boolean</td><td>No</td><td>false | true</td><td>Hide legend panel</td></tr><tr><td>mapViews</td><td>array</td><td>Yes (if no id provided)</td><td>&nbsp;</td><td>Array of layers</td></tr></tbody></table></div></div><br class="table-break"><p>If no id is provided you must add map view objects with the following config
        options:</p><div class="table"><a name="d6099e6982"></a><p class="title"><b>Table&nbsp;1.54.&nbsp;Map plug-in configuration</b></p><div class="table-contents"><table class="table" summary="Map plug-in configuration" border="1"><colgroup><col><col><col><col><col></colgroup><tbody><tr><td>layer</td><td>string</td><td>No</td><td>"thematic1" | "thematic2" | "thematic3" |
                "thematic4" | "boundary" | "facility" | </td><td>The layer to which the map view content should be added</td></tr><tr><td>columns</td><td>array</td><td>Yes</td><td>&nbsp;</td><td>Indicator, data element, data operand or data set (only one will be
                used)</td></tr><tr><td>rows</td><td>array</td><td>Yes</td><td>&nbsp;</td><td>Organisation units (multiple allowed)</td></tr><tr><td>filter</td><td>array</td><td>Yes</td><td>&nbsp;</td><td>Period (only one will be used)</td></tr><tr><td>classes</td><td>integer</td><td>No</td><td>5 | 1-7</td><td>The number of automatic legend classes</td></tr><tr><td>method</td><td>integer</td><td>No</td><td>2 | 3</td><td>Legend calculation method where 2 = equal intervals and 3 = equal
                counts</td></tr><tr><td>colorLow</td><td>string</td><td>No</td><td>"ff0000" (red) | Any hex color</td><td>The color representing the first automatic legend class</td></tr><tr><td>colorHigh</td><td>string</td><td>No</td><td>"00ff00" (green) | Any hex color</td><td>The color representing the last automatic legend class</td></tr><tr><td>radiusLow</td><td>integer</td><td>No</td><td>5 | Any integer</td><td>Only applies for facilities (points) - radius of the point with lowest
                value</td></tr><tr><td>radiusHigh</td><td>integer</td><td>No</td><td>15 | Any integer</td><td>Only applies for facilities (points) - radius of the point with highest
                value</td></tr><tr><td>opacity</td><td>double</td><td>No</td><td>0.8 | 0 - 1</td><td>Opacity/transparency of the layer content</td></tr><tr><td>legendSet</td><td>object</td><td>No</td><td>&nbsp;</td><td>Pre-defined legend set. Will override the automatic legend set.</td></tr><tr><td>labels</td><td>boolean/object</td><td>No</td><td>false | true | object properties: fontSize (integer), color (hex string),
                strong (boolean), italic (boolean)</td><td>Show labels on the map</td></tr><tr><td>width</td><td>integer</td><td>No</td><td>&nbsp;</td><td>Width of map</td></tr><tr><td>height</td><td>integer</td><td>No</td><td>&nbsp;</td><td>Height of map</td></tr><tr><td>userOrgUnit</td><td>string / array</td><td>No</td><td>&nbsp;</td><td>Organisation unit identifiers, overrides organisation units associated with
                curretn user, single or array</td></tr></tbody></table></div></div><br class="table-break"><p>We continue by adding one pre-defined and one dynamically configured map to our HTML
        document. You can browse the list of available maps using the Web API here: <a class="link" href="http://play.dhis2.org/demo/api/maps" target="_top">http://play.dhis2.org/demo/api/maps</a>.</p><pre class="screen">function setLinks() {
  DHIS.getMap({ url: base, el: "map1", id: "ytkZY3ChM6J" });

  DHIS.getMap({
 url: base,
 el: "map2",
 mapViews: [
   columns: [ // Chart series
  columns: [{dimension: "in", items: [{id: "Uvn6LCg7dVU"}]}], // data
   ],
   rows: [ // Chart categories
  rows: [{dimension: "ou", items: [{id: "LEVEL-3"}, {id: "ImspTQPwCqd"}]}], // organisation units
   ],
   filters: [
  filters: [{dimension: "pe", items: [{id: "LAST_3_MONTHS"}]}], // period
   ],
   // All following options are optional
   classes: 7,
   colorLow: "02079c",
   colorHigh: "e5ecff",
   opacity: 0.9,
   legendSet: {id: "fqs276KXCXi"}
 ]
  });
}</pre><p>Finally we include some <span class="italic">div</span> elements in the body
        section of the HTML document with the identifiers referred to in the plug-in
        Javascript.</p><pre class="screen">&lt;div id="map1"&gt;&lt;/div&gt;
&lt;div id="map2"&gt;&lt;/div&gt;
</pre><p>To see a complete working example please visit <a class="link" href="http://play.dhis2.org/portal/map.html" target="_top">http://play.dhis2.org/portal/map.html</a>.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e7173"></a>1.29.4.&nbsp;Creating a chart carousel with the carousel plug-in</h3></div></div></div><p>The chart plug-in also makes it possible to create a chart carousel which for instance
        can be used to create an attractive front page on a Web portal. To use the carousel we need
        to import a few files in the head section of our HTML page:</p><pre class="screen">
&lt;link rel="stylesheet" type="text/css" href="http://dhis2-cdn.org/v213/ext/resources/css/ext-plugin-gray.css" /&gt;
&lt;link rel="stylesheet" type="text/css" href="https://play.dhis2.org/demo/dhis-web-commons/javascripts/ext-ux/carousel/css/carousel.css" /&gt;
&lt;script type="text/javascript" src="https://extjs-public.googlecode.com/svn/tags/extjs-4.0.7/release/ext-all.js"&gt;&lt;/script&gt;
&lt;script type="text/javascript" src="https://play.dhis2.org/demo/dhis-web-commons/javascripts/ext-ux/carousel/Carousel.js"&gt;&lt;/script&gt;
&lt;script type="text/javascript" src="https://play.dhis2.org/demo/dhis-web-commons/javascripts/plugin/plugin.js"&gt;&lt;/script&gt;</pre><p>The first file is the CSS stylesheet for the chart plug-in. The second file is the CSS
        stylesheet for the carousel widget. The third file is the Ext JavaScript framework which
        this plug-in depends on. The fourth file is the carousel plug-in JavaScript file. The fifth
        file is the chart plug-in JavaScript file. The paths in this example points at the DHIS 2
        demo site, make sure you update them to point to your own DHIS 2 installation.</p><p>Please refer to the section about the chart plug-in on how to do authentication.</p><p>To create a chart carousel we will first render the charts we want to include in the
        carousel using the method described in the chart plug-in section. Then we create the chart
        carousel itself. The charts will be rendered into <span class="italic">div</span>
        elements which all have a CSS class called <span class="italic">chart</span>. In the
        carousel configuration we can then define a <span class="italic">selector</span>
        expression which refers to those div elements like this:</p><pre class="screen">DHIS.getChart({ uid: 'R0DVGvXDUNP', el: 'chartA1', url: base });
DHIS.getChart({ uid: 'X0CPnV6uLjR', el: 'chartA2', url: base });
DHIS.getChart({ uid: 'j1gNXBgwKVm', el: 'chartA3', url: base });
DHIS.getChart({ uid: 'X7PqaXfevnL', el: 'chartA4', url: base });

new Ext.ux.carousel.Carousel( 'chartCarousel', {
  autoPlay: true,
  itemSelector: 'div.chart',
  interval: 5,
  showPlayButton: true
});</pre><p>The first argument in the configuration is the id of the div element in which you want
        to render the carousel. The <span class="italic">autoPlay</span> configuration option
        refers to whether we want the carousel to start when the user loads the Web page. The
          <span class="italic">interval</span> option defines how many seconds each chart
        should be displayed. The <span class="italic">showPlayButton</span> defines whether
        we want to render a button for the user to start and stop the carousel. Finally we need to
        insert the div elements in the body of the HTML document:</p><pre class="screen">&lt;div id="chartCarousel"&gt;

&lt;div id="chartA1"&gt;&lt;/div&gt;
&lt;div id="chartA2"&gt;&lt;/div&gt;
&lt;div id="chartA3"&gt;&lt;/div&gt;
&lt;div id="chartA4"&gt;&lt;/div&gt;</pre><p>To see a complete working example please visit <a class="link" href="http://play.dhis2.org/portal/carousel.html" target="_top">http://play.dhis2.org/portal/carousel.html</a>.</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e7214"></a>1.30.&nbsp;SQL views</h2></div></div></div><p>The SQL views resource allows you to create and retrieve the result set of SQL views. The
      SQL views can be executed directly against the database and render the result set through the
      Web API resource.</p><pre class="screen">/api/sqlViews</pre><p>SQL views are useful for creating data views which may be more easily constructed with SQL
      compared combining the multiple objects of the Web API. As an example, lets assume we have
      been asked to provide a view of all organization units with their names, parent names,
      organization unit level and name, and the coordinates listed in the database. The view might
      look something like this: </p><pre class="screen">SELECT ou.name as orgunit, par.name as parent, ou.coordinates, ous.level, oul.name from organisationunit ou
INNER JOIN _orgunitstructure ous ON ou.organisationunitid = ous.organisationunitid
INNER JOIN organisationunit par ON ou.parentid = par.organisationunitid
INNER JOIN orgunitlevel oul ON ous.level = oul.level
WHERE ou.coordinates is not null
ORDER BY oul.level, par.name, ou.name</pre><p>We will use <span class="italic">curl</span> to first execute the view on the DHIS
      2 server. This is essentially a materialization process, and ensures that we have the most
      recent data available through the SQL view when it is retrieved from the server. You can first
      look up the SQL view from the api/sqlViews resource, then POST using the following
      command:</p><pre class="screen">curl "https://play.dhis2.org/demo/api/sqlViews/dI68mLkP1wN/execute" -X POST -u admin:district -v</pre><p>The next step in the process is the retrieval of the data.The basic structure of the URL
      is as follows</p><pre class="screen">http://{server}/api/sqlViews/{id}/data(.csv)</pre><p>The <em class="parameter"><code>{server}</code></em> parameter should be replaced with your own server. The
      next part of the URL <em class="parameter"><code>/api/sqlViews/</code></em> should be appended with the
      specific SQL view identifier. Append either <em class="parameter"><code>data</code></em> for XML data or
        <em class="parameter"><code>data.csv</code></em> for comma delimited values. Support response formats are
      json, xml, csv, xls, html and html+css. As an example, the following command would retrieve
      XML data for the SQL view defined
      above.</p><pre class="screen">curl "https://play.dhis2.org/demo/api/sqlViews/dI68mLkP1wN/data.csv" -u admin:district -v</pre><p>There are three types of SQL views:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><span class="italic">SQL view:</span> Standard SQL views.</p></li><li class="listitem"><p><span class="italic">Materialized SQL view:</span> SQL views which are
            materialized, meaning written to disk. Needs to be updated to reflect changes in
            underlying tables. Supports criteria to filter result set.</p></li><li class="listitem"><p><span class="italic">SQL queries:</span> Plain SQL queries. Support inline
            variables for customized queries.</p></li></ul></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e7270"></a>1.30.1.&nbsp;Criteria</h3></div></div></div><p>You can do simple filtering on the columns in the result set by appending <span class="italic">criteria</span> query parameters to the URL, using the column names and
        filter values separated by columns as parameter values, on the following format:</p><pre class="screen">/api/sqlViews/{id}/data?criteria=col1:value1&amp;criteria=col2:value2</pre><p>As an example, to filter the SQL view result set above to only return organisation units
        at level 4 you can use the following URL:</p><pre class="screen">https://play.dhis2.org/demo/api/sqlViews/dI68mLkP1wN/data.csv?criteria=level:4</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e7284"></a>1.30.2.&nbsp;Variables</h3></div></div></div><p>SQL views support variable subsitution. Variable subsitition is only available for SQL
        view of type <span class="italic">query</span>, meaning SQL views which are not
        created in the database but simply executed as regular SQL queries. Variables can be
        inserted directly into the SQL query and must be on this
        format:</p><pre class="screen">${variable-key}</pre><p>As an example, an SQL query that retrieves all data elements of a given value type where
        the value type is defined through a variable can look like
        this:</p><pre class="screen">select * from dataelement where valuetype = '${valueType}';</pre><p>These variables can then be supplied as part of the URL when requested through the
          <span class="italic">sqlViews</span> Web API resource. Variables can be supplied on
        the following
        format:</p><pre class="screen">/api/sqlViews/{id}/data?var=key1:value1&amp;var=key2:value2</pre><p>An example query corresponding to the example above can look like
        this:</p><pre class="screen">/api/sqlViews/dI68mLkP1wN/data.json?var=valueType:int</pre><p>The <span class="italic">valueType</span> variable will be subsituted with the
          <span class="italic">int</span> value, and the query will return data elements with
        int value type.</p><p>The variable parameter must contain alphanumeric characters only. The variables must
        contain alphanumeric, dash, underscore and whitespace characters only.</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e7319"></a>1.31.&nbsp;Dashboard</h2></div></div></div><p>The dashboard is designed to give you an overview of multiple analytical items like maps,
      charts, pivot tables and reports which together can provide a comprehensive overview of your
      data. Dashboards are available in the Web API through the <span class="italic">dashboards</span> resource. A dashboard contains a list of dashboard <span class="italic">items</span>. An item can represent a single resource, like a chart, map
      or report table, or represent a list of links to analytical resources, like reports,
      resources, tabular reports and users. A dashboard item can contain up to eight links.
      Typically, a dashboard client could choose to visualize the single-object items directly in a
      user interface, while rendering the multi-object items as clickable links. </p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e7330"></a>1.31.1.&nbsp;Browsing dashboards</h3></div></div></div><p>To get a list of your dashboards with basic information including identifier, name and
        link in JSON format you can make a <span class="italic">GET</span> request to the
        following URL:</p><pre class="screen">/api/dashboards.json</pre><p>The dashboards resource will provide a list of dashboards. Remember that the dashboard
        object is shared so the list will be affected by the currently authenticated user. You can
        retrieve more information about a specific dashboard by following its link, similar to
        this:</p><pre class="screen">/api/dashboards/vQFhmLJU5sK.json</pre><p>A dashboard contains information like name and creation date and an array of dashboard
        items. The response in JSON format will look similar to this response (certain information
        has been removed for the sake of
        brevity).</p><pre class="screen">{
"lastUpdated" : "2013-10-15T18:17:34.084+0000",
"id" : "vQFhmLJU5sK",
"created" : "2013-09-08T20:55:58.060+0000",
"name" : "Mother and Child Health",
"href" : "https://play.dhis2.org/demo/api/dashboards/vQFhmLJU5sK",
"publicAccess" : "--------",
"externalAccess" : false,
"itemCount" : 17,
"displayName" : "Mother and Child Health",
"access" : {
"update" : true,
"externalize" : true,
"delete" : true,
"write" : true,
"read" : true,
"manage" : true
},
"user" : {
"id" : "xE7jOejl9FI",
"name" : "John Traore",
"created" : "2013-04-18T15:15:08.407+0000",
"lastUpdated" : "2014-12-05T03:50:04.148+0000",
"href" : "https://play.dhis2.org/demo/api/users/xE7jOejl9FI"
},
"dashboardItems" : [{
"id" : "bu1IAnPFa9H",
"created" : "2013-09-09T12:12:58.095+0000",
"lastUpdated" : "2013-09-09T12:12:58.095+0000"
}, {
"id" : "ppFEJmWWDa1",
"created" : "2013-09-10T13:57:02.480+0000",
"lastUpdated" : "2013-09-10T13:57:02.480+0000"
}
],
"userGroupAccesses" : []
}</pre><p>A more tailored response can be obtained by specifying specific fields in the request.
        An example is provided below, which would return more detailed information about each object
        on a users dashboard.</p><pre class="screen">/api/dashboards/vQFhmLJU5sK/?fields=:all,dashboardItems[:all]</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e7352"></a>1.31.2.&nbsp;Searching dashboards</h3></div></div></div><p>When setting a dashboard it is convenient from a consumer point of view to be able to
        search for various analytical resources using the <span class="italic">/dashboards/q</span> resource. This resource lets you search for matches on the name
        property of the following objects: charts, maps, report tables, users, reports and
        resources. You can do a search by making a <span class="italic">GET</span> request on
        the following resource URL pattern, where my-query should be replaced by the preferred
        search query:</p><pre class="screen">api/dashboards/q/my-query.json</pre><p>JSON and XML response formats are supported. The response in JSON format will contain
        references to matching resources and counts of how many matches were found in total and for
        each type of resource. It will look similar to this:</p><pre class="screen">{
    "charts": [{
        "name": "ANC: 1-3 dropout rate Yearly",
        "id": "LW0O27b7TdD"
    }, {
        "name": "ANC: 1 and 3 coverage Yearly",
        "id": "UlfTKWZWV4u"
    }, {
        "name": "ANC: 1st and 3rd trends Monthly",
        "id": "gnROK20DfAA"
    }],
    "maps": [{
        "name": "ANC: 1st visit at facility (fixed) 2013",
        "id": "YOEGBvxjAY0"
    }, {
        "name": "ANC: 3rd visit coverage 2014 by district",
        "id": "ytkZY3ChM6J"
    }],
    "reportTables": [{
        "name": "ANC: ANC 1 Visits Cumulative Numbers",
        "id": "tWg9OiyV7mu"
    }],
    "reports": [{
        "name": "ANC: 1st Visit Cumulative Chart",
        "id": "Kvg1AhYHM8Q"
    }, {
        "name": "ANC: Coverages This Year",
        "id": "qYVNH1wkZR0"
    }],
    "searchCount": 8,
    "chartCount": 3,
    "mapCount": 2,
    "reportTableCount": 1,
    "reportCount": 2,
    "userCount": 0,
    "patientTabularReportCount": 0,
    "resourceCount": 0
}</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e7369"></a>1.31.3.&nbsp;Creating, updating and removing dashboards</h3></div></div></div><p>Creating, updating and deleting dashboards follow standard REST semantics. In order to
        create a new dashboard you can make a <span class="italic">POST</span> request to the
          <span class="italic">/api/dashboards</span> resource. From a consumer perspective
        it might be convenient to first create a dashboard and later add items to it. JSON and XML
        formats are supported for the request payload. To create a dashboard with the name "My
        dashboard" you can use a payload in JSON like this:</p><pre class="screen">{
  "name": "My dashboard"
}</pre><p>To update, e.g. rename, a dashboard, you can make a <span class="italic">PUT</span> request with a similar request payload the same api/dasboards
        resource.</p><p>To remove a dashboard, you can make a <span class="italic">DELETE</span> request
        to the specific dashboard resource similar to this:</p><pre class="screen">/api/dashboards/vQFhmLJU5sK</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e7394"></a>1.31.4.&nbsp;Adding, moving and removing dashboard items and content</h3></div></div></div><p>In order to add dashboard items a consumer can use the <span class="italic">/api/dashboards/&lt;dashboard-id&gt;/items/content</span> resource, where
        &lt;dashboard-id&gt; should be replaced by the relevant dashboard identifier. The request
        must use the <span class="italic">POST</span> method. The URL syntax and parameters
        are described in detail in the following table.</p><div class="table"><a name="d6099e7405"></a><p class="title"><b>Table&nbsp;1.55.&nbsp;Items content parameters</b></p><div class="table-contents"><table class="table" summary="Items content parameters" border="1"><colgroup><col class="c1"><col class="c2"><col class="c3"></colgroup><thead><tr><th>Query parameter</th><th>Description</th><th>Options</th></tr></thead><tbody><tr><td>type</td><td>Type of the resource to be represented by the dashboard item</td><td>chart | map | reportTable | users | reports | reportTables | resources |
                patientTabularReports | app</td></tr><tr><td>id</td><td>Identifier of the resource to be represented by the dashboard item</td><td>Resource identifier</td></tr></tbody></table></div></div><br class="table-break"><p>A <span class="italic">POST</span> request URL for adding a chart to a specific
        dashboard could look like this, where the last id query parameter value is the chart
        resource identifier:</p><pre class="screen">/api/dashboards/vQFhmLJU5sK/items/content?type=chart&amp;id=LW0O27b7TdD</pre><p>When adding resource of type map, chart, report table and app, the API will create and
        add a new item to the dashboard. When adding a resource of type users, reports, report
        tables and resources, the API will try to add the resource to an existing dashboard item of
        the same type. If no item of same type or no item of same type with less than eight
        resources associated with it exists, the API will create a new dashboard item and add the
        resource to it.</p><p>In order to move a dashboard item to a new position within the list of items in a
        dashboard, a consumer can make a <span class="italic">POST</span> request to the
        following resource URL, where &lt;dashboard-id&gt; should be replaced by the identifier of
        the dashboard, &lt;item-id&gt; should be replaced by the identifier of the dashboard item
        and &lt;index&gt; should be replaced by the new position of the item in the dashboard, where
        the index is
        zero-based:</p><pre class="screen">/api/dashboards/&lt;dashboard-id&gt;/items/&lt;item-id&gt;/position/&lt;index&gt;</pre><p>To remove a dashboard item completely from a specific dashboard a consumer can make a
          <span class="italic">DELETE</span> request to the below resource URL, where
        &lt;dashboard-id&gt; should be replaced by the identifier of the dashboard and
        &lt;item-id&gt; should be replaced by the identifier of the dashboard item. The dashboard
        item identifiers can be retrieved through a GET request to the dashboard resource
        URL.</p><pre class="screen">/api/dashboards/&lt;dashboard-id&gt;/items/&lt;item-id&gt;</pre><p>To remove a specific content resource within a dashboard item a consumer can make a
          <span class="italic">DELETE</span> request to the below resource URL, where
        &lt;content-resource-id&gt; should be replaced by the identifier of a resource associated
        with the dasboard item; e.g. the identifier of a report or a user. For instance, this can be
        used to remove a single report from a dashboard item of type reports, as opposed to removing
        the dashboard item completely:</p><pre class="screen">/api/dashboards/&lt;dashboard-id&gt;/items/&lt;item-id&gt;/content/&lt;content-resource-id&gt;</pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e7465"></a>1.32.&nbsp;Analytics</h2></div></div></div><p>To access analytical, aggregated data in DHIS 2 you can work with the <span class="italic">analytics</span> resource. The analytics resource is powerful as it lets
      you query and retrieve data aggregated along all available data dimensions. For instance, you
      can ask the analytics resource to provide the aggregated data values for a set of data
      elements, periods and organisation units. Also, you can retrieve the aggregated data for a
      combination of any number of dimensions based on data elements and organisation unit group
      sets.</p><pre class="screen">api/analytics</pre><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e7475"></a>1.32.1.&nbsp;Dimensions and items</h3></div></div></div><p>DHIS 2 features a multi-dimensional data model with several fixed and dynamic data
        dimensions. The fixed dimensions are the data element, period (time) and organisation unit
        dimension. You can dynamically add dimensions through categories, data element group sets
        and organisation unit group sets. The table below displays the available data dimensions in
        DHIS 2. Each data dimension has a corresponding <span class="italic">dimension
          identifier</span>, and each dimension can have a set of <span class="italic">dimension items</span>:</p><div class="table"><a name="d6099e7486"></a><p class="title"><b>Table&nbsp;1.56.&nbsp;Dimensions and dimension items</b></p><div class="table-contents"><table class="table" summary="Dimensions and dimension items" border="1"><colgroup><col class="c1"><col class="c2"><col class="newCol3"></colgroup><thead><tr><th>Dimension</th><th>Dimension id</th><th>Dimension items</th></tr></thead><tbody><tr><td>Data elements, indicators, data set reporting rates, data element operands,
                program indicators, program data elements, program attributes</td><td>dx</td><td>Data element, indicator, data set, data element operand, program indicator,
                program attribute identifiers, keyword DE_GROUP-&lt;group-id&gt;, use
                &lt;dataelement-id&gt;.&lt;optioncombo-id&gt; for data element operands,
                &lt;program-id&gt;.&lt;dataelement-id&gt; for program data elements,
                &lt;program-id&gt;.&lt;attribute-id&gt; for program attributes.</td></tr><tr><td>Periods (time)</td><td>pe</td><td>ISO periods and relative periods, see "date and period
                format"</td></tr><tr><td>Organisation unit hierarchy</td><td>ou</td><td>Organisation unit identifiers, and keywords USER_ORGUNIT,
                USER_ORGUNIT_CHILDREN, USER_ORGUNIT_GRANDCHILDREN, LEVEL-&lt;level&gt; and
                OU_GROUP-&lt;group-id&gt;</td></tr><tr><td>Category option combinations</td><td>co</td><td>Category option combo identifers (omit to get all items)</td></tr><tr><td>Attribute option combinations</td><td>ao</td><td>Category option combo identifers (omit to get all items)</td></tr><tr><td>Categories</td><td>&lt;category id&gt;</td><td>Category option identifiers (omit to get all items)</td></tr><tr><td>Data element group sets</td><td>&lt;group set id&gt;</td><td>Data element group identifiers (omit to get all items)</td></tr><tr><td>Organisation unit group sets</td><td>&lt;group set id&gt;</td><td>Organisation unit group identifiers (omit to get all items)</td></tr><tr><td>Category option group sets</td><td>&lt;group set id&gt;</td><td>Category option group identifiers (omit to get all items)</td></tr></tbody></table></div></div><br class="table-break"><p>It is not necessary to be aware of which objects are used for the various dynamic
        dimensions when designing analytics queries. You can get a complete list of dynamic
        dimensions by visiting this URL in the Web API:</p><pre class="screen">/api/dimensions</pre><p>The base URL to the analytics resource is <span class="italic">api/analytics</span>. To request specific dimensions and dimension items you can use
        a query string on the following format, where <span class="italic">dim-id</span> and
          <span class="italic">dim-item</span> should be substituted with real values:</p><pre class="screen">/api/analytics?dimension=dim-id:dim-item;dim-item&amp;dimension=dim-id:dim-item;dim-item</pre><p>As illustrated above, the dimension identifier is followed by a colon while the
        dimension items are separated by semi-colons. As an example, a query for two data elements,
        two periods and two organisation units can be done with the following URL:</p><pre class="screen">/api/analytics?dimension=dx:fbfJHSPpUQD;cYeuwXTCPkU
&amp;dimension=pe:2014Q1;2014Q2&amp;dimension=ou:O6uvpzGd5pu;lc3eMKXaEfw</pre><p>To query for data broken down by category option combinations instead of data element
        totals you can include the category dimension in the query string, for instance like
        this:</p><pre class="screen">/api/analytics?dimension=dx:fbfJHSPpUQD;cYeuwXTCPkU
&amp;dimension=co&amp;dimension=pe:201401&amp;dimension=ou:O6uvpzGd5pu;lc3eMKXaEfw</pre><p>When selecting data elements you can also select all data elements in a group as items
        by using the DE_GROUP-&lt;id&gt; syntax:</p><pre class="screen">/api/analytics?dimension=dx:DE_GROUP-h9cuJOkOwY2
&amp;dimension=pe:201401&amp;dimension=ou:O6uvpzGd5pu</pre><p>To query for program data elements (of tracker domain type) you can get those by
        specifying the program for each data element using the &lt;program-id&gt;.&lt;dataelement-id&gt;
        syntax:</p><pre class="screen">/api/analytics.json?dimension=dx:eBAyeGv0exc.qrur9Dvnyt5;eBAyeGv0exc.GieVkTxp4HH
&amp;dimension=pe:LAST_12_MONTHS&amp;filter=ou:ImspTQPwCqd</pre><p>To query for program attributes (tracked entity attributes) you can get those by
        specifying the program for each attribute using the &lt;program.id&gt;.&lt;attribute-id&gt;
        syntax:</p><pre class="screen">/api/analytics.json?dimension=dx:IpHINAT79UW.a3kGcGDCuk6;IpHINAT79UW.UXz7xuGCEhU
&amp;dimension=pe:LAST_4_QUARTERS&amp;dimension=ou:ImspTQPwCqd</pre><p>To query for organisation unit group sets and data elements you can use the following
        URL - notice how the group set identifier is used as dimension identifier and the groups as
        dimension items:</p><pre class="screen">/api/analytics?dimension=Bpx0589u8y0:oRVt7g429ZO;MAs88nJc9nL
&amp;dimension=pe:2014&amp;dimension=ou:ImspTQPwCqd</pre><p>To query for data elements and categories you can use this URL - use the category
        identifier as dimension identifier and the category options as dimension items:</p><pre class="screen">/api/analytics?dimension=dx:s46m5MS0hxu;fClA2Erf6IO&amp;dimension=pe:2014
&amp;dimension=YNZyaJHiHYq:btOyqprQ9e8;GEqzEKCHoGA&amp;filter=ou:ImspTQPwCqd</pre><p>To query using relative periods and organisation units associated with the current user
        you can use a URL like this:</p><pre class="screen">/api/analytics?dimension=dx:fbfJHSPpUQD;cYeuwXTCPkU
&amp;dimension=pe:LAST_12_MONTHS&amp;dimension=ou:USER_ORGUNIT</pre><p>When selecting organisation units for a dimension you can select an entire level
        optionally constrained by any number of boundary organisation units with the
        LEVEL-&lt;level&gt; syntax. Boundary refers to a top node in a sub-hierarchy, meaning that
        all organisation units at the given level below the given boundary organisation unit in the
        hierarchy will be included in the response, and is provided as regular organisation unit
        dimension items. A simple query for all org units at level three:</p><pre class="screen">/api/analytics?dimension=dx:fbfJHSPpUQD&amp;dimension=pe:2014&amp;dimension=ou:LEVEL-3</pre><p>A query for level three and four with two boundary org units can be specified like
        this:</p><pre class="screen">/api/analytics?dimension=dx:fbfJHSPpUQD&amp;dimension=pe:2014
&amp;dimension=ou:LEVEL-3;LEVEL-4;O6uvpzGd5pu;lc3eMKXaEf</pre><p>When selecting organisation units you can also select all organisation units in an
        organisation unit group to be included as dimension items using the OU_GROUP-&lt;id&gt;
        syntax. The organisation units in the groups can optionally be constrained by any number of
        boundary organisation units. Both the level and the group items can be repeated any number
        of times:</p><pre class="screen">/api/analytics?dimension=dx:fbfJHSPpUQD&amp;dimension=pe:2014
&amp;dimension=ou:OU_GROUP-w0gFTTmsUcF;OU_GROUP-EYbopBOJWsW;O6uvpzGd5pu;lc3eMKXaEf</pre><p>A few things to be aware of when using the analytics resource are listed below.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Data elements, indicator and data sets are part of a common data dimension,
            identified as "dx". This means that you can use any of data elements,
            indicators and data set identifiers together with the "dx" dimension
            identifier in a query.</p></li><li class="listitem"><p>For the category, data element group set and organisation unit group set dimensions,
            all dimension items will be used in the query if no dimension items are
            specified.</p></li><li class="listitem"><p>For the period dimension, the dimension items are ISO period identifiers and/or
            relative periods. Please refer to the section above called "Date and period
            format" for the period format and available relative periods.</p></li><li class="listitem"><p>For the organisation unit dimension you can specify the items to be the organisation
            unit or sub-units of the organisation unit associated with the user currently
            authenticated for the request using they keys USER_ORGUNIT or USER_ORGUNIT_CHILDREN as
            items, respectively. You can also specify organisation unit identifiers directly, or a
            combination of both.</p></li><li class="listitem"><p>For the organisation unit dimension you can specify the organisation hierarchy level
            and the boundary unit to use for the request on the format
            LEVEL-&lt;level&gt;-&lt;boundary-id&gt;; as an example LEVEL-3-ImspTQPwCqd implies all
            organisation units below the given boundary unit at level 3 in the hierarchy.</p></li><li class="listitem"><p>For the organisation unit dimension the dimension items are the organisation units
            and their sub-hierarchy - data will be aggregated for all organisation units below the
            given organisation unit in the hierarchy.</p></li><li class="listitem"><p>You cannot specify dimension items for the category option combination dimension.
            Instead the response will contain the items which are linked to the data values.</p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e7650"></a>1.32.2.&nbsp;Request query parameters</h3></div></div></div><p>The analytics resource lets you specify a range of query parameters:</p><div class="table"><a name="d6099e7655"></a><p class="title"><b>Table&nbsp;1.57.&nbsp;Query parameters</b></p><div class="table-contents"><table class="table" summary="Query parameters" border="1"><colgroup><col class="c1"><col class="newCol2"><col class="c2"><col class="c3"></colgroup><thead><tr><th>Query parameter</th><th>Required</th><th>Description</th><th>Options</th></tr></thead><tbody><tr><td>dimension</td><td>Yes</td><td>Dimensions to be retrieved, repeated for each.</td><td>Any dimension</td></tr><tr><td>filter</td><td>No</td><td>Filters to apply to the query, repeated for each.</td><td>Any dimension</td></tr><tr><td>aggregationType</td><td>No</td><td>Aggregation type to use in the aggregation process.</td><td>SUM | AVERAGE | COUNT | STDDEV | VARIANCE</td></tr><tr><td>measureCriteria</td><td>No</td><td>Filters for the data/measures.</td><td>EQ | GT | GE | LT | LE</td></tr><tr><td>skipMeta</td><td>No</td><td>Exclude the meta data part of the response (improves performance).</td><td>false | true</td></tr><tr><td>skipData</td><td>No</td><td>Exclude the data part of the response.</td><td>false | true</td></tr><tr><td>skipRounding</td><td>No</td><td>Skip rounding of data values, i.e. provide full precision.</td><td>false | true</td></tr><tr><td>hierarchyMeta</td><td>No</td><td>Include names of organisation unit ancestors and hierarchy paths of
                  organisation units in the metadata.</td><td>false | true</td></tr><tr><td>ignoreLimit</td><td>No</td><td>Ignore limit on max 50 000 records in response - use with care.</td><td>false | true</td></tr><tr><td>tableLayout</td><td>No</td><td>Use plain data source or table layout for response.</td><td>false | true</td></tr><tr><td>hideEmptyRows</td><td>No</td><td>Hides empty rows in response, applicable when table layout is true.</td><td>false | true</td></tr><tr><td>showHierarchy</td><td>No</td><td>Display full org unit hierarchy path together with org unit name.</td><td>false | true</td></tr><tr><td>displayProperty</td><td>No</td><td>Property to display for metadata.</td><td>NAME | SHORTNAME</td></tr><tr><td>outputIdScheme</td><td>No</td><td>Property to use for metadata items the query response, can be identifier,
                  code or name.</td><td>UID | CODE | NAME</td></tr><tr><td>inputIdScheme</td><td>No</td><td>Property to use for metadata items in the request, can be identifier or
                  code.</td><td>UID | CODE</td></tr><tr><td>approvalLevel</td><td>No</td><td>Include data which has been approved at least up to the given approval level,
                  refers to identfier of approval level.</td><td>Identifier of approval level</td></tr><tr><td>relativePeriodDate</td><td>No</td><td>Date used as basis for relative periods.</td><td>Date.</td></tr><tr><td>userOrgUnit</td><td>No</td><td>Explicitly define the user org units to utilize, overrides organisation units
                  associated with current user, multiple identifiers can be separated by
                  semi-colon.</td><td>Organisation unit identifiers.</td></tr><tr><td>columns</td><td>No</td><td>Dimensions to use as columns for table layout.</td><td>Any dimension (must be query dimension)</td></tr><tr><td>rows</td><td>No</td><td>Dimensions to use as rows for table layout.</td><td>Any dimension (must be query dimension)</td></tr></tbody></table></div></div><p><br class="table-break">The <span class="italic">dimension</span> query parameter defines which
        dimensions should be included in the analytics query. Any number of dimensions can be
        specified. The dimension parameter should be repeated for each dimension to include in the
        query response. The query response can potentially contain aggregated values for all
        combinations of the specified dimension items.</p><p>The <span class="italic">filter</span> parameter defines which dimensions should
        be used as filters for the data retrieved in the analytics query. Any number of filters can
        be specified. The filter parameter should be repeated for each filter to use in the query. A
        filter differs from a dimension in that the filter dimensions will not be part of the query
        response content, and that the aggregated values in the response will be collapsed on the
        filter dimensions. In other words, the data in the response will be aggregated on the filter
        dimensions, but the filters will not be included as dimensions in the actual response. As an
        example, to query for certain data elements filtered by the periods and organisation units
        you can use the following URL:</p><pre class="screen">/api/analytics?dimension=dx:fbfJHSPpUQD;cYeuwXTCPkU&amp;filter=pe:2014Q1;2014Q2&amp;filter=ou:O6uvpzGd5pu;lc3eMKXaEfw</pre><p>The <span class="italic">aggregationType</span> query parameter lets you define
        which aggregation operator should be used for the query. By default the aggregation operator
        defined for data elements included in the query will be used. If your query does not contain
        any data elements, but does include data element groups, the aggregation operator of the
        first data element in the first group will be used. The order of groups and data elements is
        undefined. This query parameter allows you to override the default and specify a specific
        aggregation operator. As an example you can set the aggregation operator to
        "count" with the following URL:</p><pre class="screen">/api/analytics?dimension=dx:fbfJHSPpUQD&amp;dimension=pe:2014Q1&amp;dimension=ou:O6uvpzGd5pu&amp;aggregationType=COUNT</pre><p>The <span class="italic">measureCriteria</span> query parameter lets you filter
        out ranges of data records to return. You can instruct the system to return only records
        where the aggregated data value is equal, greater than, greater or equal, less than or less
        or equal to certain values. You can specify any number of criteria on the following format,
        where <span class="italic">critieria</span> and <span class="italic">value</span> should be substituted with real values:</p><pre class="screen">/api/analytics?measureCriteria=criteria:value;criteria:value</pre><p>As an example, the following query will return only records where the data value is
        greater or equal to 6500 and less than 33000:</p><pre class="screen">/api/analytics?dimension=dx:fbfJHSPpUQD;cYeuwXTCPkU&amp;dimension=pe:2014
&amp;dimension=ou:O6uvpzGd5pu;lc3eMKXaEfw&amp;measureCriteria=GE:6500;LT:33000</pre><p>In order to have the analytics resource generate the data in the shape of a ready-made
        table, you can provide the <span class="italic">tableLayout</span> parameter with
        true as value. Instead of generating a plain, normalized data source, the analytics resource
        will now generate the data in table layout. You can use the <span class="italic">columns</span> and <span class="italic">rows</span> parameters with dimension
        identifiers separated by semi-colons as values to indicate which ones to use as table
        columns and rows. The column and rows dimensions must be present as a data dimension in the
        query (not a filter). Such a request can look like this:</p><pre class="screen">/api/analytics.html?dimension=dx:fbfJHSPpUQD;cYeuwXTCPkU&amp;dimension=pe:2014Q1;2014Q2
&amp;dimension=ou:O6uvpzGd5pu&amp;tableLayout=true&amp;columns=dx;ou&amp;rows=pe</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e7902"></a>1.32.3.&nbsp;Response formats</h3></div></div></div><p>The analytics response containing aggregate data can be returned in various
        representation formats. As usual, you can indicate interest in a specific format by
        appending a file extension to the URL, through the <span class="italic">Accept</span>
        HTTP header or through the <span class="italic">format</span> query parameter. The
        default format is JSON. The available formats and content-types are listed below.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>json (application/json)</p></li><li class="listitem"><p>jsonp (application/javascript)</p></li><li class="listitem"><p>xml (application/xml)</p></li><li class="listitem"><p>csv (application/csv)</p></li><li class="listitem"><p>html (text/html)</p></li><li class="listitem"><p>html+css</p></li><li class="listitem"><p>xls (application/vnd.ms-excel)</p></li></ul></div><p>As an example, to request an analytics response in XML format you can use the following
        URL:</p><pre class="screen">/api/analytics.xml?dimension=dx:fbfJHSPpUQD
&amp;dimension=pe:2014&amp;dimension=ou:O6uvpzGd5pu;lc3eMKXaEfw</pre><p>The analytics responses must be retrieved using the HTTP <span class="italic">GET</span> method. This allows for direct linking to analytics responses from Web
        pages as well as other HTTP-enabled clients. To do functional testing we can use the cURL
        library. By executing this command against the demo database you will get an analytics
        response in JSON format:</p><pre class="screen">curl "play.dhis2.org/demo/api/analytics.json?dimension=dx:eTDtyyaSA7f;FbKK4ofIv5R
&amp;dimension=pe:2014Q1;2014Q2&amp;filter=ou:ImspTQPwCqd" -u admin:district</pre><p>The JSON response will look like this:</p><pre class="screen">{
    "headers": [
        {
            "name": "dx",
            "column": "Data",
            "meta": true,
            "type": "java.lang.String"
        },
        {
            "name": "pe",
            "column": "Period",
            "meta": true,
            "type": "java.lang.String"
        },
        {
            "name": "value",
            "column": "Value",
            "meta": false,
            "type": "java.lang.Double"
        }
    ],
    "height": 4,
    "metaData": {
        "pe": [
            "2014Q1",
            "2014Q2"
        ],
        "ou": [
            "ImspTQPwCqd"
        ],
        "names": {
            "2014Q1": "Jan to Mar 2014",
            "2014Q2": "Apr to Jun 2014",
            "FbKK4ofIv5R": "Measles Coverage &lt;1 y",
            "ImspTQPwCqd": "Sierra Leone",
            "eTDtyyaSA7f": "Fully Immunized Coverage"
        }
    },
    "rows": [
        [
            "eTDtyyaSA7f",
            "2014Q2",
            "81.1"
        ],
        [
            "eTDtyyaSA7f",
            "2014Q1",
            "74.7"
        ],
        [
            "FbKK4ofIv5R",
            "2014Q2",
            "88.9"
        ],
        [
            "FbKK4ofIv5R",
            "2014Q1",
            "84.0"
        ]
    ],
    "width": 3
}
</pre><p>The response represents a table of dimensional data. The <span class="italic">headers</span> array gives an overview of which columns are included in the table and
        what the columns contain. The <span class="italic">column</span> property shows the
        column dimension identifier, or if the column contains measures, the word "Value".
        The <span class="italic">meta</span> property is <span class="italic">true</span> if the column contains dimension items or <span class="italic">false</span> if the column contains a measure (aggregated data values). The <span class="italic">name</span> property is similar to the column property, except it
        displays "value" in case the column contains a measure. The <span class="italic">type</span> property indicates the Java class type of the column
        values.</p><p>The <span class="italic">height</span> and <span class="italic">width</span> properties indicate how many data columns and rows are contained in the
        response, respectively.</p><p>The <span class="italic">metaData periods</span> property contains a unique,
        ordered array of the periods included in the response. The <span class="italic">metaData
          ou</span> property contains an array of the identifiers of organisation units included
        in the response. The <span class="italic">metaData names</span> property contains a
        mapping between the identifiers used in the data response and the names of the objects they
        represent. It can be used by clients to substitute the identifiers within the data response
        with names in order to give a more meaningful view of the data table.</p><p>The <span class="italic">rows</span> array contains the dimensional data table.
        It contains columns with dimension items (object or period identifiers) and a column with
        aggregated data values. The example response above has a data/indicator column, a period
        column and a value column. The first column contains indicator identifiers, the second
        contains ISO period identifiers and the third contains aggregeted data values.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e7997"></a>1.32.4.&nbsp;Constraints</h3></div></div></div><p>There are several constraints on the input you can provide to the analytics
        resource.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>At least one dimension must be specified in a query.</p></li><li class="listitem"><p>Dimensions cannot be specified as dimension and filter simultaneously.</p></li><li class="listitem"><p>At least one period must be specified as dimension or filter.</p></li><li class="listitem"><p>Indicators, data sets and categories cannot be specified as filters.</p></li><li class="listitem"><p>Data element group sets cannot be specified together with data sets.</p></li><li class="listitem"><p>Categories can only be specified together with data elements, not indicators or data
            sets.</p></li><li class="listitem"><p>A dimension cannot be specified more than once.</p></li><li class="listitem"><p>Fixed dimensions ("dx", "pe", "ou") must have at least
            one option if included in a query.</p></li><li class="listitem"><p>A table cannot contain more than 50 000 cells by default, this can be configured
            under system settings.</p></li></ul></div><p>When a query request violates any of these constraints the server will return a response
        with status code 409 and content-type "text/plain" together with a textual
        description of the problem.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e8032"></a>1.32.5.&nbsp;Debugging</h3></div></div></div><p>When debugging analytics requests it can be useful to examine the data value source of
        the aggregated analytics response. The <span class="italic">analytics/debug/sql</span> resource will provide an SQL statement that returns the
        relevant content of the datavalue table. You can produce this SQL by doing a GET request
        with content type "text/html" or "text/plain" like below. The dimension
        and filter syntax is identical to regular analytics queries:</p><pre class="screen">/api/analytics/debug/sql?dimension=dx:fbfJHSPpUQD;cYeuwXTCPkU&amp;filter=pe:2014Q1;2014Q2&amp;filter=ou:O6uvpzGd5pu</pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e8042"></a>1.33.&nbsp;Event analytics</h2></div></div></div><p>The event analytics API lets you access aggregated event data and query <span class="italic">events</span> captured in DHIS 2. This resource lets you retrieve events
      based on a program and optionally a program stage, and lets you retrieve and filter events on
      any event dimensions. </p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e8050"></a>1.33.1.&nbsp;Dimensions and items</h3></div></div></div><p>Event dimensions include data elements, attributes, organisation units and periods. The
        aggregated event analytics resource will return aggregated information such as counts or
        averages. The query analytics resource will simply return events matching a set of criteria
        and does not perform any aggregation. You can specify dimension items in the form of options
        from option sets and legends from legend sets for data elements and attributes which are
        associated with such. The event dimensions are listed in the table below.</p><div class="table"><a name="d6099e8055"></a><p class="title"><b>Table&nbsp;1.58.&nbsp;Event dimensions</b></p><div class="table-contents"><table class="table" summary="Event dimensions" border="1"><colgroup><col class="c1"><col class="c2"><col class="c3"></colgroup><thead><tr><th>Dimension</th><th>Dimension id</th><th>Description</th></tr></thead><tbody><tr><td>Data elements</td><td>&lt;id&gt;</td><td>Data element identifiers</td></tr><tr><td>Attributes</td><td>&lt;id&gt;</td><td>Attribute identifiers</td></tr><tr><td>Periods</td><td>pe</td><td>ISO periods and relative periods, see "date and period
                format"</td></tr><tr><td>Organisation units</td><td>ou</td><td>Organisation unit identifiers</td></tr><tr><td>Organisation unit group sets</td><td>&lt;id&gt;</td><td>Organisation unit group set identifiers</td></tr></tbody></table></div></div><br class="table-break"></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e8106"></a>1.33.2.&nbsp;Request query parameters</h3></div></div></div><p>The analytics event API let you specify a range of query parameters.</p><div class="table"><a name="d6099e8111"></a><p class="title"><b>Table&nbsp;1.59.&nbsp;Query parameters for both event query and aggregate analytics</b></p><div class="table-contents"><table class="table" summary="Query parameters for both event query and aggregate analytics" border="1"><colgroup><col class="c1"><col class="c2"><col class="c3"><col class="c4"></colgroup><thead><tr><th>Query parameter</th><th>Required</th><th>Description</th><th>Options</th></tr></thead><tbody><tr><td>program</td><td>Yes</td><td>Program identifier.</td><td>Any program identifier</td></tr><tr><td>stage</td><td>No</td><td>Program stage identifier.</td><td>Any program stage identifier</td></tr><tr><td>startDate</td><td>Yes</td><td>Start date for events.</td><td>Date in yyyy-MM-dd format</td></tr><tr><td>endDate</td><td>Yes</td><td>End date for events.</td><td>Date in yyyy-MM-dd format</td></tr><tr><td>dimension</td><td>Yes</td><td>Dimension identifier including data elements, attributes, program indicators,
                periods, organisation units and organisation unit group sets. Parameter can be
                repeated any number of times. Item filters can be applied to a dimension on the
                format &lt;item-id&gt;:&lt;operator&gt;:&lt;filter&gt;. Filter values are
                case-insensitive.</td><td>Operators can be EQ | GT | GE | LT | LE | NE | LIKE | IN</td></tr><tr><td>filter</td><td>No</td><td>Dimension identifier including data elements, attributes, periods, organisation
                units and organisation unit group sets. Parameter can be repeated any number of
                times. Item filters can be applied to a dimension on the format
                &lt;item-id&gt;:&lt;operator&gt;:&lt;filter&gt;. Filter values are
                case-insensitive.</td><td>&nbsp;</td></tr><tr><td>hierarchyMeta</td><td>No</td><td>Include names of organisation unit ancestors and hierarchy paths of
                organisation units in the metadata.</td><td>false | true</td></tr></tbody></table></div></div><br class="table-break"><div class="table"><a name="d6099e8192"></a><p class="title"><b>Table&nbsp;1.60.&nbsp;Query parameters for event query analytics only</b></p><div class="table-contents"><table class="table" summary="Query parameters for event query analytics only" border="1"><colgroup><col class="c1"><col class="c2"><col class="c3"><col class="c4"></colgroup><thead><tr><th>Query parameter</th><th>Required</th><th>Description</th><th>Options</th></tr></thead><tbody><tr><td>ouMode</td><td>No</td><td>The mode of selecting organisation units. Default is DESCENDANTS, meaning all
                sub units in the hierarchy. CHILDREN refers to immediate children in the hierarchy;
                SELECTED refers to the selected organisation units only.</td><td>DESCENDANTS, CHILDREN, SELECTED</td></tr><tr><td>asc</td><td>No</td><td>Dimensions to be sorted ascending, can reference event date, org unit name and
                code and any item identifiers.</td><td>EVENTDATE | OUNAME | OUCODE | item identifier</td></tr><tr><td>desc</td><td>No</td><td>Dimensions to be sorted descending, can reference event date, org unit name and
                code and any item identifiers.</td><td>EVENTDATE | OUNAME | OUCODE | item identifier</td></tr><tr><td>coordinatesOnly</td><td>No</td><td>Whether to only return events which have coordinates.</td><td>false | true</td></tr><tr><td>page</td><td>No</td><td>The page number. Default page is 1.</td><td>Numeric positive value</td></tr><tr><td>pageSize</td><td>No</td><td>The page size. Default size is 50 items per page.</td><td>Numeric zero or positive value</td></tr></tbody></table></div></div><br class="table-break"><div class="table"><a name="d6099e8265"></a><p class="title"><b>Table&nbsp;1.61.&nbsp;Query parameters for aggregate event analytics only</b></p><div class="table-contents"><table class="table" summary="Query parameters for aggregate event analytics only" border="1"><colgroup><col class="c1"><col class="c2"><col class="c3"><col class="c4"></colgroup><thead><tr><th>Query parameter</th><th>Required</th><th>Description</th><th>Options</th></tr></thead><tbody><tr><td>value</td><td>No</td><td>Value dimension identifier. Can be a data element or an attribute which must be
                of numeric value type.</td><td>Data element or attribute identifier</td></tr><tr><td>aggregationType</td><td>No</td><td>Aggregation type for the value dimension. Default is AVERAGE.</td><td>AVERAGE | SUM | COUNT | STDDEV | VARIANCE | MIN | MAX</td></tr><tr><td>showHierarchy</td><td>No</td><td>Display full org unit hierarchy path together with org unit name.</td><td>false | true</td></tr><tr><td>displayProperty</td><td>No</td><td>Property to display for metadata.</td><td>NAME | SHORTNAME</td></tr><tr><td>sortOrder</td><td>No</td><td>Sort the records on the value column in ascending or descending order.</td><td>ASC | DESC</td></tr><tr><td>limit</td><td>No</td><td>The maximum number of records to return. Cannot be larger than 10 000.</td><td>Numeric positive value</td></tr><tr><td>outputType</td><td>No</td><td>Specify output type for analytical data which can be events, enrollments or
                tracked entity instances. The two last options apply to programs with registration
                only.</td><td>EVENT | ENROLLMENT | TRACKED_ENTITY_INSTANCE</td></tr><tr><td>collapseDataDimensions</td><td>No</td><td>Collapse all data dimensions (data elements and attributes) into a single
                dimension in the response.</td><td>false | true</td></tr><tr><td>skipMeta</td><td>No</td><td>Exclude the meta data part of the response (improves performance).</td><td>false | true</td></tr><tr><td>skipData</td><td>No</td><td>Exclude the data part of the response.</td><td>false | true</td></tr><tr><td>skipRounding</td><td>No</td><td>Skip rounding of aggregate data values.</td><td>false | true</td></tr><tr><td>aggregateData</td><td>No</td><td>Produce aggregate values for the data dimensions (as opposed to dimension
                items).</td><td>false | true</td></tr></tbody></table></div></div><br class="table-break"><div class="table"><a name="d6099e8392"></a><p class="title"><b>Table&nbsp;1.62.&nbsp;Query parameters for cluster event analytics only</b></p><div class="table-contents"><table class="table" summary="Query parameters for cluster event analytics only" border="1"><colgroup><col class="c1"><col class="c2"><col class="c3"><col class="c4"></colgroup><thead><tr><th>Query parameter</th><th>Required</th><th>Description</th><th>Options</th></tr></thead><tbody><tr><td>clusterSize</td><td>Yes</td><td>Size of clusters in meters.</td><td>Numeric positive value</td></tr><tr><td>bbox</td><td>Yes</td><td>Bounding box / area of events to include in the response on the format "min
                longitude, min latitude, max longitude , max latitude".</td><td>String</td></tr><tr><td>includeClusterPoints</td><td>No</td><td>Include information about underlying points for each cluster, be careful if
                cluster represent a very high number of points.</td><td>false | true</td></tr></tbody></table></div></div><br class="table-break"></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e8438"></a>1.33.3.&nbsp;Event query analytics</h3></div></div></div><p>The <span class="italic">analytics/events/query</span> resource lets you query
        for captured events. This resource does not perform any aggregation, rather it lets you
        query and filter for information about events.</p><pre class="screen">/api/analytics/events/query</pre><p> You can specify any number of dimensions and any number of filters in a query.
        Dimension item identifiers can refer to any of data elements, person attributes, person
        identifiers, fixed and relative periods and organisation units. Dimensions can optionally
        have a query operator and a filter. Event queries should be on the format described
        below.</p><pre class="screen">/api/analytics/events/query/&lt;program-id&gt;?startDate=yyyy-MM-dd&amp;endDate=yyyy-MM-dd
&amp;dimension=ou:&lt;ou-id&gt;;&lt;ou-id&gt;&amp;dimension=&lt;item-id&gt;&amp;dimension=&lt;item-id&gt;:&lt;operator&gt;:&lt;filter&gt;</pre><p>For example, to retrieve events from the "Inpatient morbidity and mortality"
        program between January and October 2014, where the "Gender" and "Age"
        data elements are included and the "Age" dimension is filtered on "18",
        you can use the following query:</p><pre class="screen">/api/analytics/events/query/eBAyeGv0exc?startDate=2014-01-01&amp;endDate=2014-10-31
&amp;dimension=ou:O6uvpzGd5pu;fdc6uOvgoji&amp;dimension=oZg33kd9taw&amp;dimension=qrur9Dvnyt5:EQ:18</pre><p>To retrieve events for the "Birth" program stage of the "Child
        programme" program between March and December 2014, where the "Weight" data
        element, filtered for values larger than 2000:</p><pre class="screen">/api/analytics/events/query/IpHINAT79UW?stage=A03MvHHogjR&amp;startDate=2014-03-01&amp;endDate=2014-12-31
&amp;dimension=ou:O6uvpzGd5pu&amp;dimension=UXz7xuGCEhU:GT:2000</pre><p>Sorting can be applied to the query for the event date of the event and any dimensions.
        To sort descending on the event date and ascending on the "Age" data element
        dimension you can use:</p><pre class="screen">/api/analytics/events/query/eBAyeGv0exc?startDate=2014-01-01&amp;endDate=2014-10-31
&amp;dimension=ou:O6uvpzGd5pu&amp;dimension=qrur9Dvnyt5&amp;desc=EVENTDATE&amp;asc=qrur9Dvnyt5</pre><p>Paging can be applied to the query by specifying the page number and the page size
        parameters. If page number is specified but page size is not, a page size of 50 will be
        used. If page size is specified but page number is not, a page number of 1 will be used. To
        get the third page of the response with a page size of 20 you can use a query like
        this:</p><pre class="screen">/api/analytics/events/query/eBAyeGv0exc?startDate=2014-01-01&amp;endDate=2014-10-31
&amp;dimension=ou:O6uvpzGd5pu&amp;dimension=qrur9Dvnyt5&amp;page=3&amp;pageSize=20</pre><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="d6099e8468"></a>1.33.3.1.&nbsp;Filtering</h4></div></div></div><p>Filters can be applied to data elements, person attributes and person identifiers. The
          filtering is done through the query parameter value on the following format:</p><pre class="screen">&amp;dimension=&lt;item-id&gt;:&lt;operator&gt;:&lt;filter-value&gt;</pre><p>As an example, you can filter the "Weight" data element for values greater
          than 2000 and lower than 4000 like this:</p><pre class="screen">&amp;dimension=UXz7xuGCEhU:GT:2000&amp;dimension=UXz7xuGCEhU:LT:4000</pre><p>You can filter the "Age" data element for multiple, specific ages using the
          IN operator like this:</p><pre class="screen">&amp;dimension=qrur9Dvnyt5:IN:18;19;20</pre><p>You can specify multiple filters for a given item by repeating the operator and filter
          components:</p><pre class="screen">&amp;dimension=qrur9Dvnyt5:GT:5;LT;15</pre><p>The available operators are listed below.</p><div class="table"><a name="d6099e8489"></a><p class="title"><b>Table&nbsp;1.63.&nbsp;Filter operators</b></p><div class="table-contents"><table class="table" summary="Filter operators" border="1"><colgroup><col width="87.75pt" class="c1"><col width="368.25pt" class="c2"></colgroup><thead><tr><th>Operator</th><th>Description</th></tr></thead><tbody><tr><td>EQ</td><td>Equal to</td></tr><tr><td>GT</td><td>Greater than</td></tr><tr><td>GE</td><td>Greater than or equal to</td></tr><tr><td>LT</td><td>Less than</td></tr><tr><td>LE</td><td>Less than or equal to</td></tr><tr><td>NE</td><td>Not equal to</td></tr><tr><td>LIKE</td><td>Like (free text match)</td></tr><tr><td>IN</td><td>Equal to one of multiple values separated by ";"</td></tr></tbody></table></div></div><br class="table-break"></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="d6099e8542"></a>1.33.3.2.&nbsp;Response formats</h4></div></div></div><p>The default response representation format is JSON. The requests must be using the
          HTTP <span class="italic">GET</span> method. The following response formats are
          supported.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>json (application/json)</p></li><li class="listitem"><p>jsonp (application/javascript)</p></li><li class="listitem"><p>xls (application/vnd.ms-excel)</p></li></ul></div><p>As an example, to get a response in Excel format you can use a file extension in the
          request URL like this:</p><pre class="screen">/api/analytics/events/query/eBAyeGv0exc.xls?startDate=2014-01-01&amp;endDate=2014-10-31
&amp;dimension=ou:O6uvpzGd5pu&amp;dimension=oZg33kd9taw&amp;dimension=qrur9Dvnyt5</pre><p>You can set the hierarchyMeta query parameter to true in order to include names of all
          ancestor organisation units in the meta-section of the response:</p><pre class="screen">/api/analytics/events/query/eBAyeGv0exc?startDate=2014-01-01&amp;endDate=2014-10-31
&amp;dimension=ou:YuQRtpLP10I&amp;dimension=qrur9Dvnyt5:EQ:50&amp;hierarchyMeta=true</pre><p>The default response JSON format will look similar to this:</p><pre class="screen">{
    "headers": [
    {
        "name": "psi",
        "column": "Event",
        "type": "java.lang.String",
        "hidden": false,
        "meta": false
    },
    {
        "name": "ps",
        "column": "Program stage",
        "type": "java.lang.String",
        "hidden": false,
        "meta": false
    },
    {
        "name": "eventdate",
        "column": "Event date",
        "type": "java.lang.String",
        "hidden": false,
        "meta": false
    },
    {
        "name": "coordinates",
        "column": "Coordinates",
        "type": "java.lang.String",
        "hidden": false,
        "meta": false
    },
    {
        "name": "ouname",
        "column": "Organisation unit name",
        "type": "java.lang.String",
        "hidden": false,
        "meta": false
    },
    {
        "name": "oucode",
        "column": "Organisation unit code",
        "type": "java.lang.String",
        "hidden": false,
        "meta": false
    },
    {
        "name": "ou",
        "column": "Organisation unit",
        "type": "java.lang.String",
        "hidden": false,
        "meta": false
    },
    {
        "name": "oZg33kd9taw",
        "column": "Gender",
        "type": "java.lang.String",
        "hidden": false,
        "meta": false
    },
    {
        "name": "qrur9Dvnyt5",
        "column": "Age",
        "type": "java.lang.String",
        "hidden": false,
        "meta": false
    } ],
    "metaData": {
        "names": {
            "qrur9Dvnyt5": "Age",
            "eBAyeGv0exc": "Inpatient morbidity and mortality",
            "ImspTQPwCqd":&nbsp;"Sierra Leone",
            "O6uvpzGd5pu":&nbsp;"Bo",
            "YuQRtpLP10I": "Badjia",
            "oZg33kd9taw": "Gender"
        },
        "ouHierarchy": {
            "YuQRtpLP10I": "/ImspTQPwCqd/O6uvpzGd5pu"
        },
    },
    "width": 8,
    "height": 4,
    "rows": [
        ["yx9IDINf82o", "Zj7UnCAulEk", "2014-08-05", "[5.12, 1.23]", "Ngelehun", "OU_559", "YuQRtpLP10I", "Female", "50"],
        ["IPNa7AsCyFt", "Zj7UnCAulEk", "2014-06-12", "[5.22, 1.43]", "Ngelehun", "OU_559", "YuQRtpLP10I", "Female", "50"],
        ["ZY9JL9dkhD2", "Zj7UnCAulEk", "2014-06-15", "[5.42, 1.33]", "Ngelehun", "OU_559", "YuQRtpLP10I", "Female", "50"],
        ["MYvh4WAUdWt", "Zj7UnCAulEk", "2014-06-16", "[5.32, 1.53]", "Ngelehun", "OU_559", "YuQRtpLP10I", "Female", "50"]
    ]
}</pre><p>The <span class="italic">headers</span> section of the response describes the
          content of the query result. The event unique identifier, the program stage identifier,
          the event date, the organisation unit name, the organisation unit code and the
          organisation unit identifier appear as the first six dimensions in the response and will
          always be present. Next comes the data elements, person attributes and person identifiers
          which were specified as dimensions in the request, in this case the "Gender" and
          "Age" data element dimensions. The header section contains the identifier of the
          dimension item in the "name" property and a readable dimension description in
          the "column" property.</p><p>The <span class="italic">metaData</span> section, <span class="italic">ou</span> object contains the identifiers of all organisation units present in the
          response mapped to a string representing the hierarchy. This hierarchy string lists the
          identifiers of the ancestors (parents) of the organistion unit starting from the root. The
            <span class="italic">names</span> object contains the identifiers of all items in
          the response mapped to their names.</p><p>The <span class="italic">rows</span> section contains the events produced by
          the query. Each row represents exactly one event.</p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e8593"></a>1.33.4.&nbsp;Event aggregate analytics</h3></div></div></div><p>The <span class="italic">analytics/events/aggregate</span> resource lets you
        retrieve <span class="italic">aggregated numbers</span> of events captured in DHIS 2.
        This resource lets you retrieve aggregate data based on a program and optionally a program
        stage, and lets you filter on any event dimension.</p><pre class="screen">/api/analytics/events/aggregate</pre><p>The events aggregate resource does not return the event information itself, rather the
        aggregate numbers of events matching the request query. Event dimensions include data
        elements, person attributes, person identifiers, periods and organisation units. Aggregate
        event queries should be on the format described below.</p><pre class="screen">/api/analytics/events/aggregate/&lt;program-id&gt;?startDate=yyyy-MM-dd&amp;endDate=yyyy-MM-dd
&amp;dimension=ou:&lt;ou-id&gt;;&lt;ou-id&gt;&amp;dimension=&lt;item-id&gt;&amp;dimension=&lt;item-id&gt;:&lt;operator&gt;:&lt;filter&gt;</pre><p>For example, to retrieve aggregate numbers for events from the "Inpatient morbidity
        and mortality" program between January and October 2014, where the "Gender"
        and "Age" data elements are included, the "Age" dimension item is
        filtered on "18" and the "Gender" item is filtered on
        "Female", you can use the following query:</p><pre class="screen">/api/analytics/events/aggregate/eBAyeGv0exc?startDate=2014-01-01&amp;endDate=2014-10-31
&amp;dimension=ou:O6uvpzGd5pu&amp;dimension=oZg33kd9taw:EQ:Female&amp;dimension=qrur9Dvnyt5:GT:50</pre><p>To retrieve data for fixed and relative periods instead of start and end date, in this
        case May 2014 and last 12 months, and the organisation unit associated with the current
        user, you can use the following query:</p><pre class="screen">/api/analytics/events/aggregate/eBAyeGv0exc?dimension=pe:201405;LAST_12_MONTHS
&amp;dimension=ou:USER_ORGUNIT;fdc6uOvgo7ji&amp;dimension=oZg33kd9taw</pre><p>In order to specify "Female" as a filter for "Gender" for the data
        response, meaning "Gender" will not be part of the response but will filter the
        aggregate numbers in it, you can use the following syntax:</p><pre class="screen">/api/analytics/events/aggregate/eBAyeGv0exc?dimension=pe:2014;
&amp;dimension=ou:O6uvpzGd5pu&amp;filter=oZg33kd9taw:EQ:Female</pre><p>To specify the "Bo" organisation unit and the period "2014" as
        filters, and the "Mode of discharge" and Gender" as dimensions, where
        "Gender" is filtered on the "Male" item, you can use a query like
        this:</p><pre class="screen">/api/analytics/events/aggregate/eBAyeGv0exc?filter=pe:2014&amp;filter=ou:O6uvpzGd5pu
&amp;dimension=fWIAEtYVEGk&amp;dimension=oZg33kd9taw:EQ:Male</pre><p>To create a "Top 3 report" for "Mode of discharge" you can use the
        limit and sortOrder query parameters similar to this:</p><pre class="screen">/api/analytics/events/aggregate/eBAyeGv0exc?filter=pe:2014&amp;filter=ou:O6uvpzGd5pu
&amp;dimension=fWIAEtYVEGk&amp;limit=3&amp;sortOrder=DESC</pre><p>To specify a value dimension with a corresponding aggregation type you can use the value
        and aggregationType query parameters. Specifying a value dimension will make the analytics
        engine return aggregate values for the values of that dimension in the response as opposed
        to counts of events.</p><pre class="screen">/api/analytics/events/aggregate/eBAyeGv0exc.json?stage=Zj7UnCAulEk&amp;dimension=ou:ImspTQPwCqd
&amp;dimension=pe:LAST_12_MONTHS&amp;dimension=fWIAEtYVEGk&amp;value=qrur9Dvnyt5&amp;aggregationType=AVERAGE</pre><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="d6099e8634"></a>1.33.4.1.&nbsp;Ranges / legend sets</h4></div></div></div><p>For aggregate queries you can specify a range / legend set for numeric data element
          and attribute dimensions. The purpose is to group the numeric values into ranges. As an
          example, instead of generating data for an "Age" data element for distinct
          years, you can group the information into age groups. To achieve this, the data element or
          attribute must be associated with the legend set. The format is described below:</p><pre class="screen">?dimension=&lt;item-id&gt;-&lt;legend-set-id&gt;</pre><p>An example looks like this:</p><pre class="screen">/api/analytics/events/aggregate/eBAyeGv0exc.json?stage=Zj7UnCAulEk&amp;dimension=qrur9Dvnyt5-Yf6UHoPkdS6
&amp;dimension=ou:ImspTQPwCqd&amp;dimension=pe:LAST_12_MONTHS</pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="d6099e8645"></a>1.33.4.2.&nbsp;Response formats</h4></div></div></div><p>The default response representation format is JSON. The requests must be using the
          HTTP <span class="italic">GET</span> method. The response will look similar to
          this:</p><pre class="screen">{
    "headers": [
        {
            "name": "oZg33kd9taw",
            "column": "Gender",
            "type": "java.lang.String",
            "meta": false
        },
        {
            "name": "qrur9Dvnyt5",
            "column": "Age",
            "type": "java.lang.String",
            "meta": false
        },
        {
            "name": "pe",
            "column": "Period",
            "type": "java.lang.String",
            "meta": false
        },
        {
            "name": "ou",
            "column": "Organisation unit",
            "type": "java.lang.String",
            "meta": false
        },
        {
            "name": "value",
            "column": "Value",
            "type": "java.lang.String",
            "meta": false
        }
    ],
    "metaData": {
        "names": {
            "eBAyeGv0exc": "Inpatient morbidity and mortality"
        }
    },
    "width": 5,
    "height": 39,
    "rows": [
        [
            "Female",
            "95",
            "201405",
            "O6uvpzGd5pu",
            "2"
        ],
        [
            "Female",
            "63",
            "201405",
            "O6uvpzGd5pu",
            "2"
        ],
        [
            "Female",
            "67",
            "201405",
            "O6uvpzGd5pu",
            "1"
        ],
        [
            "Female",
            "71",
            "201405",
            "O6uvpzGd5pu",
            "1"
        ],
        [
            "Female",
            "75",
            "201405",
            "O6uvpzGd5pu",
            "14"
        ],
        [
            "Female",
            "73",
            "201405",
            "O6uvpzGd5pu",
            "5"
        ],
    ]
}</pre><p>Note that the max limit for rows to return in a single response is 10 000. If the
          query produces more than the max limit, a <span class="italic">409 Conflict</span>
          status code will be returned.</p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e8660"></a>1.33.5.&nbsp;Event clustering analytics</h3></div></div></div><p>The <span class="italic">analytics/events/cluster</span> resource provides
        clustered geospatial event data. A request looks like this:</p><pre class="screen">/api/analytics/events/cluster/eBAyeGv0exc?startDate=2014-01-01&amp;endDate=2014-10-31&amp;dimension=ou:LEVEL-2
&amp;clusterSize=100000&amp;bbox=-13.2682125,7.3721619,-10.4261178,9.904012&amp;includeClusterPoints=false</pre><p>The cluster response provides the count of underlying points, the centre point and
        extent of each cluster. If the <span class="italic">includeClusterPoints</span> query
        parameter is set to true, a comma-separated string with the identifiers of the underlying
        events is included. A sample response looks like this:</p><pre class="screen">{
    "headers": [{
        "name": "count",
        "column": "Count",
        "type": "java.lang.Long",
        "meta": false
    }, {
        "name": "center",
        "column": "Center",
        "type": "java.lang.String",
        "meta": false
    }, {
        "name": "extent",
        "column": "Extent",
        "type": "java.lang.String",
        "meta": false
    }, {
        "name": "points",
        "column": "Points",
        "type": "java.lang.String",
        "meta": false
    }],
    "width": 3,
    "height": 4,
    "rows": [
        ["3", "POINT(-13.15818 8.47567)", "BOX(-13.26821 8.4St7215,-13.08711 8.47807)", ""],
        ["9", "POINT(-13.11184 8.66424)", "BOX(-13.24982 8.51961,-13.05816 8.87696)", ""],
        ["1", "POINT(-12.46144 7.50597)", "BOX(-12.46144 7.50597,-12.46144 7.50597)", ""],
        ["7", "POINT(-12.47964 8.21533)", "BOX(-12.91769 7.66775,-12.21011 8.49713)", ""]
    ]
}</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e8677"></a>1.33.6.&nbsp;Event count and extent analytics</h3></div></div></div><p>The <span class="italic">analytics/events/count</span> resource is suitable for
        geometry-related requests for retrieving the count and extent (bounding box) of events for a
        specific query. The query syntax is equal to the <span class="italic">events/query</span> resource. A request looks like this:</p><pre class="screen">/api/analytics/events/count/eBAyeGv0exc?startDate=2014-01-01&amp;endDate=2014-10-31&amp;dimension=ou:O6uvpzGd5pu</pre><p> The response will provide the count and extent in JSON format:</p><pre class="screen">{
    extent: "BOX(-13.2682125910096 7.38679562779441,-10.4261178860988 9.90401290212795)",
    count: 59
}</pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e8694"></a>1.34.&nbsp;Data set report</h2></div></div></div><p>Data set reports can be generated trough the web api using the
        <span class="emphasis"><em>/dataSetReport</em></span> resource. This resource generates reports on data set
      and returns the result in the form of a HTML table. The request supports the following
      parameters:</p><p>
      </p><div class="table"><a name="d6099e8704"></a><p class="title"><b>Table&nbsp;1.64.&nbsp;Accepted parameters of /dataSetReport resource</b></p><div class="table-contents"><table class="table" summary="Accepted parameters of /dataSetReport resource" border="1"><colgroup><col class="c1"><col class="c2"><col class="c3"><col class="c4"></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Type</th><th>Required</th></tr></thead><tbody><tr><td>ds</td><td>Data set to create the report from</td><td>Data set UID</td><td>Yes</td></tr><tr><td>pe</td><td>Period to create the report from</td><td>ISO String</td><td>Yes</td></tr><tr><td>ou</td><td>Organisation unit to create the report from</td><td>Organisation unit UID</td><td>Yes</td></tr><tr><td>dimension</td><td>Dimensions to be used as filters for the report</td><td>One or more UIDs</td><td>No</td></tr><tr><td>selectedUnitOnly</td><td>Whether to use captured or aggregated data</td><td>Boolean</td><td>No</td></tr></tbody></table></div></div><p><br class="table-break">
    </p><p>The data set report resource accepts GET requests only. An example request to retrieve a
      report for a data set and orgunit for 2015 looks like
      this:</p><pre class="screen">GET /api/dataSetReport?ds=BfMAe6Itzgt&amp;pe=201610&amp;ou=ImspTQPwCqd&amp;selectedUnitOnly=false</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e8773"></a>1.35.&nbsp;Data usage analytics</h2></div></div></div><p>The usage analytics API lets you access information about how people are using DHIS 2, in
      particular related to data analysis. This resource lets you retrieve aggregated snapshots of
      usage analytics based on intervals in time. The resource will capture user views (e.g the
      number of times a chart or pivot table has been viewed by some user) and saved analysis
      favorites (e.g. favorite charts and pivot tables). When enabled, DHIS 2 will capture nightly
      snapshots which are then aggregated at request.</p><pre class="screen">/api/dataStatistics</pre><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e8780"></a>1.35.1.&nbsp;Request query parameter</h3></div></div></div><p>The usage analytics (data statistics) API supports two operations: POST to create a view
        event and GET to retrieve aggregated statistics.</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="d6099e8785"></a>1.35.1.1.&nbsp;Creating view events (POST)</h4></div></div></div><p>The usage analytics API lets you create event views. The dataStatisticsEventType
          parameter describes what type of item was viewed. As an example, the following URL can be
          used to create a new event view for charts:
          </p><pre class="screen">POST /api/dataStatistics?eventType=CHART_VIEW</pre><p>A successful save operation returns HTTP status code 201. The table below shows the
          supported types of events.</p><div class="table"><a name="d6099e8794"></a><p class="title"><b>Table&nbsp;1.65.&nbsp;Event types</b></p><div class="table-contents"><table class="table" summary="Event types" border="1"><colgroup><col class="c1"><col class="c2"></colgroup><thead><tr><th>Key</th><th>Description</th></tr></thead><tbody><tr><td>REPORT_TABLE_VIEW</td><td>Report table (pivot table) view.</td></tr><tr><td>CHART_VIEW</td><td>Chart view.</td></tr><tr><td>MAP_VIEW</td><td>Map view (GIS).</td></tr><tr><td>EVENT_REPORT_VIEW</td><td>Event report view.</td></tr><tr><td>EVENT_CHART_VIEW</td><td>Event chart view.</td></tr><tr><td>DASHBOARD_VIEW</td><td>Dashboard view.</td></tr></tbody></table></div></div><br class="table-break"></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="d6099e8837"></a>1.35.1.2.&nbsp;Aggregated usage analytics report (GET)</h4></div></div></div><p>The usage analytics (data statistics) API lets you specify certain query parameters
          when asking for an aggregated report.</p><div class="table"><a name="d6099e8842"></a><p class="title"><b>Table&nbsp;1.66.&nbsp;Query parameters for aggregated usage analytics (data statistics)</b></p><div class="table-contents"><table class="table" summary="Query parameters for aggregated usage analytics (data statistics)" border="1"><colgroup><col class="c1"><col class="c2"><col class="c3"><col class="c4"></colgroup><thead><tr><th>Query parameter</th><th>Required</th><th>Description</th><th>Options</th></tr></thead><tbody><tr><td>startDate</td><td>Yes</td><td>Start date for period</td><td>Date in yyyy-MM-dd format</td></tr><tr><td>endDate</td><td>Yes</td><td>End date for period</td><td>Date in yyyy-MM-dd format</td></tr><tr><td>interval</td><td>Yes</td><td>Type of interval to be aggregated</td><td>DAY, WEEK, MONTH, YEAR</td></tr></tbody></table></div></div><p><br class="table-break"></p><p>The startDate and endDate parameters specifies the period for which snaphots should be
          used in the aggregation. The dates must be formatted as shown above. If there is no
          snapshots saved in the specified period an empty list will be sent back. The interval
          parameter specifies what kind of aggregation will be done. As an example, to query for a
          yearly aggregation you can use the following URL:
          </p><pre class="screen">GET /api/dataStatistics?startDate=2014-01-02&amp;endDate=2016-01-01&amp;interval=MONTH</pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="d6099e8892"></a>1.35.1.3.&nbsp;Response format</h4></div></div></div><p>The usage analytics response containing aggregate data can be returned in various
          representation formats. The default format is JSON. The available formats and content-
          types are listed below. </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>json (application/json)</p></li><li class="listitem"><p>xml (application/xml)</p></li><li class="listitem"><p>html (text/html)</p></li></ul></div><p>As an example, to request an usage analytics response in XML format you can use the
        following URL:
        </p><pre class="screen">/api/dataStatistics.xml?startDate=2014-01-01&amp;endDate=2016-01-01&amp;interval=WEEK</pre><p>The aggregated usage analytics response must be retrieved using the HTTP GET method.
        This allows for direct linking to usage analytics responses from Web pages as well as other
        HTTP-enabled clients. To do functional testing we can use the cURL library. By executing
        this command against the demo database you will get an usage analytics response in JSON
        format:
        </p><pre class="screen">curl "play.dhis2.org/demo/api/dataStatistics?startDate=2016-02-01&amp;endDate=2016-02-14&amp;
interval=WEEK" -u admin:district</pre><p>The JSON response will look like this:
        </p><pre class="screen">[ 
  {
    "year": 2016,
    "week": 5,
    "activeUsers": 99,
    "mapViews": 2180,
    "chartViews": 2227,
    "reportTableViews": 5632,
    "eventReportViews": 5632,
    "eventChartViews": 9859,
    "dashboardViews": 10081,
    "totalViews": 1819,
    "averageViews": 6620,
    "savedMaps": 1804,
    "savedCharts": 2205,
    "savedReportTables": 1995,
    "savedEventReports": 1678,
    "savedEventCharts": 1613,
    "savedDashboards": 1922,
    "savedIndicators": 1831,
    "users": 969
}, 
{     
    "year": 2016,
    "week": 6,
    "activeUsers": 96,
    "mapViews": 2017,
    "chartViews": 2266,
    "reportTablesViews": 4714,
    "eventReportViews": 4714,
    "eventChartViews": 9510,
    "dashboardViews": 12181,
    "indicatorsViews": 10357,
    "totalViews": 2029,
    "averageViews": 6820,
    "savedMaps": 1642,
    "savedCharts": 1934,
    "savedReportTables": 1867,
    "savedEventReports": 1976,
    "savedEventCharts": 1713,
    "savedDashboards": 1736,
    "savedIndicators": 1646,
    "users": 953
  } 
] </pre><p>The response represents a list of aggregated data over two weekly intervals.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>The <span class="emphasis"><em>year</em></span> and <span class="emphasis"><em>week</em></span> properties show when the
            aggregated data is from.</p></li><li class="listitem"><p>The <span class="emphasis"><em>activeUsers</em></span> property is the maximum (peak) number of unique users
            that have made an event view.</p></li><li class="listitem"><p>The various views properties shows the number of views of each event (e.g map, chart) in the
            interval.</p></li><li class="listitem"><p>The <span class="emphasis"><em>totalViews</em></span> property shows the total number of views.</p></li><li class="listitem"><p>The <span class="emphasis"><em>averageViews</em></span> property shows the average number of views.</p></li><li class="listitem"><p>The varuous saved favorite properties shows how many favorites (e.g. report tables,
            dashboards) have been saved in the interval.</p></li><li class="listitem"><p>The <span class="emphasis"><em>users</em></span> property shows the total maximum (peak) number of users in the
            database at the given interval.</p></li></ul></div></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e8961"></a>1.36.&nbsp;Geo features</h2></div></div></div><p>The <span class="italic">geoFeatures</span> resource lets you retrieve geospatial
      information from DHIS 2. Geo features are stored together with organisation units, and the
      syntax for retrieving features is identical to the syntax used for the organisation unit
      dimension for the analytics resource. It is recommended to read up on the analytics api
      resource before continuing reading this section. You must use the GET request type, and only
      JSON response format is supported.</p><p>As an example, to retrieve geo features for all organisation units at level 3 in the
      organisation unit hierarchy you can use a GET request with the following URL:</p><pre class="screen">api/geoFeatures.json?ou=ou:LEVEL-3</pre><p>To retrieve geo features for organisation units at level within the boundary of an
      organisation unit (e.g. at level 2) you can use this URL:</p><pre class="screen">api/geoFeatures.json?ou=ou:LEVEL-4;O6uvpzGd5pu</pre><p>The semantics of the response properties are described in the following table.</p><div class="table"><a name="d6099e8979"></a><p class="title"><b>Table&nbsp;1.67.&nbsp;Geo features response</b></p><div class="table-contents"><table class="table" summary="Geo features response" border="1"><colgroup><col class="c1"><col class="c2"></colgroup><thead><tr><th>Property</th><th>Description</th></tr></thead><tbody><tr><td>id</td><td>Organisation unit / geo feature identifier</td></tr><tr><td>na</td><td>Organisation unit / geo feature name</td></tr><tr><td>hcd</td><td>Has coordinates down, indicating whether one or more children organisation units
              exist with coordinates (below in the hierarchy)</td></tr><tr><td>hcu</td><td>Has coordinates up, indicating whether the parent organisation unit has
              coordinates (above in the hierarchy)</td></tr><tr><td>le</td><td>Level of this organisation unit / geo feature.</td></tr><tr><td>pg</td><td>Parent graph, the graph of parent organisation unit identifiers up to the root in
              the hierarchy</td></tr><tr><td>pi</td><td>Parent identifier, the identifier of the parent of this organisation unit</td></tr><tr><td>pn</td><td>Parent name, the name of the parent of this organisation unit</td></tr><tr><td>ty</td><td>Geo feature type, 1 = point and 2 = polygon or multi-polygon</td></tr><tr><td>co</td><td>Coordinates of this geo feature</td></tr></tbody></table></div></div><br class="table-break"><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e9042"></a>1.36.1.&nbsp;GeoJSON</h3></div></div></div><p>Support for GeoJSON output was added in 2.17, to export GeoJSON, you can simple add
          <span class="italic">.geosjon</span> as an extension to the endpoint <span class="italic">/api/organisationUnits</span>, or you can use the <span class="italic">Accept</span> header <span class="italic">application/json+geojson</span>.</p><p>Two parameters are supported <span class="bold"><strong>level</strong></span> (defaults to 1) and
          <span class="bold"><strong>parent</strong></span> (defaults to root organisation units), both can be
        added multiple times, some examples follow.</p><p>Get all features at level 2 and 4:
        </p><pre class="screen">api/organisationUnits.geojson?level=2&amp;level=4</pre><p>Get all features at level 3 with a boundary organisation
        unit:</p><pre class="screen">api/organisationUnits.geojson?parent=fdc6uOvgoji&amp;level=3</pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e9075"></a>1.37.&nbsp;Generating resource and analytics tables</h2></div></div></div><p>DHIS 2 features a set of generated database tables which are used as basis for various
      system functionality. These tables can be executed immediately or scheduled to be executed at
      regular intervals through the user interface. They can also be generated through the Web API
      as explained in this section. This task is typically one for a system administrator and not
      consuming clients. </p><p>The resource tables are used internally by the DHIS 2 application for various analysis
      functions. These tables are also valuable for users writing advanced SQL reports. They can be
      generated with a POST or PUT request to the following URL:</p><pre class="screen">/api/resourceTables</pre><p>The analytics tables are optimized for data aggregation and used currently in DHIS 2 for
      the pivot table module. The analytics tables can be generated with a POST or PUT request
      to:</p><pre class="screen">/api/resourceTables/analytics</pre><div class="table"><a name="d6099e9088"></a><p class="title"><b>Table&nbsp;1.68.&nbsp;Analytics tables optional query parameters</b></p><div class="table-contents"><table class="table" summary="Analytics tables optional query parameters" border="1"><colgroup><col class="c1"><col class="c2"><col class="c3"></colgroup><thead><tr><th>Query parameter</th><th>Options</th><th>Description</th></tr></thead><tbody><tr><td>skipResourceTables</td><td>false | true</td><td>Skip generation of resource tables</td></tr><tr><td>skipAggregate</td><td>false | true</td><td>Skip generation of aggregate data and completeness data</td></tr><tr><td>skipEvents</td><td>false | true</td><td>Skip generation of event data</td></tr><tr><td>lastYears</td><td>integer</td><td>Number of last years of data to include</td></tr></tbody></table></div></div><br class="table-break"><p>These requests will return immediately and initiate a server-side process.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e9134"></a>1.38.&nbsp;Maintenance</h2></div></div></div><p>To perform maintenance you can interact with the <span class="italic">maintenance</span> resource. You should use <span class="italic">POST</span> or
        <span class="italic">PUT</span> as method for requests. The following requests are
      available. </p><p>Analytics tables clear will drop all analytics tables:</p><pre class="screen">/api/maintenance/analyticsTablesClear</pre><p>Expired invitations clear will remove all user account invitations which have
      expired:</p><pre class="screen">/api/maintenance/expiredInvitationsClear</pre><p>Period pruning will remove periods which are not linked to any data values:</p><pre class="screen">/api/maintenance/periodPruning</pre><p>Zero data value removal will delete zero data values linked to data elements where zero
      data is defined as not significant:</p><pre class="screen">/api/maintenance/zeroDataValueRemoval</pre><p>Drop SQL views will drop all SQL views in the database. Note that it will not delete the
      DHIS 2 SQL views.</p><pre class="screen">/api/maintenance/sqlViewsDrop</pre><p>Create SQL views will recreate all SQL views in the database.</p><pre class="screen">/api/maintenance/sqlViewsCreate</pre><p>Category option combo update will remove obsolete and generate missing category option
      combos for all category combinations:</p><pre class="screen">/api/maintenance/categoryOptionComboUpdate</pre><p>Cache clearing will clear the application Hibernate cache and the analytics partition
      caches:</p><pre class="screen">/api/maintenance/cacheClear</pre><p>Re-generate organisation unit path property (can be useful if you imported org units with
      SQL):</p><pre class="screen">/api/maintenance/ouPathsUpdate</pre><p>Data pruning will remove complete data set registrations, data approvals, data value
      audits and data values, in this case for an organisation unit.</p><pre class="screen">/api/maintenance/dataPruning/organisationUnits/&lt;org-unit-id&gt;</pre><p>Metadata validation will apply all metadata validation rules and return the result of the
      operation:</p><pre class="screen">/api/metadataValidation</pre><p>Maintenance operations are supported in a batch style with a POST request to the
      api/maintenance resource where the operations are supplied as query parameters:</p><pre class="screen">/api/maintenance?analyticsTablesClear=true&amp;expiredInvitationsClear=true&amp;periodPruning=true&amp;zeroDataValueRemoval=true
&amp;sqlViewsDrop=true&amp;sqlViewsCreate=true&amp;categoryOptionComboUpdate=true&amp;cacheClear=true&amp;ouPathsUpdate=true</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e9196"></a>1.39.&nbsp;System resource</h2></div></div></div><p>The system resource provides you with convenient information and functions. The system
      resource can be found at <span class="italic">/api/system</span>. </p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e9204"></a>1.39.1.&nbsp;Generate identifiers</h3></div></div></div><p>To generate valid, random DHIS 2 identifiers you can do a GET request to this
        resource:</p><pre class="screen">api/system/id?limit=3</pre><p>The <span class="italic">limit</span> query parameter is optional and indicates
        how many identifiers you want to be returned with the response. The default is to return one
        identifier. The response will contain a JSON object with a array named codes, similar to
        this:</p><pre class="screen">{
  "codes": [
    "Y0moqFplrX4",
    "WI0VHXuWQuV",
    "BRJNBBpu4ki"
  ]
}</pre><p>The DHIS 2 UID format has these requirements:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>11 characters long.</p></li><li class="listitem"><p>Alphanumeric characters only, ie. alphabetic or numeric characters
            (A-Za-z0-9).</p></li><li class="listitem"><p>Start with an alphabetic character (A-Za-z).</p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e9230"></a>1.39.2.&nbsp;View system information</h3></div></div></div><p>To get information about the current system you can do a GET request to this URL:</p><pre class="screen">api/system/info</pre><p>JSON and JSONP response formats are supported. The system info response currently
        includes the below properties. Note that if the user who is requesting this resourec does
        not have full authority in the system then only the first seven properties will be included,
        as this information is security sensitive.</p><pre class="screen">{
    contextPath: "http://yourdomain.com",
    userAgent: "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 Chrome/29.0.1547.62 Safari/537.36",
    version: "2.13-SNAPSHOT",
    revision: "11852",
    buildTime: "2013-09-01T21:36:21.000+0000",
    serverDate: "2013-09-02T12:35:54.311+0000",
    environmentVariable: "DHIS2_HOME",
    javaVersion: "1.7.0_06",
    javaVendor: "Oracle Corporation",
    javaIoTmpDir: "/tmp",
    javaOpts: "-Xms600m -Xmx1500m -XX:PermSize=400m -XX:MaxPermSize=500m",
    osName: "Linux",
    osArchitecture: "amd64",
    osVersion: "3.2.0-52-generic",
    externalDirectory: "/home/dhis/config/dhis2",
    databaseInfo: {
        type: "PostgreSQL",
        name: "dhis2",
        user: "dhis",
        spatialSupport: false
    },
    memoryInfo: "Mem Total in JVM: 848 Free in JVM: 581 Max Limit: 1333",
    cpuCores: 8
}</pre><p>To get information about the system context (<span class="italic">contextPath</span> and <span class="italic">userAgent</span>) only you can do
        a GET request to the below URL. JSON and JSONP response formats are supported:
        </p><pre class="screen">api/system/context</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e9251"></a>1.39.3.&nbsp;Check if username and password combination is correct</h3></div></div></div><p>To check if some user credentials (a username and password combination) is correct you
        can make a <span class="italic">GET</span> request to the following resource using
          <span class="italic">basic authentication</span>:</p><pre class="screen">api/system/ping</pre><p>You can detect the outcome of the authentication by inspecting the <span class="italic">HTTP status code</span> of the response header. The meaning of the
        possible status codes are listed below. Note that this applies to Web API requests in
        general.</p><div class="table"><a name="d6099e9269"></a><p class="title"><b>Table&nbsp;1.69.&nbsp;HTTP Status codes</b></p><div class="table-contents"><table class="table" summary="HTTP Status codes" border="1"><colgroup><col class="c1"><col class="c2"><col class="newCol3"></colgroup><thead><tr><th>HTTP Status code</th><th>Description</th><th>Outcome</th></tr></thead><tbody><tr><td>200</td><td>OK</td><td>Authentication was successful</td></tr><tr><td>302</td><td>Found</td><td>No credentials was supplied with the request - no authentication took
                place</td></tr><tr><td>401</td><td>Unauthorized</td><td>The username and password combination was incorrect - authentication
                failed</td></tr></tbody></table></div></div><br class="table-break"></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e9306"></a>1.39.4.&nbsp;View asynchronous task status</h3></div></div></div><p>Several tasks which typically take a significant time to complete can be performed
        asynchronously. After initiating an async task you can poll the status through the <span class="italic">system/tasks</span> resource by suppling the task category of interest. </p><p>When polling for the task status you need to authenticate as the same user which
        initiated the task. The following task categories are supported.</p><p>
        </p><div class="table"><a name="d6099e9318"></a><p class="title"><b>Table&nbsp;1.70.&nbsp;Task categories</b></p><div class="table-contents"><table class="table" summary="Task categories" border="1"><colgroup><col class="c1"><col class="c2"></colgroup><thead><tr><th>Identifier</th><th>Description</th></tr></thead><tbody><tr><td>ANALYTICSTABLE_UPDATE</td><td>Generation of the analytics tables.</td></tr><tr><td>RESOURCETABLE_UPDATE</td><td>Generation of the resource tables.</td></tr><tr><td>MONITORING</td><td>Processing of data surveillance/monitoring validation rules.</td></tr><tr><td>DATAVALUE_IMPORT</td><td>Import of data values.</td></tr><tr><td>EVENT_IMPORT</td><td>Import of events.</td></tr><tr><td>METADATA_IMPORT</td><td>Import of metadata.</td></tr><tr><td>DATAINTEGRITY</td><td>Processing of data integrity checks.</td></tr></tbody></table></div></div><p><br class="table-break">
      </p><p>You can poll tasks through a GET request to the system tasks
        resource:</p><pre class="screen">api/system/tasks/{task-category-id}</pre><p>A request to poll for the status of a data value import task looks like
        this:</p><pre class="screen">api/system/tasks/DATAVALUE_IMPORT</pre><p>The response will provide information about the status, such as the notification level,
        category, time and status. The completed property indicates whether the process is
        considered to be
        complete.</p><pre class="screen">[
    {
        "uid": "hpiaeMy7wFX",
        "level": "INFO",
        "category": "DATAVALUE_IMPORT",
        "time": "2015-09-02T07:43:14.595+0000",
        "message": "Import done",
        "completed": true
    }
]</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e9379"></a>1.39.5.&nbsp;Get appearance information</h3></div></div></div><p>You can retrieve the available flag icons in JSON format with a GET
        request:</p><pre class="screen">/api/system/flags</pre><p>You can retrieve the available UI styles in JSON format with a GET
        request:</p><pre class="screen">/api/system/styles</pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e9390"></a>1.40.&nbsp;Locales</h2></div></div></div><p>DHIS 2 supports translations both for the user interface and for database content.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e9395"></a>1.40.1.&nbsp;UI locales</h3></div></div></div><p>You can retrieve the available locales for the user interface through the following
        resource with a GET request. XML and JSON resource representations are
        supported.</p><pre class="screen">/api/locales/ui</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e9402"></a>1.40.2.&nbsp;Database content locales</h3></div></div></div><p>You can retrieve and create locales for database content with GET and POST requests
        through the following resource. XML and JSON resource representations are
        supported.</p><pre class="screen">/api/locales/db</pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e9409"></a>1.41.&nbsp;Translations</h2></div></div></div><p>DHIS 2 allows for translations of database content. You can work with translations through
      the Web API using the <span class="italic">translations</span> resource.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e9417"></a>1.41.1.&nbsp;Create translation</h3></div></div></div><p>You can create a translation with a POST request in JSON
        format:</p><pre class="screen">{
  "objectId": "P3jJH5Tu5VC",
  "className": "DataElement",
  "locale": "es",
  "property": "name",
  "value": "Casos de fiebre amarilla"
}</pre><pre class="screen">POST /api/translations</pre><p>The properties which support translations are listed in the table below.</p><div class="table"><a name="d6099e9428"></a><p class="title"><b>Table&nbsp;1.71.&nbsp;Property names</b></p><div class="table-contents"><table class="table" summary="Property names" border="1"><colgroup><col class="c1"><col class="c2"></colgroup><thead><tr><th>Property name</th><th>Description</th></tr></thead><tbody><tr><td>name</td><td>Object name</td></tr><tr><td>shortName</td><td>Object short name</td></tr><tr><td>description</td><td>Object description</td></tr></tbody></table></div></div><br class="table-break"><p>The classes which support translations are listed in the table below.</p><div class="table"><a name="d6099e9458"></a><p class="title"><b>Table&nbsp;1.72.&nbsp;Class names</b></p><div class="table-contents"><table class="table" summary="Class names" border="1"><colgroup><col class="c1"><col class="c2"></colgroup><thead><tr><th>Class name</th><th>Description</th></tr></thead><tbody><tr><td>DataElementCategoryOption</td><td>Category option</td></tr><tr><td>DataElementCategory</td><td>Category</td></tr><tr><td>DataElementCategoryCombo</td><td>Category combination</td></tr><tr><td>DataElement</td><td>Data element</td></tr><tr><td>DataElementGroup</td><td>Data element group</td></tr><tr><td>DataElementGroupSet</td><td>Data element group set</td></tr><tr><td>Indicator</td><td>Indicator</td></tr><tr><td>IndicatorType</td><td>Indicator type</td></tr><tr><td>IndicatorGroup</td><td>Indicator group</td></tr><tr><td>IndicatorGroupSet</td><td>Indicator group set</td></tr><tr><td>OrganisationUnit</td><td>Organisation unit</td></tr><tr><td>OrganisationUnitGroup</td><td>Organisation unit group</td></tr><tr><td>OrganisationUnitGroupSet</td><td>Organisation unit group set</td></tr><tr><td>DataSet</td><td>Data set</td></tr><tr><td>Section</td><td>Data set section</td></tr><tr><td>ValidationRule</td><td>Validation rule</td></tr><tr><td>ValidationRuleGroup</td><td>Validation rule group</td></tr><tr><td>Program</td><td>Program</td></tr><tr><td>ProgramStage</td><td>Program stage</td></tr><tr><td>TrackedEntityAttribute</td><td>Tracked entity attribute</td></tr><tr><td>TrackedEntityAttributeGroup</td><td>Tracked entity attribute group</td></tr><tr><td>TrackedEntity</td><td>Tracked entity</td></tr><tr><td>RelationshipType</td><td>Relationship type for tracked entity instances</td></tr><tr><td>OptionSet</td><td>Option set</td></tr><tr><td>Attribute</td><td>Attribute for metadata</td></tr></tbody></table></div></div><br class="table-break"></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e9596"></a>1.41.2.&nbsp;Get translations</h3></div></div></div><p>You can browse all translations through the translations
        resource:</p><pre class="screen">GET /api/translations</pre><p>You can use the standard filtering technique to fetch translations of interest. E.g. to
        get all translations for data elements in the Spanish locale you can use this
        request:</p><pre class="screen">/api/translations.json?fields=*&amp;filter=className:eq:DataElement&amp;filter=locale:eq:es</pre><p>To get translations for a specific object for all
        properties:</p><pre class="screen">/api/translations.json?fields=*&amp;filter=className:eq:DataElement&amp;filter=locale:eq:fr&amp;filter=objectId:eq:fbfJHSPpUQD</pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e9611"></a>1.42.&nbsp;Short Message Service (SMS)</h2></div></div></div><p>This section covers the SMS Web API for sending and receiving short text messages.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e9616"></a>1.42.1.&nbsp;Outbound SMS service</h3></div></div></div><p>The Web API supports sending outgoing SMS using the POST method. SMS can be sent to a
        single or multiple destinations. One or more gateways need to be configured before using the
        service. An SMS will not be sent if there is no gateway configured.&#8232; It needs a set of
        recipients and message text in JSON format as shown below. </p><pre class="screen">/api/sms/outbound</pre><pre class="screen">{&#8232;
  "message":"Sms Text",&#8232; 
  "recipients": [
    "47XXXXXX1",
    "47XXXXXX2"
  ]&#8232;
}</pre><pre class="screen">/api/sms/outbound/batch</pre><pre class="screen">{&#8232;
  "smsBatch":[{
  "message":"Sms Text",&#8232; 
  "recipients": [
  "47XXXXXX1"
  ]
  },
  {
  "message":"Sms Text2",&#8232; 
  "recipients": [
  "47XXXXXX1"
  ]
  }]&#8232;
}</pre><p>The Web API also supports a query parameter version, but the parameterized API can only
        be used for sending SMS to a single destination. </p><pre class="screen">/api/sms/outbound?message=text&amp;recipient=47XXXXXX</pre><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="d6099e9633"></a>1.42.1.1.&nbsp;Gateway response codes</h4></div></div></div><p>Gateway may response with following response codes.</p><div class="table"><a name="d6099e9638"></a><p class="title"><b>Table&nbsp;1.73.&nbsp;Gateway response codes</b></p><div class="table-contents"><table class="table" summary="Gateway response codes" border="1"><colgroup><col class="c1"><col class="newCol2"><col class="c2"></colgroup><thead><tr><th>Response code</th><th>Response Message</th><th>Detail Description</th></tr></thead><tbody><tr><td>RESULT_CODE_0</td><td>success</td><td>Message has been sent successfully</td></tr><tr><td>RESULT_CODE_1</td><td>scheduled</td><td>Message has been scheduled successfully</td></tr><tr><td>RESULT_CODE_22</td><td>internal fatal error</td><td>Internal fatal error</td></tr><tr><td>RESULT_CODE_23</td><td>authentication failure</td><td>Authentication credentials are incorrect</td></tr><tr><td>RESULT_CODE_24</td><td>data validation failed</td><td>Parameters provided in request are incorrect</td></tr><tr><td>RESULT_CODE_25</td><td>insufficient credits</td><td>Credit is not enough to send message</td></tr><tr><td>RESULT_CODE_26</td><td>upstream credits not available</td><td>Upstream credits not available</td></tr><tr><td>RESULT_CODE_27</td><td>exceeded your daily quota</td><td>You have exceeded your daily quota</td></tr><tr><td>RESULT_CODE_40</td><td>temporarily unavailable</td><td>Service is temporarily down</td></tr><tr><td>RESULT_CODE_201</td><td>maximum batch size exceeded</td><td>Maximum batch size exceeded</td></tr><tr><td>RESULT_CODE_200</td><td>success</td><td>The request was successfully completed</td></tr><tr><td>RESULT_CODE_202</td><td>accepted</td><td>The message(s) will be processed</td></tr><tr><td>RESULT_CODE_207</td><td>multi-status</td><td>More than  one message was submitted to the API; however, not all messages have the same status</td></tr><tr><td>RESULT_CODE_400</td><td>bad request</td><td>Validation failure (such as missing/invalid parameters or headers)</td></tr><tr><td>RESULT_CODE_401</td><td>unauthorized</td><td>Authentication failure. This can also be caused by IP lockdown settings</td></tr><tr><td>RESULT_CODE_402</td><td>payment required</td><td>Not enough credit to send message</td></tr><tr><td>RESULT_CODE_404</td><td>not found</td><td>Resource does not exist</td></tr><tr><td>RESULT_CODE_405</td><td>method not allowed</td><td>Http method is not support on the resource</td></tr><tr><td>RESULT_CODE_410</td><td>gone</td><td>Mobile number is blocked</td></tr><tr><td>RESULT_CODE_429</td><td>too many requests</td><td>Generic rate limiting error</td></tr><tr><td>RESULT_CODE_503</td><td>service unavailable</td><td>A temporary error has occurred on our platform - please retry</td></tr></tbody></table></div></div><br class="table-break"></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e9801"></a>1.42.2.&nbsp;Inbound SMS service</h3></div></div></div><p>The Web API supports collecting incoming sms using the POST method. Incoming messages
        routed towards the DHIS 2 Web API can be received using this api. The API collects inbound
        SMSs and provides it to&#8232; listeners for parsing, based on the SMS content (SMS Command). An
        example payload in JSON format is given below. Text, originator, received date and sent date
        are mandatory parameters. The rest are optional but the system will use the default value
        for these parameters.</p><pre class="screen">/api/sms/inbound</pre><pre class="screen">{
  "text": "sample text",
  "originator": "47XXXXXXXX",
  "gatewayid": "unknown",
  "receiveddate": "2016-05-01",
  "sentdate":"2016-05-01",
  "smsencoding": "1",
  "smsstatus":"1"          
}</pre><p>The Web API also supports a query parameter-based version.</p><pre class="screen">/api/sms/inbound?message=text&amp;originator=47XXXXXX&amp;gateway=clickatel</pre><div class="table"><a name="d6099e9814"></a><p class="title"><b>Table&nbsp;1.74.&nbsp;User query parameters</b></p><div class="table-contents"><table class="table" summary="User query parameters" border="1"><colgroup><col class="c1"><col class="newCol2"><col class="c2"></colgroup><thead><tr><th>Parameter</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>message</td><td>String</td><td>This is mandatory parameter which carries the actual text message.</td></tr><tr><td>originator</td><td>String</td><td>This is mandatory parameter which shows by whom this message was actually sent
                from.</td></tr><tr><td>gateway</td><td>String</td><td>This is an optional parameter which gives gateway id. If not present default
                text "UNKNOWN" will be stored</td></tr><tr><td>receiveTime</td><td>Date</td><td>This is an optional parameter. It is timestamp at which message was received at
                the gateway.</td></tr></tbody></table></div></div><br class="table-break"></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e9858"></a>1.42.3.&nbsp;Gateway service administration</h3></div></div></div><p>The Web API exposes resources which provide a way to configure and update SMS gateway
        configurations.</p><p>The list of different gateways configured can be retrieved using a GET method.</p><pre class="screen">GET /api/sms/gateways</pre><p>Configurations can also be retrieved for a specific gateway type using GET
        method.</p><pre class="screen">GET /api/sms/gateways/{uid}</pre><p>Configurations can be removed for specific gateway type using DELETE method.</p><pre class="screen">DELETE /api/sms/gateways/{uid}</pre><p>Default gateway can be retrieved with the GET method.</p><pre class="screen">GET /api/sms/gateways/default</pre><p>Default gateway can be set using the PUT method.</p><pre class="screen">PUT /api/sms/gateways/default/{uid}</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e9883"></a>1.42.4.&nbsp;Gateway configuration</h3></div></div></div><p>The Web API lets you create and update gateway configurations. For each type of gateway
        there are different parameters in the JSON payload. Sample JSON payloads for each gateway
        are given below. POST is used to create and PUT to update configurations. </p><p><span class="italic">Clickatell</span></p><pre class="screen">{
  "name" : "clickatell",
  "username": "clickatelluser",
  "password": "abc123",
  "Auth-token": "XXXXXXXXXXXXXXXXXXXX",
  "apiid": "12121"
}</pre><p><span class="italic">Bulksms</span></p><pre class="screen">{ 
  "name": "bulkSMS",
  "username": "bulkuser",
  "password": "abc123",
   "urlTemplate": "http://bulksms.vsms.net/",
  "region": "Spain"
}</pre><p><span class="italic">GenericHttp</span></p><pre class="screen">{
  "name" : "generic",
  "username": "genericUser",
  "password": "abc123",
  "urlTemplate": "http://localhost:template",
  "parameters": {
  "parameter1": "value1",
  "parameter2": "value2"
  }
}</pre><p><span class="italic">SMPP</span></p><pre class="screen">{
  "name" : "smpp",
  "username": "smppUser",
  "password": "abc123",
  "address" : "sample.smpp.com",
  "port" : "8143"
}</pre><p>The various gateway configurations can be instantiated using the endpoints listed
        below.</p><div class="table"><a name="d6099e9910"></a><p class="title"><b>Table&nbsp;1.75.&nbsp;Gateway api end points</b></p><div class="table-contents"><table class="table" summary="Gateway api end points" border="1"><colgroup><col class="c1"><col class="newCol2"><col class="c2"></colgroup><thead><tr><th>Gatway Type</th><th>Method</th><th>API End Points</th></tr></thead><tbody><tr><td>Clickatell</td><td>POST/PUT</td><td>/api/sms/gateways/clickatell</td></tr><tr><td>Bulksms</td><td>POST/PUT</td><td>/api/sms/gateways/bulksms</td></tr><tr><td>Generichttp</td><td>POST/PUT</td><td>/api/sms/gateways/generichttp</td></tr><tr><td>SMPP</td><td>POST/PUT</td><td>/api/sms/gateways/smpp</td></tr></tbody></table></div></div><br class="table-break"></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e9954"></a>1.43.&nbsp;Users</h2></div></div></div><p>This section covers the user resource methods.</p><pre class="screen">/api/users</pre><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e9961"></a>1.43.1.&nbsp;User query</h3></div></div></div><p>The <span class="italic">users</span> resource offers additional query parameters
        beyond the standard parameters (e.g. paging). To query for users at the users resource you
        can use the following parameters.</p><p>
        </p><div class="table"><a name="d6099e9971"></a><p class="title"><b>Table&nbsp;1.76.&nbsp;User query parameters</b></p><div class="table-contents"><table class="table" summary="User query parameters" border="1"><colgroup><col class="c1"><col class="newCol2"><col class="c2"></colgroup><thead><tr><th>Parameter</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>query</td><td>Text</td><td>Query value for first name, surname, username and email, case
                  in-sensitive.</td></tr><tr><td>phoneNumber</td><td>Text</td><td>Query for phone number.</td></tr><tr><td>canManage</td><td>false | true</td><td>Filter on whether the current user can manage the returned users through the
                  managed user group relationships.</td></tr><tr><td>authSubset</td><td>false | true</td><td>Filter on whether the returned users have a subset of the authorities of the
                  current user.</td></tr><tr><td>lastLogin</td><td>Date</td><td>Filter on users who have logged in later than the given date.</td></tr><tr><td>inactiveMonths</td><td>Number</td><td>Filter on users who have not logged in for the given number of
                  months.</td></tr><tr><td>inactiveSince</td><td>Date</td><td>Filter on users who have not logged in later than the given date.</td></tr><tr><td>selfRegistered</td><td>false | true</td><td>Filter on users who have self-registered their user account.</td></tr><tr><td>invitationStatus</td><td>none | all | expired</td><td>Filter on user invitations, including all or expired invitations.</td></tr><tr><td>ou</td><td>Identifier</td><td>Filter on users who are associated with the organisation unit with the given
                  identifier.</td></tr><tr><td>page</td><td>Number</td><td>The page number.</td></tr><tr><td>pageSize</td><td>Number</td><td>The page size.</td></tr></tbody></table></div></div><p><br class="table-break">
      </p><p>A query for max 10 users with "konan" as first name or surname (case
        in-sensitive) who have a subset of authorities compared to the current user:</p><pre class="screen">/api/users?query=konan&amp;authSubset=true&amp;pageSize=10</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e10076"></a>1.43.2.&nbsp;UserCredentials query</h3></div></div></div><p>An alternative to the previous user query, is to directly query the user credentials
        (the part where username, etc resides) using <span class="italic">/api/userCredentials</span> endpoint, it supports all regular field and object
        filters as the other endpoints.</p><p>Get user credentials where username is
        admin:</p><pre class="screen">/api/userCredentials?filter=username:eq:admin</pre><p>Get username  and code from all user credentials where username starts with <span class="italic">adm</span>:</p><pre class="screen">/api/userCredentials?fields=username,code&amp;filter=username:^like:adm</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e10095"></a>1.43.3.&nbsp;User account create and update</h3></div></div></div><p>Both creating and updating a user is supported through the web-api. The payload itself
        is similar to other payloads in the web-api, so they support collection references etc. A
        simple example payload to create would be, the password should be sent in plain text
        (remember to only use this on a SSL enabled server) and will be encrypted on the
        backend:</p><pre class="screen">{
  "firstName": "John",
  "surname": "Doe",
  "email": "johndoe@mail.com",
  "userCredentials": {
    "username": "johndoe",
    "password: "your-password-123",
    "userRoles": [ {
      "id": "Euq3XfEIEbx"
    } ]
  },
  "organisationUnits": [ {
    "id": "ImspTQPwCqd"
  } ],
  "userGroups": [ {
    "id": "vAvEltyXGbD"
  } ]
}</pre><pre class="screen">curl -X POST -u user:pass -d @u.json -H "Content-Type: application/json" http://server/api/users</pre><p>After the user is created, a <span class="italic">Location</span> header is sent
        back with the newly generated ID (you can also provide your own using /api/system/id
        endpoint). The same payload can then be used to do updates, but remember to then use
          <span class="bold"><strong>PUT</strong></span> instead of <span class="bold"><strong>POST</strong></span> and
        the endpoint is now <span class="italic">/api/users/ID</span>.</p><pre class="screen">curl -X PUT -u user:pass -d @u.json -H "Content-Type: application/json" http://server/api/users/ID</pre><p>For more info about the full payload available, please see <span class="italic">/api/schemas/user</span></p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e10124"></a>1.43.4.&nbsp;User account invitations</h3></div></div></div><p>The Web API supports inviting people to create user accounts through the <span class="italic">invite</span> resource. To create an invitation you should POST a user
        in XML or JSON format to the invite resource. A specific username can be forced by defining
        the username in the posted entity. By omitting the username, the person will be able to
        specify it herself. The system will send out an invitation through email. This requires that
        email settings have been properly configured. The invite resource is useful in order to
        securely allow people to create accounts without anyone else knowing the password or by
        transferring the password in plain text. The payload to use for the invite is the same as
        for creating users. An example payload in JSON looks like this:</p><pre class="screen">{
  "firstName": "John",
  "surname": "Doe",
  "email": "johndoe@mail.com",
  "userCredentials": {
    "username": "johndoe",
    "userRoles": [ {
      "id": "Euq3XfEIEbx"
    } ]
  },
  "organisationUnits": [ {
    "id": "ImspTQPwCqd"
  } ],
  "userGroups": [ {
    "id": "vAvEltyXGbD"
  } ]
}</pre><p>The user invite entity can be posted like this:</p><pre class="screen">curl -d @invite.json "localhost/api/users/invite" -H "Content-Type:application/json" -u admin:district -v</pre><p>To send out invites for multiple users at the same time you must use a slightly
        different format. For
        JSON:</p><pre class="screen">{
  "users": [ {
    "firstName": "John",
    "surname": "Doe",
    "email": "johndoe@mail.com",
    "userCredentials": {
      "username": "johndoe",
      "userRoles": [ {
        "id": "Euq3XfEIEbx"
      } ]
    },
    "organisationUnits": [ {
      "id": "ImspTQPwCqd"
      } ]
    }, {
    "firstName": "Tom",
    "surname": "Johnson",
    "email": "tomj@mail.com",
    "userCredentials": {
      "userRoles": [ {
        "id": "Euq3XfEIEbx"
      } ]
    },
    "organisationUnits": [ {
      "id": "ImspTQPwCqd"
      } ]
    }
  ]
}</pre><p>To create multiple invites you can post the payload to the api/users/invites resource
        like this:</p><pre class="screen">curl -d @invites.json "localhost/api/users/invites" -H "Content-Type:application/json" -u admin:district -v</pre><p>There are certain requirements for user account invitations to be sent out:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Email SMTP server must be configured properly on the server.</p></li><li class="listitem"><p>The user to be invited must have specified a valid email.</p></li><li class="listitem"><p>The user to be invited must not be granted user roles with critical authorities
              (see below).</p></li><li class="listitem"><p>If username is specified it must not be already taken by another existing
              user.</p></li></ul></div><p>If any of these requirements are not met the invite resource will return with
        a <span class="italic">409 Conflict</span> status code together with a descriptive
        message. </p><p>The critical authorities which cannot be granted with invites include:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>ALL</p></li><li class="listitem"><p>Scheduling administration</p></li><li class="listitem"><p>Set system settings</p></li><li class="listitem"><p>Add, update, delete and list user roles</p></li><li class="listitem"><p>Add, update, delete and view SQL views</p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e10183"></a>1.43.5.&nbsp;User replication</h3></div></div></div><p>To replicate a user you can use the <span class="italic">replica</span> resource.
        Replicating a user can be useful when debugging or reproducing issues reported by a
        particular user. You need to provide a new username and password for the replicated user
        which you will use to authenticate later. Note that you need the ALL authority to perform
        this action. To replicate a user you can post a JSON payload looking like below:</p><pre class="screen">{
  "username": "replica",
  "password": "Replica.1234"
}</pre><p>This payload can be posted to the replica resource, where you provide the identifier of
        the user to replicate in the URL:</p><pre class="screen">/api/users/&lt;uid&gt;/replica</pre><p>An example of replicating a user using curl looks like this:</p><pre class="screen">curl -d @replica.json "localhost/api/users/N3PZBUlN8vq/replica" 
-H "Content-Type:application/json" -u admin:district -v</pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e10201"></a>1.44.&nbsp;Current user information and associations</h2></div></div></div><p>In order to get information about the currently authenticated user and its associations to
      other resources you can work with the <span class="italic">me</span> resource (you can
      also refer to it by its old name <span class="italic">currentUser</span>). The current
      user related resources gives your information which is useful when building clients for
      instance for data entry and user management. The following describes these resources and their
      purpose.</p><p>Provides basic information about the user that you are currently logged in as, including
      username, user credentials, assigned organisation units:</p><pre class="screen">/api/me</pre><p>Gives information about currently unread messages and interpretations:</p><pre class="screen">/api/me/dashboard</pre><p>Lists all messages and interpretations in the inbox (including replies):</p><pre class="screen">/api/me/inbox</pre><p>Gives the full profile information for current user. This endpoint support both <span class="italic">GET</span> to retrieve profile and <span class="italic">POST</span>
      to update profile (the exact same format is used):</p><pre class="screen">/api/me/user-account</pre><p>Returns the set of authorities granted to the current user:</p><pre class="screen">/api/me/authorization</pre><p>Returns true or false, indicating whether the current user has been granted the given
      &lt;auth&gt; authorization:</p><pre class="screen">/api/me/authorization/&lt;auth&gt;</pre><p>Lists all organisation units directly assigned to the user:</p><pre class="screen">/api/me/organisationUnits</pre><p>Gives all the datasets assigned to the users organisation units, and their direct
      children. This endpoint contains all required information to build a form based on one of our
      datasets. If you want all descendants of your assigned organisation units, you can use the
      query parameter <span class="italic">includeDescendants=true</span> :</p><pre class="screen">/api/me/dataSets</pre><p>Gives all the programs assigned to the users organisation units, and their direct
      children. This endpoint contains all required information to build a form based on one of our
      datasets. If you want all descendants of your assigned organisation units, you can use the
      query parameter <span class="italic">includeDescendants=true</span> :</p><pre class="screen">/api/me/programs</pre><p>Gives the data approval levels which are relenvant to the current user:</p><pre class="screen">/api/me/dataApprovalLevels</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e10264"></a>1.45.&nbsp;System settings</h2></div></div></div><p>You can manipulate system settings by interacting with the <span class="italic">systemSettings</span> resource. A system setting is a simple key-value pair, where both
      the key and the value are plain text strings. To save or update a system setting you can make
      a <span class="italic">POST</span> request to the following URL:</p><pre class="screen">/api/systemSettings/my-key?value=my-val</pre><p>Alternatively, you can submit the setting value as the request body, where content type is
      set to "text/plain". As an example, you can use curl like this:</p><pre class="screen">curl "play.dhis2.org/demo/api/systemSettings/my-key" -d "My long value" 
-H "Content-Type: text/plain" -u admin:district -v</pre><p>To set system settings in bulk you can send a JSON object with a property and value for
      each system setting key-value pair using a POST request:</p><pre class="screen">{
  "keyApplicationNotification": "Welcome",
  "keyApplicationIntro": "DHIS 2",
  "keyApplicationFooter": "Read more at dhis2.org"
}  </pre><p>You should replace my-key with your real key and my-val with your real value. To retrieve
      the value for a given key in plain text you can make a <span class="italic">GET</span>
      request to the following URL:</p><pre class="screen">/api/systemSettings/my-key</pre><p>Alternatively, you can specify the key as a query parameter:</p><pre class="screen">/api/systemSettings?key=my-key</pre><p>You can retrieve specific system settings as JSON by repeating the key query
      parameter:</p><pre class="screen">curl "play.dhis2.org/demo/api/systemSettings?key=keyApplicationNotification&amp;key=keyApplicationIntro" 
-H "Content-Type: application/json" -u admin:district -v</pre><p>You can retrieve all system settings with a GET request:</p><pre class="screen">/api/systemSettings</pre><p>To delete a system setting, you can make a <span class="italic">DELETE</span>
      request to the URL similar to the one used above for retrieval.</p><p>The available system settings are listed below.</p><div class="table"><a name="d6099e10311"></a><p class="title"><b>Table&nbsp;1.77.&nbsp;System settings</b></p><div class="table-contents"><table class="table" summary="System settings" border="1"><colgroup><col class="c1"><col class="c3"></colgroup><thead><tr><th>Key</th><th>Description</th></tr></thead><tbody><tr><td>keyMessageEmailNotification</td><td>Send email notification for messages</td></tr><tr><td>keyMessageSmsNotification</td><td>Send sms notification for messages</td></tr><tr><td>keyUiLocale</td><td>Locale for the user interface</td></tr><tr><td>keyDbLocale</td><td>Locale for the database</td></tr><tr><td>keyAnalysisDisplayProperty</td><td>The property to display in analysis. Default: "name"</td></tr><tr><td>keyCurrentDomainType</td><td>Not yet in use.</td></tr><tr><td>keyAutoSaveCaseEntryForm</td><td>Autosave case entry forms</td></tr><tr><td>keyAutoSaveDataEntryForm</td><td>Autosave data entry forms</td></tr><tr><td>keyTrackerDashboardLayout</td><td>Used by tracker capture</td></tr><tr><td>keyAutoSavetTrackedEntityForm</td><td>Autosave tracked entity forms</td></tr><tr><td>applicationTitle</td><td>The application title. Default: "DHIS 2"</td></tr><tr><td>keyApplicationIntro</td><td>The application introduction</td></tr><tr><td>keyApplicationNotification</td><td>Application notification</td></tr><tr><td>keyApplicationFooter</td><td>Application left footer</td></tr><tr><td>keyApplicationRightFooter</td><td>Application right footer</td></tr><tr><td>keyFlag</td><td>Application flag</td></tr><tr><td>keyFlagImage</td><td>Flag used in dashboard menu</td></tr><tr><td>startModule</td><td>The startpage of the application. Default:
                "dhis-web-dashboard-integration"</td></tr><tr><td>factorDeviation</td><td>Data analysis standard deviation factor. Default: "2d"</td></tr><tr><td>keyEmailHostName</td><td>Email server hostname</td></tr><tr><td>keyEmailPort</td><td>Email server port</td></tr><tr><td>keyEmailTls</td><td>Use TLS. Default: "true"</td></tr><tr><td>keyEmailSender</td><td>Email sender</td></tr><tr><td>keyEmailUsername</td><td>Email server username</td></tr><tr><td>keyEmailPassword</td><td>Email server password</td></tr><tr><td>keyInstanceBaseUrl</td><td>The base url of the application instance</td></tr><tr><td>keySmsConfig</td><td>SMS configuration</td></tr><tr><td>keyCacheStrategy</td><td>Cache strategy. Default: "CACHE_6AM_TOMORROW"</td></tr><tr><td>phoneNumberAreaCode</td><td>Phonenumber area code</td></tr><tr><td>multiOrganisationUnitForms</td><td>Enable multi-organisation unit forms. Default: "false"</td></tr><tr><td>keyAccountRecovery</td><td>Enable user account recovery. Default: "false"</td></tr><tr><td>googleAnalyticsUA</td><td>Google Analytic UA key for tracking site-usage</td></tr><tr><td>credentialsExpires</td><td>Require user account password change. Default: "0" (Never)</td></tr><tr><td>keySelfRegistrationNoRecaptcha</td><td>Do not require recaptcha for self registration. Default: "false"</td></tr><tr><td>keyOpenIdProvider</td><td>OpenID provider</td></tr><tr><td>keyCanGrantOwnUserAuthorityGroups</td><td>Allow users to grant own user roles. Default: "false"</td></tr><tr><td>keyHideUnapprovedDataInAnalytics</td><td>Hide unapproved data in analytics. Default: "false"</td></tr><tr><td>keyAnalyticsMaxLimit</td><td>Maximum number of analytics recors. Default: "50000"</td></tr><tr><td>keyAnalyticsMaintenanceMode</td><td>Put analytics in maintenance mode. Default: "false"</td></tr><tr><td>keyDatabaseServerCpus</td><td>Number of database server CPUs. Default: "0" (Automatic)</td></tr><tr><td>helpPageLink</td><td>Link to help page. Default: "../dhis-web-commons-about/help.action"</td></tr><tr><td>keyAcceptanceRequiredForApproval</td><td>Acceptance required before approval. Default: "false"</td></tr><tr><td>keySystemNotificationsEmail</td><td>Where to email system notifications</td></tr><tr><td>keyAnalysisRelativePeriod</td><td>Default relative period for analysis. Default: "LAST_12_MONTHS"</td></tr><tr><td>keyRequireAddToView</td><td>Require authority to add to view object lists. Default: "false"</td></tr><tr><td>keyAllowObjectAssignment</td><td>Allow assigning object to related objects during add or update. Default:
                "false"</td></tr><tr><td>keyUseCustomLogoFront</td><td>Enables the usage of a custom logo on the frontpage. Default: "false"</td></tr><tr><td>keyUseCustomLogoBanner</td><td>Enables the usage of a custom banner on the website. Default: "false"</td></tr><tr><td>keyDataImportStrictPeriods</td><td>Require periods to match period type of data set. Default: "false"</td></tr><tr><td>keyDataImportStrictCategoryOptionCombos</td><td>Require category option combos to match category combo of data element.
                Default: "false"</td></tr><tr><td>keyDataImportStrictOrganisationUnits</td><td>Require organisation units to match assignment of data set. Default:
                "false"</td></tr><tr><td>keyDataImportStrictAttributeOptionsCombos</td><td>Require attribute option combis to match category combo of data set. Default:
                "false"</td></tr><tr><td>keyDataImportRequireCategoryOptionCombo</td><td>Require category option combo to be specified. Default: "false"</td></tr><tr><td>keyDataImportRequireAttributeOptionCombo</td><td>Require attribute option combo to be specified. Default: "false"</td></tr><tr><td>keyCustomJs</td><td>Custom JavaScript to be used on the website</td></tr><tr><td>keyCustomCss</td><td>Custom CSS to be used on the website</td></tr><tr><td>keyCalendar</td><td>The calendar type. Default: "iso8601".</td></tr><tr><td>keyDateFormat</td><td>The format in which dates should be displayed. Default: "yyyy-MM-dd".</td></tr><tr><td>appStoreUrl</td><td>The url used to point to the app store. Default:
                "https://www.dhis2.org/appstore"</td></tr><tr><td>keyStyle</td><td>The style used on the DHIS 2 webpages. Default:
                "light_blue/light_blue.css".</td></tr><tr><td>keyRemoteInstanceUrl</td><td>Url used to connect to remote instance</td></tr><tr><td>keyRemoteInstanceUsername</td><td>Username used to connect to remote instance</td></tr><tr><td>keyRemoteInstancePassword</td><td>Password used to connect to remote instance</td></tr></tbody></table></div></div><p><br class="table-break"></p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e10639"></a>1.46.&nbsp;User settings</h2></div></div></div><p>You can manipulate user settings by interacting with the <span class="italic">userSettings</span> resource. A user setting is a simple key-value pair, where both the
      key and the value are plain text strings. The user setting will be linked to the user who is
      authenticated for the Web API request. To return a list of all user settings, you can send a
        <span class="emphasis"><em>GET</em></span> request to the following URL:</p><p>
      </p><pre class="screen">/api/userSettings</pre><p>
    </p><p>User settings not set by the user, will fall back to the equvalent system setting. To only
      return the values set explicitly by the user, you can append ?useFallback=false to the above
      URL, like this:</p><pre class="screen">/api/userSettings?useFallback=false</pre><p> To save or update a setting for the currently authenticated user you can make a <span class="italic">POST</span> request to the following URL:</p><pre class="screen">/api/userSettings/my-key?value=my-val</pre><p>You can specify the user for which to save the setting explicitly with this syntax:</p><pre class="screen">/api/userSettings/my-key?user=username&amp;value=my-val</pre><p>Alternatively, you can submit the setting value as the request body, where content type is
      set to "text/plain". As an example, you can use curl like this:</p><pre class="screen">curl "https://play.dhis2.org/demo/api/userSettings/my-key" -d "My long value" 
-H "Content-Type: text/plain" -u admin:district -v</pre><p>As an example, to set the UI locale of the current user to French you can use the
      following command.</p><pre class="screen">curl "https://play.dhis2.org/demo/api/userSettings/keyUiLocale?value=fr" -X POST -u admin:district -v</pre><p>You should replace my-key with your real key and my-val with your real value. To retrieve
      the value for a given key in plain text you can make a <span class="italic">GET</span>
      request to the following URL:</p><pre class="screen">/api/userSettings/my-key</pre><p>To delete a user setting, you can make a <span class="italic">DELETE</span> request
      to the URL similar to the one used above for retrieval.</p><p>The available system settings are listed below.</p><div class="table"><a name="d6099e10692"></a><p class="title"><b>Table&nbsp;1.78.&nbsp;User settings</b></p><div class="table-contents"><table class="table" summary="User settings" border="1"><colgroup><col class="c1"><col class="newCol2"><col class="c2"></colgroup><thead><tr><th>Key</th><th>Options</th><th>Description</th></tr></thead><tbody><tr><td>keyStyle</td><td>light_blue/light_blue.css | green/green.css | vietnam/vietnam.css</td><td>User interface stylesheet.</td></tr><tr><td>keyMessageEmailNotification</td><td>false | true</td><td>Whether to send email notifications.</td></tr><tr><td>keyMessageSmsNotification</td><td>false | true</td><td>Whether to send SMS notifications.</td></tr><tr><td>keyUiLocale</td><td>Locale value</td><td>User interface locale.</td></tr><tr><td>keyDbLocale</td><td>Locale value</td><td>Database content locale.</td></tr><tr><td>keyAnalysisDisplayProperty</td><td>name | shortName</td><td>Property to display for metadata in analysis apps.</td></tr><tr><td>keyCurrentDomainType</td><td>all | aggregate | tracker</td><td>Data element domain type to display in lists.</td></tr><tr><td>keyAutoSaveCaseEntryForm</td><td>false | true</td><td>Save case entry forms periodically.</td></tr><tr><td>keyAutoSaveTrackedEntityForm</td><td>false | true</td><td>Save person registration forms periodically.</td></tr><tr><td>keyAutoSaveDataEntryForm</td><td>false | true</td><td>Save aggregate data entry forms periodically.</td></tr><tr><td>keyTrackerDashboardLayout</td><td>false | true</td><td>Tracker dasboard layout.</td></tr></tbody></table></div></div><p><br class="table-break"></p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e10785"></a>1.47.&nbsp;Organisation units</h2></div></div></div><p>The <span class="emphasis"><em>organisationUnits</em></span> resource follows the standard conventions as
      other metadata resources in DHIS 2. This resource supports some additional query
      parameters.</p><pre class="screen">/api/organisationUnits</pre><div class="table"><a name="d6099e10795"></a><p class="title"><b>Table&nbsp;1.79.&nbsp;Organisation units query parameters</b></p><div class="table-contents"><table class="table" summary="Organisation units query parameters" border="1"><colgroup><col class="c1"><col class="c2"></colgroup><thead><tr><th>Query parameter</th><th>Description</th></tr></thead><tbody><tr><td>userOnly</td><td>Data capture organisation units associated with current user only.</td></tr><tr><td>userDataViewOnly</td><td>Data view organisation units associated with current user only.</td></tr><tr><td>userDataViewFallback</td><td>Data view organisation units associated with current user only with fallback to
              data capture organisation units.</td></tr><tr><td>level</td><td>Organisation units at the given level in the hierarchy.</td></tr><tr><td>maxLevel</td><td>Organisation units at the given max level or levels higher up in the
              hierarchy.</td></tr></tbody></table></div></div><br class="table-break"></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e10833"></a>1.48.&nbsp;Filled organisation unit levels</h2></div></div></div><p>The <span class="emphasis"><em>filledOrganisationUnitLevels</em></span> resource provides an ordered list of
      organisation unit levels, where generated levels are injected into the list to fill positions
      for which it does not exist a persisted level.</p><p>
      </p><pre class="screen">GET /api/filledOrganisationUnitLevels</pre><p>
    </p><p>To set the organisation unit levels you can issue a POST request with a JSON payload
      looking like
      this.</p><pre class="screen">{
  "organisationUnitLevels": [{
    "name": "National",
    "level": 1,
    "offlineLevels": 3
  }, {
    "name": "District",
    "level": 2
  }, {
    "name": "Chiefdom",
    "level": 3
  }, {
    "name": "Facility",
    "level": 4
  }]
}</pre><p>To do functional testing with curl you can issue the following command.
      </p><pre class="screen">curl "http://localhost/api/filledOrganisationUnitLevels" -H "Content-Type:application/json"
-d @levels.json -u admin:district -v</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e10854"></a>1.49.&nbsp;Static content</h2></div></div></div><p>The <span class="emphasis"><em>staticContent</em></span> resource allowes you to upload and retrieve custom
      logos used in DHIS2. The resource lets the user upload a file with an associated key, which
      can later be retrieved using the key. Only PNG files are supported and can only be uploaded to
      the "logo_banner" and "logo_front"
      keys.</p><pre class="screen">/api/staticContent</pre><div class="table"><a name="d6099e10864"></a><p class="title"><b>Table&nbsp;1.80.&nbsp;Static content keys</b></p><div class="table-contents"><table class="table" summary="Static content keys" border="1"><colgroup><col class="c1"><col class="c2"></colgroup><thead><tr><th>Key</th><th>Description</th></tr></thead><tbody><tr><td>logo_banner</td><td>Logo in the application top menu on the left side.</td></tr><tr><td>logo_front</td><td>Logo on the login-page above the login form.</td></tr></tbody></table></div></div><br class="table-break"><p> To upload a file, send the file with a <span class="emphasis"><em>POST</em></span> request
      to:</p><pre class="screen">POST /api/staticContent/&lt;key&gt;</pre><p>Example request to upload logo.png to the logo_front
      key:</p><pre class="screen">curl -F "file=@logo.png;type=image/png" "https://play.dhis2.org/demo/api/staticContent/logo_front"
-X POST -H "Content-Type: multipart/form-data" -u admin:district -v</pre><p>Uploading multiple files with the same key will overwrite the existing file. This way,
      retrieving a file for any given key will only return the latest file uploaded.</p><p>To retrieve a logo, you can <span class="emphasis"><em>GET</em></span> the
      following:</p><pre class="screen">GET /api/staticContent/&lt;key&gt;</pre><p>Example request to retrieve the file stored for
      logo_front:</p><pre class="screen">curl "aps.dhis2.org/demo/api/staticContent/logo_front" -L -X GET -u admin:district -v</pre><p>To use custom logos, you need to enable the corresponding system settings by setting it to
        <span class="emphasis"><em>true</em></span>. If the corresponding setting is false, the default logo will be
      served.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e10916"></a>1.50.&nbsp;Configuration</h2></div></div></div><p>To access configuration you can interact with the <span class="italic">configuration</span> resource. You can get XML and JSON responses through the <span class="italic">Accept</span> header or by using the .json or .xml extensions. You can
        <span class="italic">GET</span> all properties of the configuration from:</p><pre class="screen">/api/configuration</pre><p>You can send <span class="italic">GET</span> and <span class="italic">POST</span> requests to the following specific resources:</p><pre class="screen">GET /api/configuration/systemId</pre><pre class="screen">GET POST DELETE /api/configuration/feedbackRecipients</pre><pre class="screen">GET POST DELETE /api/configuration/offlineOrganisationUnitLevel</pre><pre class="screen">GET POST /api/configuration/infrastructuralDataElements</pre><pre class="screen">GET POST /api/configuration/infrastructuralIndicators</pre><pre class="screen">GET POST /api/configuration/infrastructuralPeriodType</pre><pre class="screen">GET POST DELETE /api/configuration/selfRegistrationRole</pre><pre class="screen">GET POST DELETE /api/configuration/selfRegistrationOrgUnit</pre><p>For the CORS whitelist configuration you can make a POST request with an array of URLs to
      whitelist as payload using "application/json" as content-type, for instance:</p><pre class="screen">["www.google.com", "www.dhis2.org", "www.who.int"]</pre><pre class="screen">GET POST /api/configuration/corsWhitelist</pre><p>For POST requests, the configuration value should be sent as the request payload as text.
      The following table shows appropriate configuration values for each property.</p><div class="table"><a name="d6099e10964"></a><p class="title"><b>Table&nbsp;1.81.&nbsp;Configuration values</b></p><div class="table-contents"><table class="table" summary="Configuration values" border="1"><colgroup><col class="c1"><col class="c2"></colgroup><thead><tr><th>Configuration property</th><th>Value</th></tr></thead><tbody><tr><td>feedbackRecipients</td><td>User group ID</td></tr><tr><td>offlineOrganisationUnitLevel</td><td>Organisation unit level ID</td></tr><tr><td>infrastructuralDataElements</td><td>Data element group ID</td></tr><tr><td>infrastructuralIndicators</td><td>Indicator group ID</td></tr><tr><td>infrastructuralPeriodType</td><td>Period type name (e.g. "Monthly")</td></tr><tr><td>selfRegistrationRole</td><td>User role ID</td></tr><tr><td>selfRegistrationOrgUnit</td><td>Organisation unit ID</td></tr><tr><td>smtpPassword</td><td>SMTP email server password</td></tr><tr><td>remoteServerUrl</td><td>URL to remote server</td></tr><tr><td>remoteServerUsername</td><td>Username for remote server authentication</td></tr><tr><td>remoteServerPassword</td><td>Password for remote server authentication</td></tr><tr><td>corsWhitelist</td><td>JSON list of URLs</td></tr></tbody></table></div></div><br class="table-break"><p>As an example, to set the feedback recipients user group you can invoke the following curl
      command:</p><pre class="screen">curl "localhost/api/configuration/feedbackRecipients" -d "wl5cDMuUhmF" 
-H "Content-Type:text/plain"-u admin:district -v</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e11041"></a>1.51.&nbsp;Internationalization</h2></div></div></div><p>In order to retrieve key-value pairs for translated strings you can use the <span class="italic">i18n</span> resource.</p><pre class="screen">/api/i18n</pre><p> The endpoint is located at
        <span class="italic">api/i18n</span> and the request format is a simple array of the
      key-value pairs:</p><pre class="screen">[
  "access_denied",
  "uploading_data_notification"
]</pre><p>The request must be of type <span class="italic">POST</span> and use <span class="italic">application/json</span> as content-type. An example using curl, assuming
      the request data is saved as a file keys.json:</p><pre class="screen">curl -d @keys.json "play.dhis2.org/demo/api/i18n" -X POST 
-H "Content-Type: application/json" -u admin:district -v</pre><p>The result will look like this:</p><pre class="screen">{
  "access_denied":"Access denied",
  "uploading_data_notification":"Uploading locally stored data to the server"
}</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e11071"></a>1.52.&nbsp;SVG conversion</h2></div></div></div><p>The Web API provides a resource which can be used to convert SVG content into more widely
      used formats such as PNG and PDF. Ideally this conversion should happen on the client side,
      but not all client side technologies are capable of performing this task. Currently PNG and
      PDF output formats are supported. The SVG content itself should passed with a <span class="italic">svg</span> query parameter, and an optional query parameter <span class="italic">filename</span> can be used to specify the filename of the response
      attachment file. Note that the file extension should be omitted. For PNG you can send a
        <span class="italic">POST</span> request to the following URL with Content-type
        <span class="italic">application/x-www-form-urlencoded</span>, identical to a regular
      HTML form submission.</p><pre class="screen">api/svg.png</pre><p>For PDF you can send a <span class="italic">POST</span> request to the following
      URL with Content-type <span class="italic">application/x-www-form-urlencoded</span>.</p><pre class="screen">api/svg.pdf</pre><div class="table"><a name="d6099e11100"></a><p class="title"><b>Table&nbsp;1.82.&nbsp;Query parameters</b></p><div class="table-contents"><table class="table" summary="Query parameters" border="1"><colgroup><col class="c1"><col class="c2"><col class="c3"></colgroup><thead><tr><th>Query parameter</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>svg</td><td>Yes</td><td>The SVG content</td></tr><tr><td>filename</td><td>No</td><td>The file name for the returned attachment without file extension</td></tr></tbody></table></div></div><br class="table-break"></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e11130"></a>1.53.&nbsp;Tracked entity instance management</h2></div></div></div><p>Tracked entity instances have full CRUD (create, read, update, delete) support in the
      Web-API. Together with the API for enrollment most operations needed for working with tracked
      entity instances and programs are supported.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e11135"></a>1.53.1.&nbsp;Creating a new tracked entity instance</h3></div></div></div><p>For creating a new person in the system, you will be working with the <span class="italic">trackedEntityInstances</span> resource. A template payload can be seen
        below:</p><pre class="screen">{
    "trackedEntity": "tracked-entity-id",
    "orgUnit": "org-unit-id",
    "attributes": [ {
        "attribute": "attribute-id",
        "value": "attribute-value"
    } ]
}</pre><p>For getting the IDs for <span class="italic">relationship</span>, <span class="italic">attributes</span> you can have a look at the respective resources
          <span class="italic">relationshipTypes</span>,, <span class="italic">trackedEntityAttributes</span>. To create a tracked entity instance you must use the
        HTTP <span class="bold"><strong>POST</strong></span> method. You can post the payload the the
        following URL:</p><pre class="screen">/api/trackedEntityInstances</pre><p> For example, let us create a new instance of a person tracked entity and specify its
        first name and last name
        attributes:</p><pre class="screen">{
  "trackedEntity": "nEenWmSyUEp",
  "orgUnit": "DiszpKrYNg8",
  "attributes": [
    {
      "attribute": "w75KJ2mc4zz",
      "value": "Joe"
    },
    {
      "attribute": "zDhUuAYrxNC",
      "value": "Smith"
    }
  ]
}</pre><p>To push this to the server you can use the cURL command like
        this:</p><pre class="screen">curl -d @tei.json "https://play.dhis2.org/demo/api/trackedEntityInstances" -X POST 
-H "Content-Type: application/json" -u admin:district -v</pre><p>To create multiple instances in one request you can wrap the payload in an outer array
        like this and POST to the same resource as
        above:</p><pre class="screen">{
  "trackedEntityInstances": [
    {
      "trackedEntity": "nEenWmSyUEp",
      "orgUnit": "DiszpKrYNg8",
      "attributes": [
        {
          "attribute": "w75KJ2mc4zz",
          "value": "Joe"
        },
        {
          "attribute": "zDhUuAYrxNC",
          "value": "Smith"
        }
      ]
    },
    {
      "trackedEntity": "nEenWmSyUEp",
      "orgUnit": "DiszpKrYNg8",
      "attributes": [
        {
          "attribute": "w75KJ2mc4zz",
          "value": "Jennifer"
        },
        {
          "attribute": "zDhUuAYrxNC",
          "value": "Johnson"
        }
      ]
    }
  ]
}</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e11176"></a>1.53.2.&nbsp;Updating a tracked entity instance</h3></div></div></div><p>For updating a tracked entity instance, the payload is the equal to the previous
        section. The difference is that you must use the HTTP <span class="bold"><strong>PUT</strong></span>
        method for the request when sending the payload. You will also need to append the person
        identifier to the <span class="italic">trackedEntityInstances</span> resource in the
        URL like this, where &lt;tracked-entity-instance-identifier&gt; should be replaced by the
        identifier of the tracked entity instance:</p><pre class="screen">/api/trackedEntityInstances/&lt;tracked-entity-instance-id&gt;</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e11189"></a>1.53.3.&nbsp;Deleting a tracked entity instance</h3></div></div></div><p>To delete a tracked entity instance you can make a request to the URL identifiying the
        tracked entity instance with the HTTP <span class="bold"><strong>DELETE</strong></span> method. The
        URL is equal to the one above used for update.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e11197"></a>1.53.4.&nbsp;Enrolling a tracked entity instance into a program</h3></div></div></div><p>For enrolling persons into a program, you will need to first get the identifier of the
        person from the <span class="italic">trackedEntityInstances</span> resource. Then,
        you will need to get the program identifier from the <span class="italic">programs</span> resource. A template payload can be seen
        below:</p><pre class="screen">{
  "trackedEntityInstance": "ZRyCnJ1qUXS",
  "orgUnit": "ImspTQPwCqd",
  "program": "S8uo8AlvYMz",
  "enrollmentDate": "2013-09-17",
  "incidentDate": "2013-09-17"
}</pre><p>This payload should be used in a <span class="bold"><strong>POST</strong></span> request to the
        enrollments resource identified by the following URL:</p><pre class="screen">/api/enrollments</pre><p>For cancelling or completing an enrollment, you can make a <span class="bold"><strong>PUT</strong></span> request to the <span class="italic">enrollments</span> resource,
        including the identifier and the action you want to perform. For cancelling an enrollment
        for a tracked entity
        instance:</p><pre class="screen">/api/enrollments/&lt;enrollment-id&gt;/cancelled</pre><p>For completing a enrollment for a tracked entity instance you can make a <span class="bold"><strong>PUT</strong></span> request to the following
        URL:</p><pre class="screen">/api/enrollments/&lt;enrollment-id&gt;/completed</pre><p>For deleting a enrollment, you can make a <span class="bold"><strong>DELETE</strong></span>
        request to the following URL:</p><pre class="screen">/api/enrollments/&lt;enrollment-id&gt;</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e11241"></a>1.53.5.&nbsp;Update strategies</h3></div></div></div><p>Two update strategies for tracked entity instance are supported: enrollment and event
        creation. This is useful when you have generated an identifier on the client side and are
        not sure if it was created or not on the server.</p><div class="table"><a name="d6099e11246"></a><p class="title"><b>Table&nbsp;1.83.&nbsp;Available tracker strategies</b></p><div class="table-contents"><table class="table" summary="Available tracker strategies" border="1"><colgroup><col class="c1"><col class="c2"></colgroup><thead><tr><th>Parameter</th><th>Description</th></tr></thead><tbody><tr><td>CREATE</td><td>Create only, this is the default behavior.</td></tr><tr><td>CREATE_AND_UPDATE</td><td>Try and match the ID, if it exist then update, if not create.</td></tr></tbody></table></div></div><p><br class="table-break"></p><p>To change the parameter, please use the strategy
        parameter:</p><pre class="screen">POST /api/trackedEntityInstances?strategy=CREATE_AND_UPDATE</pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e11273"></a>1.54.&nbsp;Tracked entity instance query</h2></div></div></div><p>To query for tracked entity instances you can interact with the <span class="italic">/api/trackedEntityInstances</span>
      resource.</p><pre class="screen">api/trackedEntityInstances</pre><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e11283"></a>1.54.1.&nbsp;Request syntax</h3></div></div></div><div class="table"><a name="d6099e11286"></a><p class="title"><b>Table&nbsp;1.84.&nbsp;Tracked entity instances query parameters</b></p><div class="table-contents"><table class="table" summary="Tracked entity instances query parameters" border="1"><colgroup><col class="c1"><col class="c3"></colgroup><thead><tr><th>Query parameter</th><th>Description</th></tr></thead><tbody><tr><td>filter</td><td>Attributes to use as a filter for the query. Param can be repeated any number
                of times. Filters can be applied to a dimension on the format
                &lt;attribute-id&gt;:&lt;operator&gt;:&lt;filter&gt;[:&lt;operator&gt;:&lt;filter&gt;].
                Filter values are case-insensitive and can be repeated together with operator any
                number of times. Operators can be EQ | GT | GE | LT | LE | NE | LIKE | IN.</td></tr><tr><td>ou</td><td>Organisation unit idenfiers, separated by ";".</td></tr><tr><td>ouMode</td><td>The mode of selecting organisation units, can be SELECTED | CHILDREN |
                DESCENDANTS | ACCESSIBLE | ALL. Default is SELECTED, which refers to the selected
                organisation units only. See table below for explanations.</td></tr><tr><td>program</td><td>Program identifier. Restricts instances to being enrolled in the given
                program.</td></tr><tr><td>programStatus</td><td>Status of the instance for the given program. Can be ACTIVE | COMPLETED |
                CANCELLED.</td></tr><tr><td>followUp</td><td>Follow up status of the instance for the given program. Can be true | false or
                omitted.</td></tr><tr><td>programStartDate</td><td>Start date of enrollment in the given program for the tracked entity
                instance.</td></tr><tr><td>programEndDate</td><td>End date of enrollment in the given program for the tracked entity
                instance.</td></tr><tr><td>trackedEntity</td><td>Tracked entity identifer. Restricts instances to the given tracked instance
                type.</td></tr><tr><td>page</td><td>The page number. Default page is 1.</td></tr><tr><td>pageSize</td><td>The page size. Default size is 50 rows per page.</td></tr><tr><td>totalPages</td><td>Indicates whether to include the total number of pages in the paging response
                (implies higher response time).</td></tr><tr><td>skipPaging</td><td>Indicates whether paging should be ignored and all rows should be
                returned.</td></tr></tbody></table></div></div><br class="table-break"><p>The available organisation unit selection modes are explained in the following
        table.</p><div class="table"><a name="d6099e11366"></a><p class="title"><b>Table&nbsp;1.85.&nbsp;Organisation unit selection modes</b></p><div class="table-contents"><table class="table" summary="Organisation unit selection modes" border="1"><colgroup><col class="c1"><col class="c2"></colgroup><thead><tr><th>Mode</th><th>Description</th></tr></thead><tbody><tr><td>SELECTED</td><td>Organisation units defined in the request.</td></tr><tr><td>CHILDREN</td><td>Immediate children, i.e. only the first level below, of the organisation units
                defined in the request.</td></tr><tr><td>DESCENDANTS</td><td>All children, i.e. at only levels below, e.g. including children of children,
                of the organisation units defined in the request.</td></tr><tr><td>ACCESSIBLE</td><td>All descendants of the data view organisation units associated with the current
                user. Will fall back to data capture organisation units associated with the current
                user if the former is not defined.</td></tr><tr><td>ALL</td><td>All organisation units in the system. Requires authority.</td></tr></tbody></table></div></div><br class="table-break"><p>The query is case insensitive. The following rules apply to the query parameters.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>At least one organisation unit must be specified using the <span class="italic">ou</span> parameter (one or many), or <span class="italic">ouMode=ALL</span> must be specified.</p></li><li class="listitem"><p>Only one of the <span class="italic">program</span> and <span class="italic">trackedEntity</span> parameters can be specified (zero or
            one).</p></li><li class="listitem"><p>If <span class="italic">programStatus</span> is specified then <span class="italic">program</span> must also be specified.</p></li><li class="listitem"><p>If <span class="italic">followUp</span> is specified then <span class="italic">program</span> must also be specified.</p></li><li class="listitem"><p>If <span class="italic">programStartDate</span> or <span class="italic">programEndDate</span> is specified then <span class="italic">program</span> must also be specified.</p></li><li class="listitem"><p>Filter items can only be specified once.</p></li></ul></div><p>A query for all instances associated with a specific organisation unit can look like
        this:</p><pre class="screen">api/trackedEntityInstances.json?ou=DiszpKrYNg8</pre><p>To query for instances using one attribute with a filter and one attribute without a
        filter, with one organisation unit using the descendants organisation unit query
        mode:</p><pre class="screen">api/trackedEntityInstances.json?filter=zHXD5Ve1Efw:EQ:A&amp;filter=AMpUYgxuCaE&amp;ou=DiszpKrYNg8;yMCshbaVExv</pre><p>A query for instances where one attribute is included in the response and one attribute
        us used as a filter:</p><pre class="screen">api/trackedEntityInstances.json?filter=zHXD5Ve1Efw:EQ:A&amp;filter=AMpUYgxuCaE:LIKE:Road&amp;ou=DiszpKrYNg8</pre><p>A query where multiple operand and filters are specified for a filter item:</p><pre class="screen">api/trackedEntityInstances.json?ou=DiszpKrYNg8&amp;program=ur1Edk5Oe2n&amp;filter=lw1SqmMlnfh:GT:150:LT:190</pre><p>To query on an attribute using multiple values in an IN filter:</p><pre class="screen">api/trackedEntityInstances.json?ou=DiszpKrYNg8&amp;filter=dv3nChNSIxy:IN:Scott;Jimmy;Santiago</pre><p>To constrain the response to instances which are part of a specific program you can
        include a program query parameter:</p><pre class="screen">api/trackedEntityInstances.json?filter=zHXD5Ve1Efw:EQ:A&amp;ou=O6uvpzGd5pu
&amp;ouMode=DESCENDANTS&amp;program=ur1Edk5Oe2n</pre><p>To specify program enrollment dates as part of the query:</p><pre class="screen">api/trackedEntityInstances.json?filter=zHXD5Ve1Efw:EQ:A&amp;ou=O6uvpzGd5pu&amp;program=ur1Edk5Oe2n
&amp;programStartDate=2013-01-01&amp;programEndDate=2013-09-01</pre><p>To constrain the response to instances of a specific tracked entity you can include a
        tracked entity query parameter:</p><pre class="screen">api/trackedEntityInstances.json?filter=zHXD5Ve1Efw:EQ:A&amp;ou=O6uvpzGd5pu
&amp;ouMode=DESCENDANTS&amp;trackedEntity=cyl5vuJ5ETQ</pre><p>By default the instances are returned in pages of size 50, to change this you can use
        the page and pageSize query parameters:</p><pre class="screen">api/trackedEntityInstances.json?filter=zHXD5Ve1Efw:EQ:A&amp;ou=O6uvpzGd5pu
&amp;ouMode=DESCENDANTS&amp;page=2&amp;pageSize=3</pre><p>You can use a range of operators for the filtering:</p><div class="table"><a name="d6099e11496"></a><p class="title"><b>Table&nbsp;1.86.&nbsp;Filter operators</b></p><div class="table-contents"><table class="table" summary="Filter operators" border="1"><colgroup><col width="87.75pt" class="c1"><col width="368.25pt" class="c2"></colgroup><thead><tr><th>Operator</th><th>Description</th></tr></thead><tbody><tr><td>EQ</td><td>Equal to</td></tr><tr><td>GT</td><td>Greater than</td></tr><tr><td>GE</td><td>Greater than or equal to</td></tr><tr><td>LT</td><td>Less than</td></tr><tr><td>LE</td><td>Less than or equal to</td></tr><tr><td>NE</td><td>Not equal to</td></tr><tr><td>LIKE</td><td>Like (free text match)</td></tr><tr><td>IN</td><td>Equal to one of multiple values separated by ";"</td></tr></tbody></table></div></div><br class="table-break"></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e11549"></a>1.54.2.&nbsp;Response format</h3></div></div></div><p>This resource supports JSON, JSONP, XLS and CSV resource representations.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>json (application/json)</p></li><li class="listitem"><p>jsonp (application/javascript)</p></li><li class="listitem"><p>xml (application/xml)</p></li></ul></div><p>The response in JSON/XML is in object format and can look like the following (please
        note that field filtering is supported, so if you want a full view, you might want to add
        fields=*):</p><pre class="screen">{
    "trackedEntityInstances": [
        {
            "lastUpdated": "2014-03-28 12:27:52.399",
            "trackedEntity": "cyl5vuJ5ETQ",
            "created": "2014-03-26 15:40:19.997",
            "orgUnit": "ueuQlqb8ccl",
            "trackedEntityInstance": "tphfdyIiVL6",
            "relationships": [],
            "attributes": [
                {
                    "displayName": "Address",
                    "attribute": "AMpUYgxuCaE",
                    "type": "string",
                    "value": "2033 Akasia St"
                },
                {
                    "displayName": "TB number",
                    "attribute": "ruQQnf6rswq",
                    "type": "string",
                    "value": "1Z 989 408 56 9356 521 9"
                },
                {
                    "displayName": "Weight in kg",
                    "attribute": "OvY4VVhSDeJ",
                    "type": "number",
                    "value": "68.1"
                },
                {
                    "displayName": "Email",
                    "attribute": "NDXw0cluzSw",
                    "type": "string",
                    "value": "LiyaEfrem@armyspy.com"
                },
                {
                    "displayName": "Gender",
                    "attribute": "cejWyOfXge6",
                    "type": "optionSet",
                    "value": "Female"
                },
                {
                    "displayName": "Phone number",
                    "attribute": "P2cwLGskgxn",
                    "type": "phoneNumber",
                    "value": "085 813 9447"
                },
                {
                    "displayName": "First name",
                    "attribute": "dv3nChNSIxy",
                    "type": "string",
                    "value": "Liya"
                },
                {
                    "displayName": "Last name",
                    "attribute": "hwlRTFIFSUq",
                    "type": "string",
                    "value": "Efrem"
                },
                {
                    "code": "Height in cm",
                    "displayName": "Height in cm",
                    "attribute": "lw1SqmMlnfh",
                    "type": "number",
                    "value": "164"
                },
                {
                    "code": "City",
                    "displayName": "City",
                    "attribute": "VUvgVao8Y5z",
                    "type": "string",
                    "value": "Kranskop"
                },
                {
                    "code": "State",
                    "displayName": "State",
                    "attribute": "GUOBQt5K2WI",
                    "type": "number",
                    "value": "KwaZulu-Natal"
                },
                {
                    "code": "Zip code",
                    "displayName": "Zip code",
                    "attribute": "n9nUvfpTsxQ",
                    "type": "number",
                    "value": "3282"
                },
                {
                    "code": "Mother maiden name",
                    "displayName": "Mother maiden name",
                    "attribute": "o9odfev2Ty5",
                    "type": "string",
                    "value": "Gabriel"
                },
                {
                    "code": "National identifier",
                    "displayName": "National identifier",
                    "attribute": "AuPLng5hLbE",
                    "type": "string",
                    "value": "465700042"
                },
                {
                    "code": "Occupation",
                    "displayName": "Occupation",
                    "attribute": "A4xFHyieXys",
                    "type": "string",
                    "value": "Biophysicist"
                },
                {
                    "code": "Company",
                    "displayName": "Company",
                    "attribute": "kyIzQsj96BD",
                    "type": "string",
                    "value": "Sav-A-Center"
                },
                {
                    "code": "Vehicle",
                    "displayName": "Vehicle",
                    "attribute": "VHfUeXpawmE",
                    "type": "string",
                    "value": "2008 Citroen Picasso"
                },
                {
                    "code": "Blood type",
                    "displayName": "Blood type",
                    "attribute": "H9IlTX2X6SL",
                    "type": "string",
                    "value": "B-"
                },
                {
                    "code": "Latitude",
                    "displayName": "Latitude",
                    "attribute": "Qo571yj6Zcn",
                    "type": "string",
                    "value": "-30.659626"
                },
                {
                    "code": "Longitude",
                    "displayName": "Longitude",
                    "attribute": "RG7uGl4w5Jq",
                    "type": "string",
                    "value": "26.916172"
                }
            ]
        }
    ]
}</pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e11568"></a>1.55.&nbsp;Tracked entity instance grid query</h2></div></div></div><p>To query for tracked entity instances you can interact with the <span class="italic">/api/trackedEntityInstances/grid</span> resource. There are two types of queries: One
      where a <span class="italic">query</span> query parameter and optionally <span class="italic">attribute</span> parameters are defined, and one where <span class="italic">attribute</span> and <span class="italic">filter</span> parameters
      are defined. This endpoint uses a more compact "grid" format, and is an alternative
      to the query in the previous section.</p><pre class="screen">api/trackedEntityInstances/query</pre><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e11590"></a>1.55.1.&nbsp;Request syntax</h3></div></div></div><div class="table"><a name="d6099e11593"></a><p class="title"><b>Table&nbsp;1.87.&nbsp;Tracked entity instances query parameters</b></p><div class="table-contents"><table class="table" summary="Tracked entity instances query parameters" border="1"><colgroup><col class="c1"><col class="c3"></colgroup><thead><tr><th>Query parameter</th><th>Description</th></tr></thead><tbody><tr><td>query</td><td>Query string. Attribute query parameter can be used to define which attributes
                to include in the response. If no attributes but a program is defined, the
                attributes from the program will be used. If no program is defined, all attributes
                will be used. There are two formats. The first is a plan query string. The second is
                on the format &lt;operator&gt;:&lt;query&gt;. Operators can be EQ | LIKE. EQ implies
                exact matches on words, LIKE implies partial matches on words. The query will be
                split on space, where each word will form a logical AND query.</td></tr><tr><td>attribute</td><td>Attributes to be included in the response. Can also be used a filter for the
                query. Param can be repeated any number of times. Filters can be applied to a
                dimension on the format
                &lt;attribute-id&gt;:&lt;operator&gt;:&lt;filter&gt;[:&lt;operator&gt;:&lt;filter&gt;].
                Filter values are case-insensitive and can be repeated together with operator any
                number of times. Operators can be EQ | GT | GE | LT | LE | NE | LIKE | IN. Filters
                can be omitted in order to simply include the attribute in the response without any
                constraints.</td></tr><tr><td>filter</td><td>Attributes to use as a filter for the query. Param can be repeated any number
                of times. Filters can be applied to a dimension on the format
                &lt;attribute-id&gt;:&lt;operator&gt;:&lt;filter&gt;[:&lt;operator&gt;:&lt;filter&gt;].
                Filter values are case-insensitive and can be repeated together with operator any
                number of times. Operators can be EQ | GT | GE | LT | LE | NE | LIKE | IN.</td></tr><tr><td>ou</td><td>Organisation unit idenfiers, separated by ";".</td></tr><tr><td>ouMode</td><td>The mode of selecting organisation units, can be SELECTED | CHILDREN |
                DESCENDANTS | ACCESSIBLE | ALL. Default is SELECTED, which refers to the selected
                organisation units only. See table below for explanations.</td></tr><tr><td>program</td><td>Program identifier. Restricts instances to being enrolled in the given
                program.</td></tr><tr><td>programStatus</td><td>Status of the instance for the given program. Can be ACTIVE | COMPLETED |
                CANCELLED.</td></tr><tr><td>followUp</td><td>Follow up status of the instance for the given program. Can be true | false or
                omitted.</td></tr><tr><td>programStartDate</td><td>Start date of enrollment in the given program for the tracked entity
                instance.</td></tr><tr><td>programEndDate</td><td>End date of enrollment in the given program for the tracked entity
                instance.</td></tr><tr><td>trackedEntity</td><td>Tracked entity identifer. Restricts instances to the given tracked instance
                type.</td></tr><tr><td>eventStatus</td><td>Status of any event associated with the given program and the tracked entity
                instance. Can be ACTIVE | COMPLETED | VISITED | SCHEDULED | OVERDUE
                |&nbsp;SKIPPED.</td></tr><tr><td>eventStartDate</td><td>Start date of event associated with the given program and event status.</td></tr><tr><td>eventEndDate</td><td>End date of event associated with the given program and event status.</td></tr><tr><td>skipMeta</td><td>Indicates whether meta data for the response should be included.</td></tr><tr><td>page</td><td>The page number. Default page is 1.</td></tr><tr><td>pageSize</td><td>The page size. Default size is 50 rows per page.</td></tr><tr><td>totalPages</td><td>Indicates whether to include the total number of pages in the paging response
                (implies higher response time).</td></tr><tr><td>skipPaging</td><td>Indicates whether paging should be ignored and all rows should be
                returned.</td></tr></tbody></table></div></div><br class="table-break"><p>The available organisation unit selection modes are explained in the following
        table.</p><div class="table"><a name="d6099e11703"></a><p class="title"><b>Table&nbsp;1.88.&nbsp;Organisation unit selection modes</b></p><div class="table-contents"><table class="table" summary="Organisation unit selection modes" border="1"><colgroup><col class="c1"><col class="c2"></colgroup><thead><tr><th>Mode</th><th>Description</th></tr></thead><tbody><tr><td>SELECTED</td><td>Organisation units defined in the request.</td></tr><tr><td>CHILDREN</td><td>Immediate children, i.e. only the first level below, of the organisation units
                defined in the request.</td></tr><tr><td>DESCENDANTS</td><td>All children, i.e. at only levels below, e.g. including children of children,
                of the organisation units defined in the request.</td></tr><tr><td>ACCESSIBLE</td><td>All descendants of the data view organisation units associated with the current
                user. Will fall back to data capture organisation units associated with the current
                user if the former is not defined.</td></tr><tr><td>ALL</td><td>All organisation units in the system. Requires authority.</td></tr></tbody></table></div></div><br class="table-break"><p>Note that you can specify attributes with filters for constraining the instances to
        return, or attributes without filters in order to include the attribute in the response
        without any constraints. Attributes will be included in the response, while filters will
        only be used as criteria. </p><p>Certain rules apply to which attributes are defined when no attributes are specified in
        the request:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>If not specifying a program, the attributes defined to be displayed in lists with no
            program will be included in the response.</p></li><li class="listitem"><p>If specifying a program, the attributes linked to the program will be included in
            the response.</p></li></ul></div><p>You can specify queries with words separated by space - in that situation the system
        will query for each word independently and return records where each word is contained in
        any attribute. A query item can be specified once as an attribute and once as a filter if
        needed. The query is case insensitive. The following rules apply to the query
        parameters.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>At least one organisation unit must be specified using the <span class="italic">ou</span> parameter (one or many), or <span class="italic">ouMode=ALL</span> must be specified.</p></li><li class="listitem"><p>Only one of the <span class="italic">program</span> and <span class="italic">trackedEntity</span> parameters can be specified (zero or
            one).</p></li><li class="listitem"><p>If <span class="italic">programStatus</span> is specified then <span class="italic">program</span> must also be specified.</p></li><li class="listitem"><p>If <span class="italic">followUp</span> is specified then <span class="italic">program</span> must also be specified.</p></li><li class="listitem"><p>If <span class="italic">programStartDate</span> or <span class="italic">programEndDate</span> is specified then <span class="italic">program</span> must also be specified.</p></li><li class="listitem"><p>If <span class="italic">eventStatus</span> is specified then <span class="italic">eventStartDate</span> and <span class="italic">eventEndDate</span> must also be specified.</p></li><li class="listitem"><p>A query cannot be specified together with filters.</p></li><li class="listitem"><p>Attribute items can only be specified once.</p></li><li class="listitem"><p>Filter items can only be specified once.</p></li></ul></div><p>A query for all instances associated with a specific organisation unit can look like
        this:</p><pre class="screen">api/trackedEntityInstances/query.json?ou=DiszpKrYNg8</pre><p>A query on all attributes for a specific value and organisation unit, using an exact
        word match:</p><pre class="screen">api/trackedEntityInstances/query.json?query=scott&amp;ou=DiszpKrYNg8</pre><p>A query on all attributes for a specific value, using a partial word match:</p><pre class="screen">api/trackedEntityInstances/query.json?query=LIKE:scott&amp;ou=DiszpKrYNg8</pre><p>You can query on multiple words separated by the the URL character for space which is
        %20, will use a logical AND query for each word:</p><pre class="screen">api/trackedEntityInstances/query.json?query=isabel%20may&amp;ou=DiszpKrYNg8</pre><p>A query where the attributes to include in the response are specified:</p><pre class="screen">api/trackedEntityInstances/query.json?query=isabel&amp;attribute=dv3nChNSIxy&amp;attribute=AMpUYgxuCaE&amp;ou=DiszpKrYNg8</pre><p>To query for instances using one attribute with a filter and one attribute without a
        filter, with one organisation unit using the descendants organisation unit query
        mode:</p><pre class="screen">api/trackedEntityInstances/query.json?attribute=zHXD5Ve1Efw:EQ:A
&amp;attribute=AMpUYgxuCaE&amp;ou=DiszpKrYNg8;yMCshbaVExv</pre><p>A query for instances where one attribute is included in the response and one attribute
        us used as a filter:</p><pre class="screen">api/trackedEntityInstances/query.json?attribute=zHXD5Ve1Efw:EQ:A&amp;filter=AMpUYgxuCaE:LIKE:Road&amp;ou=DiszpKrYNg8</pre><p>A query where multiple operand and filters are specified for a filter item:</p><pre class="screen">api/trackedEntityInstances/query.json?ou=DiszpKrYNg8&amp;program=ur1Edk5Oe2n&amp;filter=lw1SqmMlnfh:GT:150:LT:190</pre><p>To query on an attribute using multiple values in an IN filter:</p><pre class="screen">api/trackedEntityInstances/query.json?ou=DiszpKrYNg8&amp;attribute=dv3nChNSIxy:IN:Scott;Jimmy;Santiago</pre><p>To constrain the response to instances which are part of a specific program you can
        include a program query parameter:</p><pre class="screen">api/trackedEntityInstances/query.json?filter=zHXD5Ve1Efw:EQ:A
&amp;ou=O6uvpzGd5pu&amp;ouMode=DESCENDANTS&amp;program=ur1Edk5Oe2n</pre><p>To specify program enrollment dates as part of the query:</p><pre class="screen">api/trackedEntityInstances/query.json?filter=zHXD5Ve1Efw:EQ:A
&amp;ou=O6uvpzGd5pu&amp;program=ur1Edk5Oe2n&amp;programStartDate=2013-01-01&amp;programEndDate=2013-09-01</pre><p>To constrain the response to instances of a specific tracked entity you can include a
        tracked entity query parameter:</p><pre class="screen">api/trackedEntityInstances/query.json?attribute=zHXD5Ve1Efw:EQ:A
&amp;ou=O6uvpzGd5pu&amp;ouMode=DESCENDANTS&amp;trackedEntity=cyl5vuJ5ETQ</pre><p>By default the instances are returned in pages of size 50, to change this you can use
        the page and pageSize query parameters:</p><pre class="screen">api/trackedEntityInstances/query.json?attribute=zHXD5Ve1Efw:EQ:A
&amp;ou=O6uvpzGd5pu&amp;ouMode=DESCENDANTS&amp;page=2&amp;pageSize=3</pre><p>To query for instances which have events of a given status within a given time
        span:</p><pre class="screen">api/trackedEntityInstances/query.json?ou=O6uvpzGd5pu
&amp;program=ur1Edk5Oe2n&amp;eventStatus=LATE_VISIT
&amp;eventStartDate=2014-01-01&amp;eventEndDate=2014-09-01</pre><p>You can use a range of operators for the filtering:</p><div class="table"><a name="d6099e11882"></a><p class="title"><b>Table&nbsp;1.89.&nbsp;Filter operators</b></p><div class="table-contents"><table class="table" summary="Filter operators" border="1"><colgroup><col width="87.75pt" class="c1"><col width="368.25pt" class="c2"></colgroup><thead><tr><th>Operator</th><th>Description</th></tr></thead><tbody><tr><td>EQ</td><td>Equal to</td></tr><tr><td>GT</td><td>Greater than</td></tr><tr><td>GE</td><td>Greater than or equal to</td></tr><tr><td>LT</td><td>Less than</td></tr><tr><td>LE</td><td>Less than or equal to</td></tr><tr><td>NE</td><td>Not equal to</td></tr><tr><td>LIKE</td><td>Like (free text match)</td></tr><tr><td>IN</td><td>Equal to one of multiple values separated by ";"</td></tr></tbody></table></div></div><br class="table-break"></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e11935"></a>1.55.2.&nbsp;Response format</h3></div></div></div><p>This resource supports JSON, JSONP, XLS and CSV resource representations.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>json (application/json)</p></li><li class="listitem"><p>jsonp (application/javascript)</p></li><li class="listitem"><p>xml (application/xml)</p></li><li class="listitem"><p>csv (application/csv)</p></li><li class="listitem"><p>xls (application/vnd.ms-excel)</p></li></ul></div><p>The response in JSON comes is in a tabular format and can look like the following. The
          <span class="italic">headers</span> section describes the content of each column.
        The instance, created, last updated, org unit and tracked entity columns are always present.
        The following columns correspond to attributes specified in the query. The <span class="italic">rows</span> section contains one row per instance.</p><pre class="screen">{
    "headers": [{
        "name": "instance",
        "column": "Instance",
        "type": "java.lang.String"
    }, {
        "name": "created",
        "column": "Created",
        "type": "java.lang.String"
    }, {
        "name": "lastupdated",
        "column": "Last updated",
        "type": "java.lang.String"
    }, {
        "name": "ou",
        "column": "Org unit",
        "type": "java.lang.String"
    }, {
        "name": "te",
        "column": "Tracked entity",
        "type": "java.lang.String"
    }, {
        "name": "zHXD5Ve1Efw",
        "column": "Date of birth type",
        "type": "java.lang.String"
    }, {
        "name": "AMpUYgxuCaE",
        "column": "Address",
        "type": "java.lang.String"
    }],
    "metaData": {
        "names": {
            "cyl5vuJ5ETQ": "Person"
        }
    },
    "width": 7,
    "height": 7,
    "rows": [
        ["yNCtJ6vhRJu", "2013-09-08 21:40:28.0", "2014-01-09 19:39:32.19", "DiszpKrYNg8", "cyl5vuJ5ETQ", "A", "21 Kenyatta Road"],
        ["fSofnQR6lAU", "2013-09-08 21:40:28.0", "2014-01-09 19:40:19.62", "DiszpKrYNg8", "cyl5vuJ5ETQ", "A", "56 Upper Road"],
        ["X5wZwS5lgm2", "2013-09-08 21:40:28.0", "2014-01-09 19:40:31.11", "DiszpKrYNg8", "cyl5vuJ5ETQ", "A", "56 Main Road"],
        ["pCbogmlIXga", "2013-09-08 21:40:28.0", "2014-01-09 19:40:45.02", "DiszpKrYNg8", "cyl5vuJ5ETQ", "A", "12 Lower Main Road"],
        ["WnUXrY4XBMM", "2013-09-08 21:40:28.0", "2014-01-09 19:41:06.97", "DiszpKrYNg8", "cyl5vuJ5ETQ", "A", "13 Main Road"],
        ["xLNXbDs9uDF", "2013-09-08 21:40:28.0", "2014-01-09 19:42:25.66", "DiszpKrYNg8", "cyl5vuJ5ETQ", "A", "14 Mombasa Road"],
        ["foc5zag6gbE", "2013-09-08 21:40:28.0", "2014-01-09 19:42:36.93", "DiszpKrYNg8", "cyl5vuJ5ETQ", "A", "15 Upper Hill"]
    ]
}</pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e11966"></a>1.56.&nbsp;Enrollment instance query</h2></div></div></div><p>To query for tracked entity instances you can interact with the <span class="italic">/api/enrollments</span> resource. </p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e11974"></a>1.56.1.&nbsp;Request syntax</h3></div></div></div><div class="table"><a name="d6099e11977"></a><p class="title"><b>Table&nbsp;1.90.&nbsp;Tracked entity instances query parameters</b></p><div class="table-contents"><table class="table" summary="Tracked entity instances query parameters" border="1"><colgroup><col class="c1"><col class="c3"></colgroup><thead><tr><th>Query parameter</th><th>Description</th></tr></thead><tbody><tr><td>ou</td><td>Organisation unit idenfiers, separated by ";".</td></tr><tr><td>ouMode</td><td>The mode of selecting organisation units, can be SELECTED | CHILDREN |
                DESCENDANTS | ACCESSIBLE | ALL. Default is SELECTED, which refers to the selected
                organisation units only. See table below for explanations.</td></tr><tr><td>program</td><td>Program identifier. Restricts instances to being enrolled in the given
                program.</td></tr><tr><td>programStatus</td><td>Status of the instance for the given program. Can be ACTIVE | COMPLETED |
                CANCELLED.</td></tr><tr><td>followUp</td><td>Follow up status of the instance for the given program. Can be true | false or
                omitted.</td></tr><tr><td>programStartDate</td><td>Start date of enrollment in the given program for the tracked entity
                instance.</td></tr><tr><td>programEndDate</td><td>End date of enrollment in the given program for the tracked entity
                instance.</td></tr><tr><td>trackedEntity</td><td>Tracked entity identifer. Restricts instances to the given tracked instance
                type.</td></tr><tr><td>trackedEntityInstsane</td><td>Tracked entity instance identifier. Should not be used together with
                trackedEntity.</td></tr><tr><td>page</td><td>The page number. Default page is 1.</td></tr><tr><td>pageSize</td><td>The page size. Default size is 50 rows per page.</td></tr><tr><td>totalPages</td><td>Indicates whether to include the total number of pages in the paging response
                (implies higher response time).</td></tr><tr><td>skipPaging</td><td>Indicates whether paging should be ignored and all rows should be
                returned.</td></tr></tbody></table></div></div><br class="table-break"><p>The available organisation unit selection modes are explained in the following
        table.</p><div class="table"><a name="d6099e12057"></a><p class="title"><b>Table&nbsp;1.91.&nbsp;Organisation unit selection modes</b></p><div class="table-contents"><table class="table" summary="Organisation unit selection modes" border="1"><colgroup><col class="c1"><col class="c2"></colgroup><thead><tr><th>Mode</th><th>Description</th></tr></thead><tbody><tr><td>SELECTED</td><td>Organisation units defined in the request (default).</td></tr><tr><td>CHILDREN</td><td>Immediate children, i.e. only the first level below, of the organisation units
                defined in the request.</td></tr><tr><td>DESCENDANTS</td><td>All children, i.e. at only levels below, e.g. including children of children,
                of the organisation units defined in the request.</td></tr><tr><td>ACCESSIBLE</td><td>All descendants of the data view organisation units associated with the current
                user. Will fall back to data capture organisation units associated with the current
                user if the former is not defined.</td></tr><tr><td>ALL</td><td>All organisation units in the system. Requires authority.</td></tr></tbody></table></div></div><br class="table-break"><p>You can specify queries with words separated by space - in that situation the system
        will query for each word independently and return records where each word is contained in
        any attribute. A query item can be specified once as an attribute and once as a filter if
        needed. The query is case insensitive. The following rules apply to the query
        parameters.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>At least one organisation unit must be specified using the <span class="italic">ou</span> parameter (one or many), or <span class="italic">ouMode=ALL</span> must be specified.</p></li><li class="listitem"><p>Only one of the <span class="italic">program</span> and <span class="italic">trackedEntity</span> parameters can be specified (zero or
            one).</p></li><li class="listitem"><p>If <span class="italic">programStatus</span> is specified then <span class="italic">program</span> must also be specified.</p></li><li class="listitem"><p>If <span class="italic">followUp</span> is specified then <span class="italic">program</span> must also be specified.</p></li><li class="listitem"><p>If <span class="italic">programStartDate</span> or <span class="italic">programEndDate</span> is specified then <span class="italic">program</span> must also be specified.</p></li></ul></div><p>A query for all instances associated with a specific organisation unit can look like
        this:</p><pre class="screen">api/enrollments.json?ou=DiszpKrYNg8</pre><p>To constrain the response to instances which are part of a specific program you can
        include a program query parameter:</p><pre class="screen">api/enrollments.json?ou=O6uvpzGd5pu&amp;ouMode=DESCENDANTS&amp;program=ur1Edk5Oe2n</pre><p>To specify program enrollment dates as part of the query:</p><pre class="screen">api/enrollments.json?&amp;ou=O6uvpzGd5pu&amp;program=ur1Edk5Oe2n&amp;programStartDate=2013-01-01&amp;programEndDate=2013-09-01</pre><p>To constrain the response to instances of a specific tracked entity you can include a
        tracked entity query parameter:</p><pre class="screen">api/enrollments.json?ou=O6uvpzGd5pu&amp;ouMode=DESCENDANTS&amp;trackedEntity=cyl5vuJ5ETQ</pre><p>To constrain the response to instances of a specific tracked entity instance you can
        include a tracked entity instance query parameter, in this case we are restricted it to
        available enrollments viewable for current
        user:</p><pre class="screen">api/enrollments.json?ouMode=ACCESSIBLE&amp;trackedEntityInstance=tphfdyIiVL6</pre><p>By default the instances are returned in pages of size 50, to change this you can use
        the page and pageSize query parameters:</p><pre class="screen">api/enrollments.json?ou=O6uvpzGd5pu&amp;ouMode=DESCENDANTS&amp;page=2&amp;pageSize=3</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e12170"></a>1.56.2.&nbsp;Response format</h3></div></div></div><p>This resource supports JSON, JSONP, XLS and CSV resource representations.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>json (application/json)</p></li><li class="listitem"><p>jsonp (application/javascript)</p></li><li class="listitem"><p>xml (application/xml)</p></li></ul></div><p>The response in JSON/XML is in object format and can look like the following (please
        note that field filtering is supported, so if you want a full view, you might want to add
        fields=*):</p><pre class="screen">{
    "enrollments": [
        {
            "lastUpdated": "2014-03-28T05:27:48.512+0000",
            "trackedEntity": "cyl5vuJ5ETQ",
            "created": "2014-03-28T05:27:48.500+0000",
            "orgUnit": "DiszpKrYNg8",
            "program": "ur1Edk5Oe2n",
            "enrollment": "HLFOK0XThjr",
            "trackedEntityInstance": "qv0j4JBXQX0",
            "followup": false,
            "dateOfEnrollment": "2013-05-23T05:27:48.490+0000",
            "dateOfIncident": "2013-05-10T05:27:48.490+0000",
            "status": "ACTIVE"
        }
    ]
}</pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e12189"></a>1.57.&nbsp;Tracker bulk deletion</h2></div></div></div><p>Bulk deletion of tracker objects work in a similar fashion to adding and updating tracker
      objects, the only difference is that the <span class="italic">importStrategy</span> is
        <span class="bold"><strong>DELETE</strong></span>.</p><p><span class="italic">Example: Bulk deletion of tracked entity
      instances:</span></p><pre class="screen">{
  "trackedEntityInstances": [
    { "trackedEntityInstance": "ID1" },
    { "trackedEntityInstance": "ID2" },
    { "trackedEntityInstance": "ID3" }
  ]
}</pre><pre class="screen">curl -X POST -d @data.json -H "Content-Type: application/json"
  "http://server/api/trackedEntityInstasnces?importStrategy=DELETE"</pre><p><span class="italic">Example: Bulk deletion of
      enrollments:</span></p><pre class="screen">{
  "enrollments": [
    { "enrollment": "ID1" },
    { "enrollment": "ID2" },
    { "enrollment": "ID3" }
  ]
}</pre><pre class="screen">curl -X POST -d @data.json -H "Content-Type: application/json"
  "http://server/api/enrollments?importStrategy=DELETE"</pre><p><span class="italic">Example: Bulk deletion of
      events:</span></p><pre class="screen">{
  "events": [
    { "event": "ID1" },
    { "event": "ID2" },
    { "event": "ID3" }
  ]
}</pre><pre class="screen">curl -X POST -d @data.json -H "Content-Type: application/json"
  "http://server/api/events?importStrategy=DELETE"</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e12221"></a>1.58.&nbsp;Email</h2></div></div></div><p>The Web API features a resource for sending emails. For emails to be sent it is required
      that the SMTP configuration has been properly set up and that a system notification email
      address for the DHIS 2 instance has been defined. You can set SMTP settings from the email
      settings screen and system notification email address from the general settings screen in DHIS
      2. </p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e12226"></a>1.58.1.&nbsp;System notification</h3></div></div></div><p>The <span class="italic">notification</span> resource lets you send system email
        notifications with a given subject and text in JSON or XML. The email will be sent to the
        notification email address as defined in the DHIS2 general system settings:</p><pre class="screen">{
  "subject": "Integrity check summary",
  "text": "All checks ran successfully"
}</pre><p>You can send a system email notification by posting to the notification resource like
        this:</p><pre class="screen">curl -d @email.json "localhost/api/email/notification" -X POST -H "Content-Type:application/json" -u admin:district -v</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e12240"></a>1.58.2.&nbsp;Test message</h3></div></div></div><p>To test whether the SMTP setup is correct by sending a test email to yourself you can
        interact with the <span class="italic">test</span> resource. To send test emails it
        is required that your DHIS 2 user account has a valid email address associated with it. You
        can send a test email like this:</p><pre class="screen">curl "localhost/api/email/test" -X POST -H "Content-Type:application/json" -u admin:district -v</pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e12250"></a>1.59.&nbsp;Sharing</h2></div></div></div><p>The sharing solution allows you to share most objects in the system with specific user
      groups and to define whether objects should be publicly accessible or private. To get and set
      sharing status for objects you can interact with the <span class="italic">sharing</span> resource.</p><pre class="screen">/api/sharing</pre><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e12260"></a>1.59.1.&nbsp;Get sharing status</h3></div></div></div><p>To request the sharing status for an object use a GET request to:</p><pre class="screen">api/sharing?type=dataElement&amp;id=fbfJHSPpUQD</pre><p>The response looks like the below.</p><pre class="screen">{
    "meta": {
        "allowPublicAccess": true,
        "allowExternalAccess": false
    },
    "object": {
        "id": "fbfJHSPpUQD",
        "name": "ANC 1st visit",
        "publicAccess": "rw------",
        "externalAccess": false,
        "user": {},
        "userGroupAccesses": [
            {
                "id": "hj0nnsVsPLU",
                "access": "rw------"
            },
            {
                "id": "qMjBflJMOfB",
                "access": "r-------"
            }
        ]
    }
}</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e12271"></a>1.59.2.&nbsp;Set sharing status</h3></div></div></div><p>You can define the sharing status for an object using the same URL with a POST request,
      where the payload in JSON format looks like this:</p><pre class="screen">{
    "object": {
        "publicAccess": "rw------",
        "externalAccess": false,
        "user": {},
        "userGroupAccesses": [
            {
                "id": "hj0nnsVsPLU",
                "access": "rw------"
            },
            {
                "id": "qMjBflJMOfB",
                "access": "r-------"
            }
        ]
    }
}</pre><p>In this example, the payload defines the object to have read-write public access, no
      external access (without login), read-write access to one user group and read-only access to
      another user group. You can submit this to the sharing resource using curl:</p><pre class="screen">curl -d @sharing.json "localhost/api/sharing?type=dataElement&amp;id=fbfJHSPpUQD" 
-H "Content-Type:application/json" -u admin:district -v</pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e12282"></a>1.60.&nbsp;Scheduling</h2></div></div></div><p>To schedule tasks to run at fixed intervals you can interact with the scheduling resource.
      To configure tasks you can do a POST request to the following
      resource:</p><pre class="screen">/api/scheduling</pre><p>The payload in JSON format is described
      below.</p><pre class="screen">{
    "resourceTableStrategy": "allDaily",
    "analyticsStrategy": "allDaily",
    "monitoringStrategy": "allDaily",
    "dataSynchStrategy": "enabled"
}</pre><p>An example using
      curl:</p><pre class="screen">curl "localhost/dhis/api/scheduling" -d @scheduling.json -X POST 
-H "Content-Type:application/json" -u admin:district -v</pre><p>The table below lists available task strategies.</p><div class="table"><a name="d6099e12299"></a><p class="title"><b>Table&nbsp;1.92.&nbsp;Task strategies</b></p><div class="table-contents"><table class="table" summary="Task strategies" border="1"><colgroup><col class="c1"><col class="c2"></colgroup><thead><tr><th>Task</th><th>Strategies</th></tr></thead><tbody><tr><td>Resource table task</td><td>allDaily | allEvery15Min</td></tr><tr><td>Analytics task</td><td>allDaily | last3YearsDaily</td></tr><tr><td>Monitoring</td><td>allDaily</td></tr><tr><td>Data synch task</td><td>enabled</td></tr></tbody></table></div></div><p><br class="table-break"></p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e12332"></a>1.61.&nbsp;Schema</h2></div></div></div><p>A resource which can be used to introspect all available DXF 2 objects can be found on
        <span class="italic">/api/schemas</span>. For specific resources you can have a look
      at <span class="italic">/api/schemas/TYPE</span>.</p><p>To get all available schemas in XML:</p><pre class="screen">GET /api/schemas.xml</pre><p>To get all available schemas in JSON:</p><pre class="screen">GET /api/schemas.json</pre><p>To get JSON schema for a specific
      class:</p><pre class="screen">GET /api/schemas/dataElement.json</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e12355"></a>1.62.&nbsp;UI customization</h2></div></div></div><p>To customize the UI of the DHIS 2 application you can insert custom Javascript and CSS
      styles through the <span class="italic">files</span> resource. The Javascript and CSS
      content inserted through this resource will be loaded by the DHIS 2 web application. This can
      be particularly useful in certain situations:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Overriding the CSS styles of the DHIS 2 application, such as the login page or main
          page.</p></li><li class="listitem"><p>Defining Javascript functions which are common to several custom data entry forms and
          HTML-based reports.</p></li><li class="listitem"><p>Including CSS styles which are used in custom data entry forms and HTML-based
          reports.</p></li></ul></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e12373"></a>1.62.1.&nbsp;Javascript</h3></div></div></div><p>To insert Javascript from a file called <span class="italic">script.js</span> you
        can interact with the <span class="italic">files/script</span> resource with a
        POST-request:</p><pre class="screen">curl --data-binary @script.js "localhost/api/files/script" 
-H "Content-Type:application/javascript" -u admin:district -v</pre><p>Note that we use the --data-binary option to preserve formatting of the file content.
        You can fetch the Javascript content with a GET-request:</p><pre class="screen">api/files/script</pre><p>To remove the Javascript content you can use a DELETE-request.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e12392"></a>1.62.2.&nbsp;CSS</h3></div></div></div><p>To insert CSS from a file called <span class="italic">style.css</span> you can
        interact with the <span class="italic">files/style</span> resource with a
        POST-request:</p><pre class="screen">curl --data-binary @style.css "localhost/api/files/style" 
-H "Content-Type:text/css" -u admin:district -v</pre><p>You can fetch the CSS content with a GET-request:</p><pre class="screen">api/files/style</pre><p>To remove the Javascript content you can use a DELETE-e "request.</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e12411"></a>1.63.&nbsp;Synchronization</h2></div></div></div><p>This section covers pull and push of data and metadata.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e12416"></a>1.63.1.&nbsp;Data push</h3></div></div></div><p>To initiate a data push to a remote server one must first configure the URL and
        credentials for the relevant server from System settings &gt; Synchronization, then make a
        POST request to the following resource:</p><pre class="screen">api/synchronization/dataPush</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e12423"></a>1.63.2.&nbsp;Metadata pull</h3></div></div></div><p>To initiate a metadata pull from a remote JSON document you can make a POST request with
        a <span class="italic">url</span> as request payload to the following
        resource:</p><pre class="screen">api/synchronization/metadataPull</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e12433"></a>1.63.3.&nbsp;Availability check</h3></div></div></div><p>To check the availability of the remote data server and verify user credentials you can
        make a GET request to the following
        resource:</p><pre class="screen">api/synchronization/availability</pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e12440"></a>1.64.&nbsp;Apps</h2></div></div></div><p> The <span class="italic">/api/apps</span> endpoint can be used for installing,
      deleting and listing apps. The app key is derived from the name of the ZIP archive, exluding
      the file extension.</p><pre class="screen">/api/apps</pre><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e12450"></a>1.64.1.&nbsp;Get apps</h3></div></div></div><p>You can read the keys for apps by listing all apps from the apps resource and look for
        the <span class="italic">key</span> property. To list all installed apps in
        JSON:</p><pre class="screen">curl -X GET -u user:pass -H "Accept: application/json" http://server.com/api/apps</pre><p>You can also simply point your web browser to the resource URL:</p><pre class="screen">http://server.com/api/apps</pre><p>The apps list can also be filtered by app type and by name, by appending one or more
          <span class="emphasis"><em>filter</em></span> parameters to the URL:</p><p>
        </p><pre class="screen">http://server.com/api/apps?filter=appType:eq:DASHBOARD_APP&amp;filter=name:ilike:youtube</pre><p>
      </p><p>App names support the <span class="emphasis"><em>eq</em></span> and <span class="emphasis"><em>ilike</em></span> filter
        operators, while <span class="emphasis"><em>appType</em></span> supports <span class="emphasis"><em>eq</em></span> only.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e12488"></a>1.64.2.&nbsp;Install an app</h3></div></div></div><p>To install an app, the following command can be issued:
        </p><pre class="screen">curl -X POST -u user:pass -F file=@app.zip http://server.com/api/apps</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e12495"></a>1.64.3.&nbsp;Delete an app</h3></div></div></div><p>To delete an app, you can issue the following command:
        </p><pre class="screen">curl -X DELETE -u user:pass http://server.com/api/apps/&lt;app-key&gt;</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e12502"></a>1.64.4.&nbsp;Reload apps</h3></div></div></div><p>To force a reload of currently installed apps, you can issue the following command. This
        is useful if you added a file manually directly to the file system, instead of uploading
        through the DHIS 2 user interface.
        </p><pre class="screen">curl -X PUT -u user:pass http://server.com/api/apps</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e12509"></a>1.64.5.&nbsp;Configure apps</h3></div></div></div><p>To let DHIS 2 serve apps from the Web API make sure to set the "App base URL"
        to point to the apps resource, i.e.:</p><pre class="screen">http://server.com/api/apps</pre><p>To set the apps configuration you can make a POST request to the <span class="italic">config</span> resourec with a JSON payload:</p><pre class="screen">{
  "appFolderPath": "/home/dhis/config/apps",
  "appBaseUrl": "http://server.com/api/apps"
}</pre><pre class="screen">curl -X POST -u user:pass -d @config.json http://server.com/api/apps/config</pre><p>To restore the default app settings you can make a DELETE request to the config
        resource:</p><pre class="screen">curl -X DELETE -u user:pass http://server.com/api/apps/config</pre><p>Note that by default apps will be served through the apps Web API resource, and the file
        system folder will be <span class="italic">DHIS2_HOME/apps</span>. These systems
        should be fine for most situations.</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e12534"></a>1.65.&nbsp;App store</h2></div></div></div><p>The Web API exposes the content of the DHIS 2 App Store as a JSON representation which can
      found at the <span class="italic">api/appStore</span> resource.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e12542"></a>1.65.1.&nbsp;Get apps</h3></div></div></div><p>You can retrieve apps with a GET request: </p><pre class="screen">GET /api/appStore</pre><p>A sample JSON response is described below.
        </p><pre class="screen">{
  "name": "DHIS 2 App Store",
  "description": "Send your apps with a description to us at apps@dhis2.org",
  "apps": [
    {
      "name": "Tabular Tracker Capture",
      "description": "Tabular Tracker Capture is an app that makes you more effective.",
      "developer": "John Develop",
      "img_large": "https://www.dhis2.org/images/appstore/tabular-tracker-capture.png",
      "versions": [
        {
          "id": "upAPqrVgwK6",
          "version": "1.2",
          "min_platform_version": "2.17",
          "max_platform_version": "2.20",
          "download_url": "https://www.dhis2.org/download/appstore/tabular-tracker-capture-12.zip",
          "demo_url": "http://play.dhis2.org/demo"
        }
      ]
    }
  ]
}</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e12553"></a>1.65.2.&nbsp;Install apps</h3></div></div></div><p>You can install apps on your instance of DHIS 2 assuming you have the appropriate
        permissions. An app is referred to using the <span class="italic">id</span> property
        of the relevant <span class="italic">version</span> of the <span class="italic">app</span>. An app is installed with a POST request with the version id to the
        following resource:</p><pre class="screen">POST /api/appStore/{app-version-id}</pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e12569"></a>1.66.&nbsp;Data store</h2></div></div></div><p>Using the <span class="emphasis"><em>dataStore</em></span> resource, developers can store arbitrary data for
      their apps. Access to a datastore is limited to the user's access to the corresponding
      app. For example a user with access to the "sampleApp" application will also be able
      to use the sampleApp namespace in the datastore.</p><pre class="screen">/api/dataStore</pre><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e12579"></a>1.66.1.&nbsp;Data store structure</h3></div></div></div><p>Data store entries consist of a namespace, key and value. The combination of namespace
        and key is unique. The value data type is JSON.</p><div class="table"><a name="d6099e12584"></a><p class="title"><b>Table&nbsp;1.93.&nbsp;Data store structure</b></p><div class="table-contents"><table class="table" summary="Data store structure" border="1"><colgroup><col class="c1"><col class="c2"><col class="newCol3"></colgroup><thead><tr><th>Item</th><th>Description</th><th>Data type</th></tr></thead><tbody><tr><td>Namespace</td><td>Namespace for organization of entries.</td><td>String</td></tr><tr><td>Key</td><td>Key for identifiaction of values.</td><td>String</td></tr><tr><td>Value</td><td>Value holding the information for the entry.</td><td>JSON</td></tr><tr><td>Encrypted</td><td>Indicates whether the value of the given key should be encrypted</td><td>Boolean</td></tr></tbody></table></div></div><br class="table-break"></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e12628"></a>1.66.2.&nbsp;Get keys and namespaces</h3></div></div></div><p>For a list of all existing namespaces:</p><pre class="screen">GET /api/dataStore</pre><p>Example curl request for
        listing:</p><pre class="screen">curl "play.dhis2.org/demo/api/dataStore" -X GET -u admin:district -v</pre><p>Example response:</p><p>
        </p><pre class="screen">[
    "foo",
    "bar"
]</pre><p>
      </p><p>For a list of all keys in a
        namespace:</p><pre class="screen">GET /api/dataStore/&lt;namespace&gt;</pre><p>Example curl request for
        listing:</p><pre class="screen">curl "play.dhis2.org/demo/api/dataStore/foo" -X GET -u admin:district -v</pre><p>Example response:</p><pre class="screen">[
    "key_1",
    "key_2"
]</pre><p>To retrieve a value for an existing key from a
        namespace:</p><pre class="screen">GET /api/dataStore/&lt;namespace&gt;/&lt;key&gt;</pre><p>Example curl request for
        retrieval:</p><pre class="screen">curl "play.dhis2.org/demo/api/dataStore/foo/key_1" -X GET -u admin:district -v</pre><p>Example response:</p><pre class="screen">{
    "foo":"bar"
}</pre><p>To retrieve meta-data for en existing key from a namespace:
        </p><pre class="screen">GET /api/dataStore/</pre><p>Example curl request for
        retrieval:</p><pre class="screen">curl "play.dhis2.org/demo/api/dataStore/foo/key_1/metaData" -X GET -u admin:district -v</pre><p>Example
        response:</p><pre class="screen">{
    "created": "...",
    "user": {...},
    "namespace": "foo",
    "key": "key_1"
}</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e12682"></a>1.66.3.&nbsp;Create and update values</h3></div></div></div><p>To create a new key and value for a
        namespace:</p><pre class="screen">POST /api/dataStore/&lt;namespace&gt;/&lt;key&gt;</pre><p>Example curl request for create, assuming a valid json
        payload:</p><pre class="screen">curl "https://play.dhis2.org/demo/api/dataStore/foo/key_1" -X POST 
-H "Content-Type: application/json" -d "{\"foo\":\"bar\"}" -u admin:district -v</pre><p>Example
        response:</p><pre class="screen">{
    "httpStatus": "OK",
    "httpStatusCode": 201,
    "status": "OK",
    "message": "Key 'key_1' created."
}</pre><p>If you require the data you store to be encrypted (For example user credentials or
        similar) you can append a query to the url like
        this:</p><pre class="screen">GET /api/dataStore/&lt;namespace&gt;/&lt;key&gt;?encrypt=true</pre><p>To update a key that exists in a
        namespace:</p><pre class="screen">PUT /api/dataStore/&lt;namespace&gt;/&lt;key&gt;</pre><p>Example curl request for update, assuming valid JSON
        payload:</p><pre class="screen">curl "https://play.dhis2.org/demo/api/dataStore/foo/key_1" -X PUT -d "[1, 2, 3]" 
-H "Content-Type: application/json" -u admin:district -v</pre><p>Example
        response:</p><pre class="screen">{
    "httpStatus": "OK",
    "httpStatusCode": 200,
    "status": "OK",
    "message": "Key 'key_1' updated."
}</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e12713"></a>1.66.4.&nbsp;Delete keys</h3></div></div></div><p>To delete an existing key from a
        namespace:</p><pre class="screen">DELETE /api/dataStore/&lt;namespace&gt;/&lt;key&gt;</pre><p>Example curl request for
        delete:</p><pre class="screen">curl "play.dhis2.org/demo/api/dataStore/foo/key_1" -X DELETE -u admin:district -v</pre><p>Example
        response:</p><pre class="screen">{
    "httpStatus": "OK",
    "httpStatusCode": 200,
    "status": "OK",
    "message": "Key 'key_1' deleted from namespace 'foo'."
}</pre><p>To delete all keys in a
        namespace:</p><pre class="screen">DELETE /api/dataStore/&lt;namespace&gt;</pre><p>Example curl request for
        delete:</p><pre class="screen">curl "play.dhis2.org/demo/api/dataStore/foo" -X DELETE -u admin:district -v</pre><p>Example
        response:</p><pre class="screen">{
    "httpStatus": "OK",
    "httpStatusCode": 200,
    "status": "OK",
    "message": "Namespace 'foo' deleted."
}</pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e12740"></a>1.67.&nbsp;User data store</h2></div></div></div><p>In addition to the <span class="emphasis"><em>dataStore</em></span> which is shared between all users of the
      system, a user-based data store is also available. Data stored to the
        <span class="emphasis"><em>userDataStore</em></span> is associated with individual users, so that each user
      can have different data on the same namespace and key combination. All calls against the
        <span class="emphasis"><em>userDataStore</em></span> will be associated with the logged in user. This means
      one can only see, change, remove and add values associated with the currently logged in
      user.</p><pre class="screen">/api/userDataStore</pre><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e12756"></a>1.67.1.&nbsp;User data store structure</h3></div></div></div><p><span class="emphasis"><em>userDataStore</em></span> consists of a user, a namespace, keys and associated
        values. The combination of user, namespace and key is unique.</p><div class="table"><a name="d6099e12763"></a><p class="title"><b>Table&nbsp;1.94.&nbsp;User data store structure</b></p><div class="table-contents"><table class="table" summary="User data store structure" border="1"><colgroup><col class="newCol1"><col class="c1"><col class="c2"></colgroup><thead><tr><th>Item</th><th>Description</th><th>Data Type</th></tr></thead><tbody><tr><td>User</td><td>The user this data is associated with</td><td>String</td></tr><tr><td>Namespace</td><td>The namespace the key belongs to</td><td>String</td></tr><tr><td>Key</td><td>The key a value is stored on</td><td>String</td></tr><tr><td>Value</td><td>The value stored</td><td>JSON</td></tr><tr><td>Encrypted</td><td>Indicates whether the value should be encrypted</td><td>Boolean</td></tr></tbody></table></div></div><p><br class="table-break"></p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e12814"></a>1.67.2.&nbsp;Get namespaces</h3></div></div></div><p>Returns an array of all existing
        namespaces</p><pre class="screen">GET /api/userDataStore</pre><p>Example
        request:</p><pre class="screen">curl -X GET -H "Content-Type: application/json" -u admin:district "play.dhis2.org/api/userDataStore" -v</pre><p>
        </p><pre class="screen">[
  "foo",
  "bar"
]</pre><p>
      </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e12830"></a>1.67.3.&nbsp;Get keys</h3></div></div></div><p>Returns an array of all existing keys in a given
        namespace</p><pre class="screen">GET /api/userDataStore/&lt;namespace&gt;</pre><p>Example request:</p><p>
        </p><pre class="screen">curl -X GET -H "Content-Type: application/json" -u admin:district "play.dhis2.org/api/userDataStore/foo" -v</pre><p>
        </p><pre class="screen">[
  "key_1",
  "key_2"
]</pre><p>
      </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e12847"></a>1.67.4.&nbsp;Get value</h3></div></div></div><p>Returns the value for a given namespace and
        key</p><pre class="screen">GET /api/userDataStore/&lt;namespace&gt;/&lt;key&gt;</pre><p>Example
        request:</p><pre class="screen">curl -X GET -H "Content-Type: application/json" -u admin:district "play.dhis2.org/api/userDataStore/foo/bar"</pre><pre class="screen">{
  "some": "value"
}</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e12860"></a>1.67.5.&nbsp;Add new value</h3></div></div></div><p>Adds a new value to a given key in a given
        namespace.</p><pre class="screen">POST /api/userDataStore/&lt;namespace&gt;/&lt;key&gt;</pre><p>Example
        request:</p><pre class="screen">curl -X POST -H "Content-Type: application/json" -u admin:district -d "['some value']" "play.dhis2.org/api/userDataStore/foo/bar"</pre><pre class="screen">{
  "httpStatus": "Created",
  "httpStatusCode": 201,
  "status": "OK",
  "message": "Key 'bar' in namespace 'foo' created."
}</pre><p>If you require the value to be encrypted (For example user credetials and such) you can
        append a query to the url like
        this:</p><pre class="screen">GET /api/userDataStore/&lt;namespace&gt;/&lt;key&gt;?encrypt=true</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e12877"></a>1.67.6.&nbsp;Update existing value</h3></div></div></div><p>Updates an existing
        value</p><pre class="screen">PUT /api/userDataStore/&lt;namespace&gt;/&lt;key&gt;</pre><p>Example
        request:</p><pre class="screen">curl -X PUT -H "Content-Type: application/json" -u admin:district -d "['new value']" "play.dhis2.org/api/userDataStore/foo/bar"</pre><pre class="screen">{
  "httpStatus":"Created",
  "httpStatusCode":201,
  "status":"OK",
  "message":"Key 'bar' in namespace 'foo' updated."
}</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e12890"></a>1.67.7.&nbsp;Delete key</h3></div></div></div><p>Delete a key</p><pre class="screen">DELETE /api/userDataStore/&lt;namespace&gt;/&lt;key&gt;</pre><p>Example
        request:</p><pre class="screen">curl -X DELETE -u admin:district "play.dhis2.org/api/userDataStore/foo/bar"</pre><pre class="screen">{
  "httpStatus":"OK",
  "httpStatusCode":200,
  "status":"OK",
  "message":"Key 'bar' deleted from the namespace 'foo."}</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e12903"></a>1.67.8.&nbsp;Delete namespace</h3></div></div></div><p>Delete all keys in the given
        namespace</p><pre class="screen">DELETE /api/userDataStore/&lt;namespace&gt;</pre><p>Example
        request:</p><pre class="screen">curl -X DELETE -u admin:district "play.dhis2.org/api/userDataStore/foo"</pre><pre class="screen">{
  "httpStatus":"OK",
  "httpStatusCode":200,
  "status":"OK",
  "message":"All keys from namespace 'foo' deleted."}</pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e12916"></a>1.68.&nbsp;Metadata repository</h2></div></div></div><p>DHIS 2 provides a metadata repository containing metadata packages with various content. A
      metadata package is a </p><p>To retrieve an index over available metadata packages you can issue a GET request to the
        <span class="italic">metadataRepo</span>
      resource:</p><pre class="screen">GET /api/synchronization/metadataRepo</pre><p>A metadata package entry contains information about the package and a URL to the relevant
      package. A metadata package is simply a DXF metadata file. An index could look like
      this:</p><pre class="screen">{
  "packages": [ {
    "id": "sierre-leone-demo",
    "name": "Sierra Leone demo",
    "description": "Sierra Leone demo database",
    "version": "0.1",
    "href": "https://dhis2.org/metadata-repo/221/sierra-leone-demo/metadata.json"
  },
  {
    "id": "trainingland-org-units",
    "name": "Trainingland organisation units",
    "description": "Trainingland organisation units with four levels",
    "version": "0.1",
    "href": "https://dhis2.org/metadata-repo/221/trainingland-org-units/metadata.json"
  }
 ]
}</pre><p>A client can follow the URLs in a RESTful fashion and install a metadata package by
      supplying POST request as text/plain with the metadata package URL as the payload to the
        <span class="italic">metadataPull</span>
      resource:</p><pre class="screen">POST /api/synchronization/metadataPull</pre><p>An example curl command looks like
      this:</p><pre class="screen">curl "localhost:8080/api/synchronization/metadataPull" -X POST
-d "https://dhis2.org/metadata-repo/221/trainingland-org-units/metadata.json"
-H "Content-Type:text/plain" -u admin:district -v</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e12943"></a>1.69.&nbsp;FRED API</h2></div></div></div><p>DHIS 2 from version 2.11 implements support for the current draft of the FRED API version
      1.0. The project defines itself as <span class="quote">&#8220;<span class="quote">open standard for sharing and updating health
        facility data</span>&#8221;</span>. The full specification, including representation format and basic
      usage, can be found at <a class="link" href="http://facilityregistry.org/" target="_top">http://facilityregistry.org/</a>.</p><p>Since version 1.0 is not finalized there are parts of the current specification that has
      not been implemented as we found it not to be in a stable enough state. Most notably we do not
      currently support sorting (we do however sort on name by default) and filtering of
      facilities.</p><p>The entry point for the implementation can be found at http://&lt;server-url&gt;/api-fred
      and the current version is located at http://&lt;server-url&gt;/api-fred/v1.</p><p>This section will give some simple examples of using the API.</p><p>Get all facilities:</p><pre class="screen">curl -u username:password -X GET http://&lt;server-url&gt;/api-fred/v1/facilities.json</pre><p>Get a specific facility based on either identifier or UUID:</p><pre class="screen">curl -u username:password -X GET http://&lt;server-url&gt;/api-fred/v1/facilities/&lt;id&gt;.json
curl -u username:password -X GET http://&lt;server-url&gt;/api-fred/v1/facilities/&lt;uuid&gt;.json</pre><p>Create a new facility:</p><pre class="screen">curl -u username:password -X POST -d @new_facility.json
  -H "Content-Type: application/json" http://&lt;server-url&gt;/api-fred/v1/facilities.json</pre><p>Update a facility:</p><pre class="screen">curl -u username:password -X POST -d @updated_facility.json
  -H "Content-Type: application/json" http://&lt;server-url&gt;/api-fred/v1/facilities/&lt;id&gt;.json

curl -u username:password -X POST -d @updated_facility.json
  -H "Content-Type: application/json" http://&lt;server-url&gt;/api-fred/v1/facilities/&lt;uuid&gt;.json</pre></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="d6099e12976"></a>Chapter&nbsp;2.&nbsp;Apps</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="section"><a href="#d6099e12993">2.1. Purpose of packaged Apps</a></span></dt><dt><span class="section"><a href="#d6099e13000">2.2. Creating Apps</a></span></dt><dt><span class="section"><a href="#d6099e13104">2.3. Installing Apps into DHIS 2</a></span></dt><dt><span class="section"><a href="#d6099e13119">2.4. Launching Apps</a></span></dt><dt><span class="section"><a href="#d6099e13124">2.5. Adding the DHIS 2 menu to your app</a></span></dt></dl></div><p>A packaged app is an <a class="link" href="https://developer.mozilla.org/en-US/docs/Open_Web_apps_and_Web_standards" target="_top">Open Web
      App</a> that has all of its resources (HTML, CSS, JavaScript, app manifest, and so on)
    contained in a zip file. It can be uploaded to a DHIS 2 installation directly through the user
    interface at runtime. A packaged app is a ZIP file with an <a class="link" href="http://www.w3.org/2008/webapps/manifest/" target="_top">app manifest</a> in its root directory. The
    manifest must be named <code class="filename">manifest.webapp</code>. A throrough description of apps can
    be obtained <a class="link" href="https://developer.mozilla.org/en-US/Apps/Quickstart" target="_top">here</a>.</p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e12993"></a>2.1.&nbsp;Purpose of packaged Apps</h2></div></div></div><p>The purpose of packaged apps is to extend the web interface of DHIS 2, without the need to
      modify the source code of DHIS 2 itself. A system deployment will often have custom and unique
      requirements. The apps provide a convenient extension point to the user interface. Through
      apps, you can complement and customize the DHIS 2 core functionality with custom solutions in
      a loosely coupled and clean manner.</p><p>Apps do not have permissions to interact directly with DHIS 2 Java API. Instead, apps are
      expected to use functionality and interact with the DHIS 2 services and data by utilizing the
      DHIS 2 Web API.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e13000"></a>2.2.&nbsp;Creating Apps</h2></div></div></div><p>DHIS 2 apps are constructed with HTML, JavaScript and CSS files, similar to any other web
      application. Apps also need a special file called <span class="italic">manifest.webapp</span> which describes the contents of the app. This file should be in
      the format specified by the <a class="link" href="http://www.w3.org/2008/webapps/manifest/" target="_top">W3C Manifest
        for Web Applications</a>. A basic example of the <span class="italic">manifest.webapp</span> is shown below:</p><p>
      </p><pre class="screen">{
    "version": "0.1",
    "name": "My App",
    "description": "My App is a Packaged App",
    "launch_path": "/index.html",
    "appType": "APP",
    "icons": {
        "16": "/img/icons/mortar-16.png",
        "48": "/img/icons/mortar-48.png",
        "128": "/img/icons/mortar-128.png"
    },
    "developer": {
        "name": "Me",
        "url": "http://me.com"
    },
    "default_locale": "en",
    "activities": {
        "dhis": {
            "href": "*"
        }
    }
}</pre><p>
    </p><p>The <span class="italic">manifest.webapp</span> file must be located at the root of
      the project. Among the properties, the <span class="italic">icons&#8594;48</span>
      property is used for the icon that is displayed on the list of apps that are installed on a
      DHIS 2 instance. The <span class="italic">activities</span> property is an
      dhis-specific extension meant to differentiate between a standard Open Web App and an app that
      can be installed in DHIS 2. The <span class="italic">*</span> value for <span class="italic">href</span> is converted to the appropriate URL when the app is uploaded
      and installed in DHIS 2. This value can then be used by the application's JavaScript and HTML
      files to make calls to the DHIS 2 Web API and identify the correct location of DHIS 2 server
      on which the app has been installed. To clarify, the <span class="italic">activities</span> part will look similar to this after the app has been
      installed:</p><pre class="screen">"activities": {
    "dhis": {
        "href": "http://apps.dhis2.org/demo"
    }
 }</pre><p>The <span class="emphasis"><em>appType</em></span> property specifies how the app will be displayed by the
      DHIS 2 instance. The possible values for appType and their effects are explained in the
      following table.</p><p>
      </p><div class="table"><a name="d6099e13048"></a><p class="title"><b>Table&nbsp;2.1.&nbsp;App types</b></p><div class="table-contents"><table class="table" summary="App types" border="1"><colgroup><col class="c1"><col class="c2"></colgroup><thead><tr><th>App type</th><th>Description</th></tr></thead><tbody><tr><td>APP</td><td>Will be listed in the "apps" menu</td></tr><tr><td>DASHBOARD_WIDGET</td><td>Available from the search box on the dashboard, can be added as an item on any
                dashboard</td></tr><tr><td>TRACKER_DASHBOARD_WIDGET</td><td>Can be embedded in the tracker dashboard <span class="emphasis"><em>(this type is not yet
                  supported)</em></span></td></tr><tr><td>RESOURCE</td><td>Resource apps are packages that can be shared by multiple other apps. These
                apps are not shown anywhere in the UI, except from in the app management
                app.</td></tr></tbody></table></div></div><p><br class="table-break">
    </p><p>If no <span class="emphasis"><em>appType</em></span> is specified in the manifest, the system will use "APP"
      by default.</p><p>To read the JSON structure into Javascript, you can use a regular AJAX request and parse
      the JSON into an object. Most Javascript libraries provide some support, for instance with
      jQuery it can be done like this:</p><pre class="screen">$.getJSON( "manifest.webapp", function( json ) {
    var apiBaseUrl = json.activities.dhis.href + "/api";
} );</pre><p>The app can contain HTML, Javascript, CSS, images and other files whic may be required to support it . The file structure could look
      something like this:</p><pre class="screen">/
/manifest.webapp    #manifest file (mandatory)
/css/               #css stylesheets (optional)
/img/               #images (optional)
/js/&nbsp;               #javascripts (optional)</pre><p>Note that it is only the <code class="filename">manifest.webapp</code> file which must be placed in the root. It is up
      the developer to organize CSS, images and Javascript files inside the app as needed.</p><p>All the files in the project should be compressed into a standard zip archive. Note that
      the manifest.webapp file must be located on the root of the zip archive (do not include a
      parent directory in the archive). The zip archive can then be installed into DHIS 2 as you
      will see in the next section.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e13104"></a>2.3.&nbsp;Installing Apps into DHIS 2</h2></div></div></div><p>Apps can be installed by uploading zip file into the App Manager. In, Services &#8594;
      Apps, click on the <span class="italic">App Store</span> menu item.
      <span class="inlinemediaobject"><img src="resources/images/apps/app-management.png"></span>
The app can be uploaded by pressing the Browse button and after selecting the zip package,
      the file is uploaded automatically and installed in DHIS 2. You can also browse through apps
      in the DHIS 2 <a class="link" href="https://www.dhis2.org/appstore" target="_top">app store</a> and download apps
      from there. The DHIS 2 app store allows for app searching, reviewing, commenting, requesting
      features, rating on the apps by the community.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e13119"></a>2.4.&nbsp;Launching Apps</h2></div></div></div><p>After installation, your apps will be integrated with the menu system and can be accessed
      under services and from the module overview page. It can also be accessed from the home page
      of the apps module.  Click on an app in the list in order to launch it.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e13124"></a>2.5.&nbsp;Adding the DHIS 2 menu to your app</h2></div></div></div><p>In order to maintain a uniform appearance within DHIS 2 it is possible to add your
      app's icon to the top menu. To begin, we start with a screenshot of the top-menu of the
      DHIS 2 user interface, where your app's icon will be placed. </p><div class="screenshot"><div class="mediaobject"><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="80%"><tr><td><img src="resources/images/apps/top-menu.png" width="100%"></td></tr></table></div></div><p>The first step is to adding the menu is including the style-sheets and scripts that are required. All JavaScript files are found in <code class="filename">/dhis-web-commons/javascripts/dhis2/</code> while the CSS files are found in <code class="filename">/dhis-web-commons/font-awesome/css/font-awesome.min.css</code> and <code class="filename">/dhis-web-commons/css/menu.css</code>
</p><p> The following list provides a description of each file:</p><p>
      <span class="bold"><strong>Scripts:</strong></span>
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="filename">jquery.min.js / jqLite / angular.element</code> : One of
            the mentioned libraries needs to be present. DHIS 2 employs a stripped-down version of
              <code class="classname">jqLite</code> that is present in <span class="emphasis"><em>Angular</em></span> for the
            menu. This makes it compatible with jqLite and jQuery. </p></li><li class="listitem"><p><code class="filename">dhis2.translate.js</code> : Translate script that
            translates menu text to your current dhis language setting</p></li><li class="listitem"><p><code class="filename">dhis2.menu.js</code> : Menu logic that deals with all
            the ordering, searching of menu items etc.</p></li><li class="listitem"><p><span class="italic">dhis2/dhis2.menu.ui.js</span> : Menu ui code that has
            all the menu user interface related code for scrolling, shortcuts, HTML markup
            etc.</p></li></ul></div><p>
      <span class="bold"><strong>Stylesheets:</strong></span>
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="filename">font-awesome.min.css</code> : Used for various icons in
            the menu.</p></li><li class="listitem"><p><code class="filename">menu.css</code> : The CSS used for the menu.</p></li><li class="listitem"><p><code class="filename">dhis2.translate.js</code> : Translate script that
            translates menu text to your current DHIS2 language setting</p></li></ul></div><p>For a app that will run using the same URL structure as the normal DHIS2 apps, only the
      JavaScript files and style-sheets are required. If your app is running using a different URL
      structure than the default one, you will need to specify a <em class="parameter"><code>base URL </code></em>before including the menu scripts. Including the scripts and style-sheets would
      look something like the following:
      </p><pre class="screen">&lt;!-- DHIS2 Settings initialization for a baseUrl that is used for the menu --&gt;
&lt;script&gt;
 window.dhis2 = window.dhis2 || {};
 dhis2.settings = dhis2.settings || {};
 dhis2.settings.baseUrl = 'dhis';
&lt;/script&gt;

&lt;!-- Menu scripts --&gt;
 &lt;script type="text/javascript" src="./dhis-web-commons/javascripts/dhis2/dhis2.translate.js"&gt;
&lt;/script&gt;
 &lt;script type="text/javascript" src="./dhis-web-commons/javascripts/dhis2/dhis2.menu.js"&gt;
&lt;/script&gt;
 &lt;script type="text/javascript" src="./dhis-web-commons/javascripts/dhis2/dhis2.menu.ui.js"&gt;&lt;/script&gt;

&lt;!-- Stylesheets related to the menu --&gt;
&lt;link type="text/css" rel="stylesheet" href="./dhis-web-commons/font-awesome/css/font-awesome.min.css"/&gt;
&lt;link type="text/css" rel="stylesheet" media="screen" href="./dhis-web-commons/css/menu.css"&gt;
    </pre><p>To clarify, the following part will initialize some variables. If you do not use any other
      DHIS2 libraries these will not be set and therefore will have to be set by you first. After
      that the third line specifies a base URL of where your DHIS 2 instance is running on your web
      server. For example: <span class="italic">dhis</span> in this case means the server is
      running at <span class="italic">http://localhost:8080/dhis/</span>. Note that you will
      only have to specify the part after the web address. So if your instance is running at
        <span class="italic">http://www.example.com/myInstance/</span> you would only specify
        <span class="italic">myInstance</span>
      </p><pre class="screen">&lt;!-- Example setting for myInstance --&gt;
&lt;script&gt;
window.dhis2 = window.dhis2 || {};
dhis2.settings = dhis2.settings || {};
dhis2.settings.baseUrl = 'myInstance';
&lt;/script&gt;</pre><p>The above will only include the necessary scripts to be able to show the menu. To actually
      make it show up we have two possibilities. The first one is using a basic &lt;div&gt; element
      with an id attribute.
      </p><pre class="screen">&lt;div id="dhisDropDownMenu"&gt;&lt;/div&gt;      </pre><p>An alternative
      is available when your application uses angular. We have included a directive to show the
      menu. This would be used as follows: </p><pre class="screen">&lt;div d2-menu&gt;&lt;/div&gt;      </pre><p>The
      element type in this case does not really matter. As long as you include the <span class="italic">d2-menu</span> directive. To be able to use the menu directive you would
      also have to include the directive in your angular app. The angular module containing the
      directive is called <span class="italic">d2Menu</span>.</p><pre class="screen">'use strict';

var appMenu = angular.module('appMenu',
  ['ngRoute', 
  'ngCookies',
  'd2Menu']);      </pre><p>The minimum amount of code to show the menu is shown below. You could use this as a
      starting reference.
      </p><pre class="screen">&lt;!DOCTYPE html&gt;
&lt;html &gt;&lt;!--ng-app="appMenu"&gt; --&gt;
    &lt;head&gt;
        &lt;title&gt;Dhis2 Menu&lt;/title&gt;

        &lt;!-- Stylesheets related to the menu --&gt;
        &lt;link type="text/css" rel="stylesheet" href="./dhis-web-commons/font-awesome/css/font-awesome.min.css"/&gt;
        &lt;link type="text/css" rel="stylesheet" media="screen" href="./dhis-web-commons/css/menu.css"&gt;
    &lt;/head&gt;

    &lt;body style="background-color: black;"&gt;

        &lt;div id="dhisDropDownMenu"&gt;&lt;/div&gt;

        &lt;!-- DHIS2 Settings initialization for a baseUrl that is used for the menu --&gt;
        &lt;script&gt;
            window.dhis2 = window.dhis2 || {};
            dhis2.settings = dhis2.settings || {};
            dhis2.settings.baseUrl = 'dhis';
        &lt;/script&gt;

        &lt;!-- Menu scripts --&gt;
        &lt;script type="text/javascript" src="./dhis-web-commons/javascripts/jQuery/jquery.min.js"&gt;&lt;/script&gt;
        &lt;script type="text/javascript" src="./dhis-web-commons/javascripts/dhis2/dhis2.translate.js"&gt;&lt;/script&gt;
        &lt;script type="text/javascript" src="./dhis-web-commons/javascripts/dhis2/dhis2.menu.js"&gt;&lt;/script&gt;
        &lt;script type="text/javascript" src="./dhis-web-commons/javascripts/dhis2/dhis2.menu.ui.js"&gt;&lt;/script&gt;

    &lt;/body&gt;
&lt;/html&gt;</pre></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="d6099e13241"></a>Chapter&nbsp;3.&nbsp;Infrastructure</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="section"><a href="#d6099e13245">3.1. Release process</a></span></dt></dl></div><p></p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e13245"></a>3.1.&nbsp;Release process</h2></div></div></div><p>Checklist for release.</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>In order to tag  the source source code with new release. First temporarily add a dependency to
            dhis-web in the root pom.xml:</p><pre class="screen">&lt;module&gt;dhis-web&lt;/module&gt;</pre><p>Use the mvn
            version plugin with:</p><pre class="screen">mvn versions:set
mvn versions:commit</pre><p>This will prompt you to enter the version. Remove the dhis-web dependency. Update
            application cache manifests in the various apps to new version. Commit the changes to
            trunk.</p></li><li class="listitem"><p>Push a release branch to Launchad, e.g. with:</p><pre class="screen">bzr push lp:~dhis2-devs-core/dhis2/2.19</pre></li><li class="listitem"><p>Tag source code with SNAPSHOT release. Remember to add the temporary dhis-web
            dependency in the root pom.xml. Commit the changes to trunk.</p></li><li class="listitem"><p>Enable email notifications for release branch.</p></li><li class="listitem"><p>Create Jenkins build for the release WAR file.</p></li><li class="listitem"><p>Create Jenkins build for the release Javadocs.</p></li><li class="listitem"><p>Create automatic copy job for WAR file from Jenkins to dhis2.org.</p></li><li class="listitem"><p>Create automatic WAR file update of play.dhis2.org/demo and play.dhis2.org/dev
            systems.</p></li><li class="listitem"><p>Update the database and WAR file on play.dhis2.org/demo and play.dhis2.org/dev
            instances. To create a dump in directory format and turn it into a tar
            file:</p><pre class="screen">pg_dump dhis2 -Fd -U dhis -j 4 -f db.pgdump
tar zcvf db.tar.gz db.pgdump</pre><p>To unpack the tar file:</p><pre class="screen">tar zxvf db.tar.gz</pre><p>Run reinit-db-instance to make the changes take effect.</p></li><li class="listitem"><p>Create a new DHIS 2 Live package on dhis2.org and place it in download/live
            directory. Only the WAR file must be updated. An uncompressed Live package is located on
            the demo server at:</p><pre class="screen">/home/dhis/dhis-live-package</pre><p>Replace the uncompressed WAR file with the new release. Make a compressed Live
            archive and move to /download/live directory.</p></li><li class="listitem"><p>Upload sample database to dhis2.org and place it in download/resources
            directory.</p></li><li class="listitem"><p>Update download page at www.dhis2.org/downloads with links to new Live package, WAR
            file, source code branch page and sample data including version.</p></li><li class="listitem"><p>Add stable WAR file download link in nginx.conf on dhis2.org.</p></li><li class="listitem"><p>Create a documentation branch and update documentation page at
            www.dhis2.org/documentation with links to documentation and Javadocs.</p></li><li class="listitem"><p>Write and send release email.</p></li></ol></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="d6099e13317"></a>Chapter&nbsp;4.&nbsp;DHIS 2 Technical Architecture</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="section"><a href="#technicalOverview">4.1. Overview</a></span></dt><dt><span class="section"><a href="#technicalRequirements">4.2. Technical Requirements</a></span></dt><dt><span class="section"><a href="#technicalStructure">4.3. Project Structure</a></span></dt><dt><span class="section"><a href="#d6099e13386">4.4. Project Dependencies</a></span></dt><dt><span class="section"><a href="#technicalDataModel">4.5. The Data Model</a></span></dt><dt><span class="section"><a href="#technicalPersistenceLayer">4.6.  The Persistence Layer </a></span></dt><dt><span class="section"><a href="#technicalBusinessLayer">4.7.  The Business Layer </a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e13447">4.7.1. The JDBC Service Project</a></span></dt><dt><span class="section"><a href="#d6099e13516">4.7.2. The Data Mart Project</a></span></dt><dt><span class="section"><a href="#d6099e13720">4.7.3. The Reporting Project</a></span></dt><dt><span class="section"><a href="#d6099e13957">4.7.4. The System Support Project</a></span></dt></dl></dd><dt><span class="section"><a href="#technicalPresentationLayer">4.8.  The Presentation Layer </a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e13978">4.8.1. The Portal</a></span></dt></dl></dd><dt><span class="section"><a href="#technicalFrameworkStack">4.9.  Framework Stack </a></span></dt><dd><dl><dt><span class="section"><a href="#d6099e14054">4.9.1. Application Frameworks</a></span></dt><dt><span class="section"><a href="#d6099e14102">4.9.2. Development Frameworks</a></span></dt></dl></dd><dt><span class="section"><a href="#d6099e14118">4.10. Definitions</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="technicalOverview"></a>4.1.&nbsp;Overview</h2></div></div></div><p>This document outlines the technical architecture for the District Health Information Software 2 (DHIS 2). The DHIS 2 is a routine data based health information system which allows for data capture, aggregation, analysis, and reporting of data. </p><p>DHIS 2 is written in Java and has a three-layer architecture. The presentation layer is web-based, and the system can be used on-line as well as stand-alone.</p><div class="screenshot"><div class="mediaobject" align="center"><img src="resources/images/dhis2_technical_architecture/over_view.jpg" align="middle"></div></div><p>Fig. Overall architecture</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="technicalRequirements"></a>4.2.&nbsp;Technical Requirements</h2></div></div></div><p>The DHIS 2 is intended to be installed and run on a variety of platforms. Hence the system is designed for industry standards regarding database management systems and application servers. The system should be extensible and modular in order to allow for third-party and peripheral development efforts. Hence a pluggable architecture is needed. The technical requirements are:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Ability to run on any major database management system</p></li><li class="listitem"><p>Ability to run on any J2EE compatible servlet container</p></li><li class="listitem"><p>Extensibility and modularity in order to address local functional requirements</p></li><li class="listitem"><p>Ability to run on-line/on the web</p></li><li class="listitem"><p>Flexible data model to allow for a variety of data capture requirements</p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="technicalStructure"></a>4.3.&nbsp;Project Structure</h2></div></div></div><p>DHIS 2 is made up of 42 Maven projects, out of which 18 are web modules. The root POM is located in <code class="filename">/dhis-2</code> and contains project aggregation for all projects excluding the <code class="filename">/dhis-2/dhis-web</code> folder. The <code class="filename">/dhis-2/dhis-web</code> folder has a web root POM which contains project aggregation for all projects within that folder. The contents of the modules are described later on.</p><div class="screenshot"><div class="mediaobject" align="center"><img src="resources/images/dhis2_technical_architecture/project_structure.jpg" align="middle"></div></div><p>Fig. Project structure</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e13386"></a>4.4.&nbsp;Project Dependencies</h2></div></div></div><p>Dependencies between the projects are structured in five layers. The support modules provide support functionality for the core and service modules, related to Hibernate, testing, JDBC, and the file system. The core module provides the core functionality in the system, like persistence and business logic for the central domain objects. The service modules provide business logic for services related to reporting, import-export, mapping, and administration. The web modules are self-contained web modules. The portal is a wrapper web module which assembles all the web modules. Modules from each layer can only have dependencies to modules at the same layer or the layer right below.</p><div class="mediaobject" align="center"><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="60%"><tr><td align="center"><img src="resources/images/dhis2_technical_architecture/dependency_structure.jpg" align="middle" width="100%"></td></tr></table></div><p>The internal structure of the service layer is divided in five layers.</p><div class="mediaobject" align="center"><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="60%"><tr><td align="center"><img src="resources/images/dhis2_technical_architecture/service-dependency-structure.jpg" align="middle" width="100%"></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="technicalDataModel"></a>4.5.&nbsp;The Data Model</h2></div></div></div><p>The data model is flexible in all dimensions in order to allow for capture of any item of data. The model is based on the notion of a DataValue. A DataValue can be captured for any DataElement (which represents the captured item, occurrence or phenomena), Period (which represents the time dimension), and Source (which represents the space dimension, i.e. an organisational unit in a hierarchy).</p><div class="figure"><a name="d6099e13404"></a><p class="title"><b>Figure&nbsp;4.1.&nbsp;Data values</b></p><div class="figure-contents"><div class="mediaobject"><img src="resources/images/dhis2_technical_architecture/data_value_diagram.jpg" alt="Data values"></div></div></div><br class="figure-break"><p>A central concept for data capture is the DataSet. The DataSet is a collection of DataElements for which there is entered data presented as a list, a grid and a custom designed form. A DataSet is associated with a PeriodType, which represents the frequency of data capture.</p><p>A central concept for data analysis and reporting is the Indicator. An Indicator is basically a mathematical formula consisting of DataElements and numbers. An Indicator is associated with an IndicatorType, which indicates the factor of which the output should be multiplied with. A typical IndicatorType is percentage, which means the output should be multiplied by 100. The formula is split into a numerator and denominator.</p><p>Most objects have corresponding group objects, which are intended to improve and enhance data analysis. The data model source code can be found in the API project and could be explored in entirety there. A selection of the most important objects can be view in the diagram below.</p><div class="figure"><a name="d6099e13416"></a><p class="title"><b>Figure&nbsp;4.2.&nbsp;Core Diagram</b></p><div class="figure-contents"><div class="mediaobject" align="center"><img src="resources/images/dhis2_technical_architecture/core_diagram.jpg" align="middle" alt="Core Diagram"></div></div></div><br class="figure-break"></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="technicalPersistenceLayer"></a>4.6.&nbsp; The Persistence Layer </h2></div></div></div><p>The persistence layer is based on Hibernate in order to achieve the ability to run on any major DBMS. Hibernate abstracts the underlying DBMS away and let you define the database connection properties in a file called hibernate.properties. </p><p>DHIS 2 uses Spring-Hibernate integration, and retrieves a SessionFactory through Spring&#8217;s LocalSessionFactoryBean. This LocalSessionFactoryBean is injected with a custom HibernateConfigurationProvider instance which fetches Hibernate mapping files from all modules currently on the classpath. All store implementations get injected with a SessionFactory and use this to perform persistence operations.</p><p>Most important objects have their corresponding Hibernate store implementation. A store provides methods for CRUD operations and queries for that object, e.g. HibernateDataElementStore which offers methods such as <span class="italic">addDataElement( DataElement ), deleteDataElement( DataElement ), getDataElementByName( String )</span>, etc.</p><div class="screenshot"><div class="mediaobject" align="center"><img src="resources/images/dhis2_technical_architecture/persistence_layer.jpg" align="middle"></div></div><p>Fig. Persistence layer</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="technicalBusinessLayer"></a>4.7.&nbsp; The Business Layer </h2></div></div></div><p>All major classes, like those responsible for persistence, business logic, and presentation, are mapped as Spring managed beans. &#8220;Bean&#8221; is Spring terminology and simply refers to a class that is instantiated, assembled, and otherwise managed by the Spring IoC container. Dependencies between beans are injected by the IoC container, which allows for loose coupling, re-configuration and testability. For documentation on Spring, please refer to springframework.org.</p><p>The services found in the dhis-service-core project basically provide methods that delegate to a corresponding method in the persistence layer, or contain simple and self-explanatory logic. Some services, like the ones found in the dhis-service-datamart, dhis-service-import-export,  dhis-service-jdbc, and dhis-service-reporting projects are more complex and will be elaborated in the following sections.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e13447"></a>4.7.1.&nbsp;The JDBC Service Project</h3></div></div></div><p>The JDBC service project contains a set of components dealing with JDBC connections and SQL statements.</p><div class="screenshot"><div class="mediaobject" align="center"><img src="resources/images/dhis2_technical_architecture/JDBC_BatchHandler_diagram.jpg" align="middle"></div></div><p>Fig. JDBC BatchHandler diagram</p><p>The <span class="italic">BatchHandler</span> interface provides methods for inserting, updating and verifying the existence of objects. The purpose is to provide high-performance operations and is relevant for large amounts of data. The BatchHandler object inserts objects using the <span class="italic">multiple insert SQL</span> syntax behind the scenes and can insert thousands of objects on each database commit. A typical use-case is an import process where a class using the BatchHandler interface will call the <span class="italic">addObject( Object, bool ) </span>method for every import object. The BatchHandler will after an appropriate number of added objects commit to the database transparently. A BatchHandler can be obtained from the <span class="italic">BatchHandlerFactor</span>y component. BatchHandler implementations exist for most objects in the API.</p><p>The <span class="italic">JdbcConfiguration</span> interface holds information about the current DBMS JDBC configuration, more specifically dialect, driver class, connection URL, username and password. A JdbcConfiguration object is obtained from the <span class="italic">JdbcConfigurationProvider</span> component, which currently uses the internal Hibernate configuration provider to derive the information.</p><p>The <span class="italic">StatementBuilder</span> interface provides methods that represents SQL statements. A StatementBuilder object is obtained from the <span class="italic">StatementBuilderFactory</span>, which is able to determine the current runtime DBMS and provide an appropriate implementation. Currently implementations exist for PostgreSQL, MySQL, H2, and Derby.</p><p>The <span class="italic">IdentifierExtractor</span> interface provides methods for retrieving the last generated identifiers from the DBMS. An IdentifierExtractor is obtained from the <span class="italic">IdentifierExtractorFactory</span>, which is able to determine the runtime DBMS and provide an appropriate implementation.</p><div class="screenshot"><div class="mediaobject" align="center"><img src="resources/images/dhis2_technical_architecture/JDBC_statement_manager_diagram.jpg" align="middle"></div></div><p>Fig. JDBC StatementManager diagram</p><p>The <span class="italic">StatementHolder</span> interface holds and provides JDBC connections and statements. A StatementHolder object can be obtained from the <span class="italic">StatementManager</span> component. The StatementManager can be initialized using the<span class="italic"> initalise()</span> method closed using the <span class="italic">destroy()</span> method. When initialized, the StatementManager will open a database connection and hold it in a ThreadLocal variable, implying that all subsequent requests for a StatementHolder will return the same instance. This can be used to improve performance since a database connection or statement can be reused for multiple operations. The StatementManager is typically used in the persistence layer for classes working directly with JDBC, like the DataMartStore.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e13516"></a>4.7.2.&nbsp;The Data Mart Project</h3></div></div></div><p>The data mart component is responsible for producing aggregated data from the raw data in the time and space dimension. The aggregated data is represented by the <span class="italic">AggregatedDataValue</span> and <span class="italic">AggregatedIndicatorValue</span> objects. The <span class="italic">DataSetCompletenessResult</span> object is also included in the data mart and is discussed in the section covering the reporting project. These objects and their corresponding database tables are referred to as the<span class="italic"> data mart.</span></p><p>The following section will list the rules for aggregation in DHIS 2.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Data is a aggregated in the time and space dimension. The time dimension is represented by the Period object and the space dimension by the OrganisationUnit object, organised in a parent-child hierarchy.</p></li><li class="listitem"><p>Data registered for all periods which intersects with the aggregation start and end date is included in the aggregation process. Data for periods which are not fully within the aggregation start and end date is weighed according to a factor &#8220;number of days within aggregation period / total number of days in period&#8221;.</p></li><li class="listitem"><p>Data registered for all children of the aggregation OrganisationUnit is included in the aggregation process.</p></li><li class="listitem"><p>Data registered for a data element is aggregated based on the aggregation operator and data type of the data element. The aggregation operator can be <span class="italic">sum </span>(values are summarized), <span class="italic">average</span> (values are averaged) and <span class="italic">count</span> (values are counted). The data type can be <span class="italic">string</span> (text), <span class="italic">int</span> (number), and <span class="italic">bool</span> (true or false). Data of type <span class="italic">string</span> can not be aggregated. </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>Aggregated data of type <span class="italic">sum</span> &#8211; <span class="italic">int</span> is presented as the summarized value. </p></li><li class="listitem"><p>Aggregated data of type <span class="italic">sum</span> &#8211; <span class="italic">bool</span> is presented as the number of true registrations. </p></li><li class="listitem"><p>Aggregated data of type <span class="italic">average</span> &#8211; <span class="italic">int</span> is presented as the averaged value.</p></li><li class="listitem"><p>Aggregated data of type <span class="italic">average</span> &#8211; <span class="italic">bool</span> is presented as a percentage value of true registrations in proportion to the total number of registrations.</p></li></ul></div></li><li class="listitem"><p>An indicator represents a formula based on data elements. Only data elements with aggregation operator <span class="italic">sum</span> or <span class="italic">average</span> and with data type <span class="italic">int</span> can be used in indicators. Firstly, data is aggregated for the data elements included in the indicator. Finally, the indicator formula is calculated.</p></li><li class="listitem"><p>A calculated data element represents a formula based on data elements. The difference from indicator is that the formula is on the form &#8220;data element * factor&#8221;. The aggregation rules for indicator apply here as well.</p></li></ul></div><div class="screenshot"><div class="mediaobject" align="center"><img src="resources/images/dhis2_technical_architecture/data_mart_diagram.jpg" align="middle"></div></div><p>Fig. Data mart diagram</p><p>The <span class="italic">AggregationCache</span> component provides caching in ThreadLocal variables. This caching layer is introduced to get optimal caching [9]. The most frequently used method calls in the data mart component is represented here.</p><p>The <span class="italic">DataElementAggregator</span> interface is responsible for retrieving data from the crosstabulated temporary storage and aggregate data in the time and space dimension. This happens according to the combination of data element aggregation operator and data type the class represents. One implementation exist for each of the four variants of valid combinations, namely <span class="italic">SumIntDataElementAggregator</span>, <span class="italic">SumBoolDataElementAggregator</span>, <span class="italic">AverageIntDataElementAggregator</span> and <span class="italic">AverageBoolAggregtor</span>. </p><p>The <span class="italic">DataElementDataMart</span> component utilizes a <span class="italic">DataElementAggregator</span> and is responsible for writing aggregated data element data to the data mart for a given set of data elements, periods, and organisation units.</p><p>The <span class="italic">IndicatorDataMart</span> component utilizes a set of <span class="italic">DataElementAggregators</span> and is responsible for writing aggregated indicator data to the data mart for a given set of indicators, periods, and organisation units.</p><p>The <span class="italic">CalculatedDataElementDataMart</span> component utilizes a set of <span class="italic">DataElementAggregators</span> and is responsible for writing aggregated data element data to the data mart for a given set of calculated data elements, periods, and organisation units.</p><p>The <span class="italic">DataMartStore</span> is responsible for retrieving aggregated data element and indicator data, and data from the temporary crosstabulated storage.</p><p>The <span class="italic">CrossTabStore</span> is responsible for creating, modifying and dropping the temporary crosstabulated table. The CrossTabService is responsible for populating the temporary crosstabulated table. This table is used in an intermediate step in the aggregation process. The raw data is de-normalized on the data element dimension, in other words the crosstabulated table gets one column for each data element. This step implies improved performance since the aggregation process can be executed against a table with a reduced number of rows compared to the raw data table.</p><p>The <span class="italic">DataMartService</span> is the central component in the data mart project and controls the aggregation process. The order of operations is:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Existing aggregated data for the selected parameters is deleted.</p></li><li class="listitem"><p>The temporary crosstabulated table is created and populated using the <span class="italic">CrossTabService</span> component.</p></li><li class="listitem"><p>Data element data for the previously mentioned valid variants is exported to the data mart using the <span class="italic">DataElementDataMart</span> component.</p></li><li class="listitem"><p>Indicator data is exported to the data mart using the <span class="italic">IndicatorDataMart</span> component.</p></li><li class="listitem"><p>Calculated data element data is exported to the data mart using the <span class="italic">CalculatedDataElementDataMart</span> component.</p></li><li class="listitem"><p>The temporary crosstabulated table is removed.</p></li></ul></div><p>The data element tables are called &#8220;aggregateddatavalue&#8221; and &#8220;aggregatedindicatorvalue&#8221; and are used both inside DHIS 2 for e.g. report tables and by third-party reporting applications like MS Excel.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e13720"></a>4.7.3.&nbsp;The Reporting Project</h3></div></div></div><p>The reporting project contains components related to reporting, which will be described in the following sections.</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="d6099e13725"></a>4.7.3.1.&nbsp;Report table</h4></div></div></div><p>The <span class="italic">ReportTable</span> object represents a crosstabulated database table. The table can be crosstabulated on any number of its three dimensions, which are the descriptive dimension (which can hold data elements, indicators, or data set completeness), <span class="italic">period</span> dimension, and <span class="italic">organisation</span><span class="italic"> unit</span> dimension. The purpose is to be able to customize tables for later use either in third-party reporting tools like BIRT or directly in output formats like PDF or HTML inside the system. Most of the logic related to crosstabulation is located in the ReportTable object. A ReportTable can hold:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Any number of data elements, indicators, data sets, periods, and organisation units.</p></li><li class="listitem"><p>A <span class="italic">RelativePeriods</span> object, which holds 10 variants of relative periods. Examples of such periods are<span class="italic"> last 3 months</span>, <span class="italic">so far this year</span>, and <span class="italic">last 3 to 6 months</span>. These periods are relative to the reporting month. The purpose of this is to make the report table re-usable in time, i.e. avoid the need for the user to replace periods in the report table as time goes by.</p></li><li class="listitem"><p>A <span class="italic">ReportParams</span> object, which holds report table parameters for reporting month, parent organisation unit, and current organisation unit. The purpose is to make the report table re-usable across the organisation unit hierarchy and in time, i.e. make it possible for the user to re-use the report table across organisation units and as time goes by.</p></li><li class="listitem"><p>User options such as regression lines. Value series which represents regression values can be included when the report table is crosstabulated on the period dimension.</p></li></ul></div><div class="mediaobject" align="center"><img src="resources/images/dhis2_technical_architecture/report_table_diagram.jpg" align="middle"></div><p>Fig. Report table diagram</p><p>The <span class="italic">ReportTableStore</span> is responsible for persisting ReportTable objects, and currently has a Hibernate implementation.</p><p>The <span class="italic">ReportTableService</span> is responsible for performing business logic related to report tables such as generation of relative periods, as well as delegating CRUD operations to the <span class="italic">ReportTableStore</span>.</p><p>The <span class="italic">ReportTableManager</span> is responsible for creating and removing report tables, as well as retrieving data.</p><p>The <span class="italic">ReportTableCreator</span> is the key component, and is responsible for:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Exporting relevant data to the data mart using the <span class="italic">DataMartExportService</span> or the <span class="italic">DataSetCompletenessService</span>. Data will later be retrieved from here and used to populate the report table.</p></li><li class="listitem"><p>Create the report table using the <span class="italic">ReportTableManager</span>.</p></li><li class="listitem"><p>Include potential regression values.</p></li><li class="listitem"><p>Populate the report table using a <span class="italic">BatchHandler</span>.</p></li><li class="listitem"><p>Remove the report table using the <span class="italic">ReportTableManager</span>.</p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="d6099e13828"></a>4.7.3.2.&nbsp;Chart</h4></div></div></div><div class="mediaobject" align="center"><img src="resources/images/dhis2_technical_architecture/chart_diagram.jpg" align="middle"></div><p>The <span class="italic">Chart</span> object represents preferences for charts. Charts are either <span class="italic">period based</span> or <span class="italic">organisation unit based</span>. A chart has tree dimensions, namely the <span class="italic">value, category</span>, and <span class="italic">filter</span> dimension. The value dimension contains any numbers of indicators. In the period based chart, the category dimension contains any number of periods while the filter dimension contains a single organisation unit. In the organisation unit based chart, the category dimension contains any number of organisation units while the filter dimension contains a single period. Two types of charts are available, namely bar charts and line charts. Charts are materialized using the JFreeChart library. The bar charts are rendered with a BarRenderer [2], the line charts with a LineAndShapeRenderer [2], while the data source for both variants is a DefaultCategoryDataSet [3]. The <span class="italic">ChartService</span> is responsible for CRUD operations, while the <span class="italic">ChartService</span> is responsible for creating JfreeCharts instances based on a <span class="italic">Chart</span> object.</p><p>Fig. Chart diagram</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="d6099e13862"></a>4.7.3.3.&nbsp;Data set completeness</h4></div></div></div><p>The purpose of the data set completeness functionality is to record the number of data sets that have been completed. The definition of when a data set is complete is subjective and based on a function in the data entry screen where the user can mark the current data set as complete. This functionality provides a percentage completeness value based on the number of reporting organisation units with completed data sets compared to the total number of reporting organisation units for a given data set. This functionality also provides the number of completed data sets reported <span class="italic">on-time</span>, more specifically reported before a defined number of days after the end of the reporting period. This date is configurable.</p><div class="mediaobject" align="center"><img src="resources/images/dhis2_technical_architecture/dataset_completeness_diagram.jpg" align="middle"></div><p>Fig. Data set completeness diagram</p><p>The <span class="italic">CompleteDataSetRegistration</span> object is representing a data set marked as complete by a user. This property holds the data set, period, organisation unit and date for when the complete registrations took place. The <span class="italic">CompleteDataSetRegistrationStore</span> is responsible for persistence of <span class="italic">CompleteDataSetRegistration</span> objects and provides methods returning collections of objects queried with different variants of data sets, periods, and organisation units as input parameters. The <span class="italic">CompleteDataSetRegistrationService</span> is mainly delegating method calls the store layer. These components are located in the dhis-service-core project.</p><p>The completeness output is represented by the <span class="italic">DataSetCompletenessResult</span> object. This object holds information about the request that produced it such as data set, period, organisation unit, and information about the data set completeness situation such as number of reporting organisation units, number of complete registrations, and number of complete registrations on-time. The <span class="italic">DataSetCompletenessService</span> is responsible for the business logic related to data set completeness reporting. It provides methods which mainly returns collections of DataSetCompletenessResults and takes different variants of period, organisation unit and data set as parameters. It uses the CompleteDataSetRegistrationService to retrieve the number of registrations, the DataSetService to retrieve the number of reporting organisation units, and performs calculations to derive the completeness percentage based on these retrieved numbers.</p><p>The <span class="italic">DataSetCompletenessExportService</span> is responsible for writing DataSetCompletenessResults to a database table called &#8220;aggregateddatasetcompleteness&#8221;. This functionality is considered to be part of the data mart as this data can be used both inside DHIS 2 for e.g. report tables and by third-party reporting applications like MS Excel. This component is retrieving data set completeness information from the <span class="italic">DataSetCompeletenessService</span> and is using the BatchHandler interface to write such data to the database.</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="d6099e13905"></a>4.7.3.4.&nbsp;Document</h4></div></div></div><p>The <span class="italic">Document</span> object represents either a <span class="italic">document</span> which is uploaded to the system or a <span class="italic">URL</span>. The <span class="italic">DocumentStore</span> is responsible for persisting <span class="italic">Document</span> objects, while the <span class="italic">DocumentService</span> is responsible for business logic.</p><div class="mediaobject" align="center"><img src="resources/images/dhis2_technical_architecture/document_diagram.jpg" align="middle"></div><p>Fig. Document diagram</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="d6099e13933"></a>4.7.3.5.&nbsp;Pivot table</h4></div></div></div><p>The PivotTable object represents a pivot table. It can hold any number of indicators, periods, organisation units, and corresponding aggregated indicator values. It offers basic pivot functionality like pivoting and filtering the table on all dimensions. The business logic related to pivot tables is implemented in Javascript and is located in the presentation layer. The <span class="italic">PivotTableService</span> is reponsible for creating and populating PivotTable objects.</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="d6099e13941"></a>4.7.3.6.&nbsp;The External Project</h4></div></div></div><p>The <span class="italic">LocationManager</span> component is responsible for the communication between DHIS 2 and the file system of the operating system. It contains methods which provide read access to files through File and InputStream instances, and write access to the file system through File and OutputStream instances. The target location is relative to a system property &#8220;dhis2.home&#8221; and an environment variable &#8220;DHIS2_HOME&#8221; in that order. This component is used e.g. by the HibernateConfigurationProvider to read in the Hibernate configuration file, and should be re-used by all new development efforts.</p><p>The <span class="italic">ConfigurationManager</span> is a component which facilitates the use of configuration files for different purposes in DHIS 2. It provides methods for writing and reading configuration objects to and from XML. The XStream library is used to implement this functionality. This component is typically used in conjunction with the <span class="italic">LocationManager</span>.</p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e13957"></a>4.7.4.&nbsp;The System Support Project</h3></div></div></div><p>The system support project contains supportive classes that are general and can be reused througout the system.</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="d6099e13962"></a>4.7.4.1.&nbsp;DeletionManager</h4></div></div></div><p>The deletion manager solution is responsible for deletion of associated objects. When an object has a depdency to another object this association needs to be removed by the application before the latter object can be deleted (unless the association is defined to be cascading in the DBMS). Often an object in a peripheral module will have an associations to a core object. When deleting the core object this association must be removed  before deleting the core object.The core module cannot have a dependency to the peripheral module however due to the system design and the problem of cyclic dependencies. The deletion manager solves this by letting all objects implement a DeletionHandler which takes care of associations to other objects. A DeletionHandler should override methods for objects that, when deleted, will affect the current object in any way. The DeletionHandler can choose to disallow the deletion completely by overriding the allowDelete* method, or choose to allow the deletion and remove the associations by overriding the delete* method. Eg. a DeletionHandler for DataElementGroup should override the deleteDataElement(..) method which should remove the DataElement from all DataElementGroups. If one decide that DataElement which are a member of any DataElementGroups cannot be deleted, it should override the allowDeleteDataElement() method and return false if there exists DataElementGroups with associations to that DataElement.</p><p>First, all DeletionHandler implementations are registered with the DeletionManager through a Spring MethodInvokingFactoryBean in the Spring config file. This solution adheres to the observer design pattern.</p><p>Second, all method invocations that should make the DeletionManager execute are mapped to the DeletionInterceptor with Spring AOP advice in the Spring config file. The DeletionInterceptor in turn invokes the execute method of the DeletionManager. First, the DeletionManager will through reflection invoke the allowDelete* method on all DeletionHandlers. If no DeletionHandlers returned false it will proceed to invoke the delete* method on all DeletionHandlers. This way all DeletionHandlers get a chance to clean up associations to the object being deleted. Finally the object itself is deleted.</p></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="technicalPresentationLayer"></a>4.8.&nbsp; The Presentation Layer </h2></div></div></div><p>The presentation layer of DHIS 2 is based on web modules which are assembled into a portal. This implies a modularized design where each module has its own domain, e.g. the dhis-web-reporting module deals with reports, charts, pivot tables, documents, while the dhis-web-maintenance-dataset module is responsible for data set management. The web modules are based on Struts and follow the MVC pattern [5]. The modules also follow the Maven standard for directory layout, which implies that Java classes are located in src/main/java, configuration files and other resources in src/main/resources, and templates and other web resources in src/main/webapp. All modules can be run as a standalone application.</p><p>Common Java classes, configuration files, and property files are located in the dhis-web-commons project, which is packaged as a JAR file. Common templates, style sheets and other web resources are located in the dhis-web-commons-resources project, which is packaged as a WAR file. These are closely related but are separated into two projects. The reason for this is that other modules must be able to have compile dependencies on the common Java code, which requires it to be packaged as a JAR file. For other modules to be able to access the common web resources, these must be packaged as a WAR file [6].</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e13978"></a>4.8.1.&nbsp;The Portal</h3></div></div></div><p>DHIS 2 uses a light-weight portal construct to assemble all web modules into one application. The portal functionality is located in the dhis-web-portal project. The portal solution is integrated with Struts, and the following section requires some prior knowledge about this framework, please refer to struts.apache.org for more information.</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="d6099e13983"></a>4.8.1.1.&nbsp;Module Assembly</h4></div></div></div><p>All web modules are packaged as WAR files. The portal uses the Maven WAR plug-in to assemble the common web modules and all web modules into a single WAR file. Which modules are included in the portal can be controlled simply through the dependency section in the POM file [7] in the dhis-web-portal project. The web module WAR files will be extracted and its content merged together.</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="d6099e13988"></a>4.8.1.2.&nbsp;Portal Module Requirements</h4></div></div></div><p>The portal requires the web modules to adhere to a few principles:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>The web resources must be located in a folder <code class="filename">src/main/webapp/&lt;module-artifact-id &gt;</code>.</p></li><li class="listitem"><p>The xwork.xml configuration file must extend the dhis-web-commons.xml configuration file.</p></li><li class="listitem"><p>The action definitions in xwork.xml for a module must be in a package where the name is &lt;module-artifact-id&gt;, namespace is /&lt;module-artifact-id&gt;, and which extends the <span class="italic">dhis-web-commons</span> package.</p></li><li class="listitem"><p>All modules must define a default action called <span class="italic">index</span>.</p></li><li class="listitem"><p>The web.xml of the module must define a redirect filter, open-session-in-view filter, security filter, and the Struts FilterDispatcher [8].</p></li><li class="listitem"><p>All modules must have dependencies to the dhis-web-commons and dhis-web-commons-resources projects.</p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="d6099e14021"></a>4.8.1.3.&nbsp;Common Look-And-Feel</h4></div></div></div><p>Common look and feel is achieved using a back-bone Velocity template which includes a page template and a menu template defined by individual actions in the web modules. This is done by using static parameters in the Struts/Xwork xwork.xml configuration file. The action response is mapped to the back-bone template called <span class="italic">main.vm</span>, while static parameters called page and menu refers to the templates that should be included. This allows the web modules to display its desired content and left side menu while maintaining a common look-and-feel.</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="d6099e14029"></a>4.8.1.4.&nbsp;Main Menu</h4></div></div></div><p>The main menu contains links to each module. Each menu link will redirect to the index action of each module. The menu is updated dynamically according to which web modules are on the classpath. The menu is visibly generated using the <span class="italic">ModuleManager</span> component, which provides information about which modules are currently included. A module is represented by the <span class="italic">Module</span> object, which holds properties about the name, package name, and default action name. The <span class="italic">ModuleManager</span> detects web modules by reading the Struts Configuration and PackageConfig objects, and derives the various module names from the name of each package definition. The <span class="italic">Module</span> objects are loaded onto the Struts value stack by Struts interceptors using the <span class="italic">ModuleManager</span>. These values are finally used in the back-bone Velocity template to produce the menu mark-up.</p></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="technicalFrameworkStack"></a>4.9.&nbsp; Framework Stack </h2></div></div></div><p>The following frameworks are used in the DHIS 2 application.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e14054"></a>4.9.1.&nbsp;Application Frameworks</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Hibernate (<a class="link" href="http://www.hibernate.org" target="_top">www.hibernate.org</a>)</p></li><li class="listitem"><p>Spring (<a class="link" href="http://www.springframework.org" target="_top">www.springframework.org</a>)</p></li><li class="listitem"><p>Struts <a class="link" href="struts.apache.org" target="_top">struts.apache.org</a></p></li><li class="listitem"><p>Velocity (<a class="link" href="http://www.velocity.apache.org" target="_top">www.velocity.apache.org</a>) </p></li><li class="listitem"><p>Commons (<a class="link" href="http://www.commons.apache.org" target="_top">www.commons.apache.org</a>) </p></li><li class="listitem"><p>JasperReports <a class="link" href="jasperforge.org/projects/jasperreports" target="_top">jasperforge.org/projects/jasperreports</a></p></li><li class="listitem"><p>JFreeChart (<a class="link" href="http://www.jfree.org/jfreechart/" target="_top">www.jfree.org/jfreechart/</a>)</p></li><li class="listitem"><p>JUnit (<a class="link" href="http://www.junit.org" target="_top">www.junit.org</a>) </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d6099e14102"></a>4.9.2.&nbsp;Development Frameworks</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Maven (<a class="link" href="http://www.apache.maven.org" target="_top">apache.maven.org</a>)</p></li><li class="listitem"><p>Bazaar (<a class="link" href="http://www.bazaar-vcs.org" target="_top">bazaar-vcs.org</a>)</p></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d6099e14118"></a>4.10.&nbsp;Definitions</h2></div></div></div><p>[1] &#8220;Classpath&#8221; refers to the root of a JAR file, /WEB-INF/lib or /WEB-INF/classes in a WAR-file and /src/main/resources in the source code; locations from where the JVM is able to load classes.</p><p>[2] JFreeChart class located in the org.jfree.chart.renderer package.</p><p>[3] JFreeChart class located in the org.jfree.data.category package.</p><p>[4] Operations related to creating, retrieving, updating, and deleting objects.</p><p>[5] Model-View-Controller, design pattern for web applications which separates mark-up code from application logic code.</p><p>[6] The WAR-file dependency is a Maven construct and allows projects to access the WAR file contents during runtime.</p><p>[7] Project Object Model, the key configuration file in a Maven 2 project.</p><p>[8] Represents the front controller in the MVC design pattern in Struts.</p><p>[9] Hibernate second-level cache does not provide satisfactory performance.</p></div></div><div class="appendix"><div class="titlepage"><div><div><h1 class="title"><a name="dhis2_r"></a>Appendix&nbsp;A.&nbsp;DHIS2 and R integration</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="section"><a href="#dhis2_r_intro">A.1. Introduction</a></span></dt><dt><span class="section"><a href="#r_install">A.2. Installing R</a></span></dt><dt><span class="section"><a href="#dhis2_r_odbc">A.3. Using ODBC to retrieve data from DHIS2 into R</a></span></dt><dt><span class="section"><a href="#dhis2_r_mydatamart">A.4. Using R with MyDatamart</a></span></dt><dt><span class="section"><a href="#dhis2_r_maps">A.5. Mapping with R and PostgreSQL</a></span></dt><dt><span class="section"><a href="#dhis2_r_google_vis">A.6. Using R, DHIS2 and the Google Visualization API</a></span></dt><dt><span class="section"><a href="#dhis2_r_plr">A.7. Using PL/R with DHIS2</a></span></dt><dt><span class="section"><a href="#dhis2_r_web_api">A.8. Using this DHIS2 Web API with R</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="dhis2_r_intro"></a>A.1.&nbsp;Introduction</h2></div></div></div><p>R is freely available, open source statistical computing environment. R refers to  both the computer programming language, as well as the software which can be used to create and run R scripts. There are <a class="link" href="http://cran.r-project.org/" target="_top">numerous sources on the web</a> which describe the extensive set of features of R. </p><p>R is a natural extension to DHIS2, as it provides  powerful statistical routines, data manipulation functions, and visualization tools. This chapter will describe how to setup R and DHIS2 on the same server, and will provide a simple example of how to retrieve data from the DHIS2 database into an R data frame and perform some basic calculations.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="r_install"></a>A.2.&nbsp;Installing R</h2></div></div></div><p>If you are installing R on the same server as DHIS, you should consider using the Comprehensive R Archive Network (CRAN) to get the latest distribution of R. All you need to do is to add the following like to you <code class="filename">/etc/apt/source.list</code> file. </p><p><span class="bold"><strong>deb &lt;your R mirror&gt;/bin/linux/ubuntu &lt;your Ubuntu distribution&gt;</strong></span></p><p>You will need to replace <span class="bold"><strong>&lt;your R mirror&gt;</strong></span> with one from the list available <a class="link" href="http://cran.r-project.org/mirrors.html" target="_top">here.</a> You will also need to replace <span class="bold"><strong>&lt;your Ubuntu distribution&gt;</strong></span> with the name of the distribution you are using. </p><p>Once you have done this, invoke the following commands</p><pre class="screen">sudo apt-get update
gpg --keyserver pgp.mit.edu --recv-keys 51716619E084DAB9
gpg --armor --export 51716619E084DAB9 | apt-key add -
sudo apt-get install r-base r-cran-dbi</pre><p>At this point, you should have a functional R installation on your machine. </p><p>Next, lets see if everything   is working by simpling invoking <span class="command"><strong>R</strong></span> from the command line. </p><pre class="screen">foo@bar:~$ R

R version 2.14.1 (2011-12-22)
Copyright (C) 2011 The R Foundation for Statistical Computing
ISBN 3-900051-07-0
Platform: i686-pc-linux-gnu (32-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

&gt;
</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="dhis2_r_odbc"></a>A.3.&nbsp;Using ODBC to retrieve data from DHIS2 into R</h2></div></div></div><p>In this example, we will use a system-wide ODBC connector which will be used to retrieve
      data from the DHIS2 database. There are some disadvantages with this approach, as ODBC is
      slower than other methods and it does raise some security concerns by providing a system-wide
      connector to all users. However, it is a convenient method to provide a connection to multiple
      users. The use of the R package RODBC will be used in this case. Other alternatives would be
      the use of the <a class="link" href="http://dirk.eddelbuettel.com/code/rpostgresql.html" target="_top">RPostgreSQL</a> package, which can interface directly through the PostgreSQL driver
      described in the next section.</p><p>Assuming you have already installed R from the procedure in the previous section. Invoke the following command to add the required libraries for this example.</p><p><span class="command"><strong>apt-get install r-cran-rodbc r-cran-lattice odbc-postgresql</strong></span> </p><p>Next, we need to configure the ODBC connection. Edit the file to suit your local situation using the following template as a guide. Lets create and edit a file called odbc.ini</p><pre class="screen">[dhis2]
Description         = DHIS2 Database
Driver              = /usr/lib/odbc/psqlodbcw.so
Trace               = No
TraceFile           = /tmp/sql.log
Database            = dhis2
Servername          = 127.0.0.1
UserName            = postgres
Password            = SomethingSecure
Port                = 5432
Protocol            = 9.0
ReadOnly            = Yes
RowVersioning       = No
ShowSystemTables    = No
ShowOidColumn       = No
FakeOidIndex        = No
ConnSettings        =
Debug = 0</pre><p>
</p><p>Finally, we need to install the ODBC connection with <span class="command"><strong>odbcinst -i -d -f odbc.ini</strong></span></p><p></p><p>From the R prompt, execute the following commands to connect to the DHIS2 database. </p><pre class="screen">&gt; library(RODBC)
&gt; channel&lt;-odbcConnect("dhis2")#Note that the name must match the ODBC connector name
&gt; sqlTest&lt;-c("SELECT dataelementid, name FROM dataelement LIMIT 10;")
&gt; sqlQuery(channel,sqlTest)
                                                                        name
1   OPD First Attendances Under 5
2   OPD First Attendances Over 5
3   Deaths Anaemia Under 5 Years
4   Deaths Clinical Case of Malaria Under 5 Years
5   Inpatient discharges under 5
6   Inpatient Under 5 Admissions
7   Number ITNs
8   OPD 1st Attendance Clinical Case of Malaria Under 5
9  IP Discharge Clinical Case of Malaria Under 5 Years
10 Deaths of malaria case provided with anti-malarial treatment 1 to 5 Years
&gt;
</pre><p>It seems R is able to retrieve data from the DHIS2 database. </p><p>As an illustrative example, lets say we have been asked to calculate the relative percentage of OPD male and female under 5 attendances for the last twelve months.First, lets create an SQL query which will provide us the basic information which will be required.</p><pre class="screen">OPD&lt;-sqlQuery(channel,"SELECT p.startdate, de.name as de, sum(dv.value::double precision)
 FROM datavalue dv
 INNER JOIN period p on dv.periodid = p.periodid
 INNER JOIN dataelement de on dv.dataelementid = de.dataelementid
 WHERE p.startdate &gt;= '2011-01-01'
 and p.enddate &lt;= '2011-12-31'
 and de.name ~*('Attendance OPD')
 GROUP BY p.startdate, de.name;")</pre><p>We have stored the result of the SQL query in an R data frame called "OPD". Lets take a look at what the data looks like. </p><pre class="screen">&gt; head(OPD)
   startdate                                 de    sum
1 2011-12-01   Attendance OPD &lt;12 months female  42557
2 2011-02-01   Attendance OPD &lt;12 months female 127485
3 2011-01-01   Attendance OPD 12-59 months male 200734
4 2011-04-01   Attendance OPD 12-59 months male 222649
5 2011-06-01   Attendance OPD 12-59 months male 168896
6 2011-03-01 Attendance OPD 12-59 months female 268141
&gt; unique(OPD$de)
[1] Attendance OPD &lt;12 months female   Attendance OPD 12-59 months male  
[3] Attendance OPD 12-59 months female Attendance OPD &gt;5 years male      
[5] Attendance OPD &lt;12 months male     Attendance OPD &gt;5 years female    
6 Levels: Attendance OPD 12-59 months female ... Attendance OPD &gt;5 years male
&gt; 
          </pre><p>
</p><p>We can see that we need to aggregate the two age groups (&lt; 12 months and 12-59 months) into a single variable, based on the gender. Lets reshape the data into a crosstabulated table  to make this easier to visualize and calculate the summaries.</p><pre class="screen">&gt;OPD.ct&lt;-cast(OPD,startdate ~ de) 
&gt;colnames(OPD.ct)
[1] "startdate"                          "Attendance OPD 12-59 months female"
[3] "Attendance OPD 12-59 months male"   "Attendance OPD &lt;12 months female"  
[5] "Attendance OPD &lt;12 months male"     "Attendance OPD &gt;5 years female"    
[7] "Attendance OPD &gt;5 years male" </pre><p>     
</p><p>We have reshaped the data so that the data elements are individual columns. It looks like we need to aggregate the second and fourth columns together to get the under 5 female attendance, and then the third and fifth columns to get the male under 5 attendance.After this, lets subset the data into a new data frame just to get the required information and display the results.</p><pre class="screen">&gt; OPD.ct$OPDUnder5Female&lt;-OPD.ct[,2]+OPD.ct[,4]#Females
&gt; OPD.ct$OPDUnder5Male&lt;-OPD.ct[,3]+OPD.ct[,5]#males
&gt; OPD.ct.summary&lt;-OPD.ct[,c(1,8,9)]#new summary data frame
&gt;OPD.ct.summary$FemalePercent&lt;-
OPD.ct.summary$OPDUnder5Female/
(OPD.ct.summary$OPDUnder5Female + OPD.ct.summary$OPDUnder5Male)*100#Females
&gt;OPD.ct.summary$MalePercent&lt;-
OPD.ct.summary$OPDUnder5Male/
(OPD.ct.summary$OPDUnder5Female + OPD.ct.summary$OPDUnder5Male)*100#Males </pre><p>Of course, this could be accomplished much more elegantly, but for the purpose of the illustration, this code is rather verbose.Finally, lets display the required information.</p><pre class="screen">&gt; OPD.ct.summary[,c(1,4,5)]
    startdate FemalePercent MalePercent
1  2011-01-01      51.13360    48.86640
2  2011-02-01      51.49154    48.50846
3  2011-03-01      51.55651    48.44349
4  2011-04-01      51.19867    48.80133
5  2011-05-01      51.29902    48.70098
6  2011-06-01      51.66519    48.33481
7  2011-07-01      51.68762    48.31238
8  2011-08-01      51.49467    48.50533
9  2011-09-01      51.20394    48.79606
10 2011-10-01      51.34465    48.65535
11 2011-11-01      51.42526    48.57474
12 2011-12-01      50.68933    49.31067</pre><p>We can see that the male and female attendances are very similar for each month of the year, with seemingly higher male attendance relative to female attendance in the month of December.</p><p>In this example, we showed how to retrieve data from the DHIS2 database and manipulate in with some simple R commands. The basic pattern for using DHIS2 and R together, will be the retrieval of data from the DHIS2 database with an SQL query into an R data frame, followed by whatever routines (statistical analysis, plotting, etc) which may be required.  </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="dhis2_r_mydatamart"></a>A.4.&nbsp;Using R with MyDatamart</h2></div></div></div><p>MyDatamart provides  useful interface to the DHIS2 database by making a local copy of the database available on a users desktop. This means that the user does not need direct access to the database and the data can be worked with offline on the users local machine. In this example, we will have used the <a class="link" href="http://apps.dhis2.org/demo" target="_top">demo database</a>. Data was downloaded at the district level for Jan 2011-Dec 201l. Consult the MyDatamart section in this manual for more detailed information. </p><p>First, lets load some required R packages. If you do not have these packages already installed in your version of R, you will need to do so before proceeding with the example.</p><pre class="screen">library("DBI")
library("RSQLite")
library("lattice")
library("latticeExtra")</pre><p>Next, we are going to connect to the local copy of the MyDatamart database. In this case, it was located at C:\dhis2\sl.dmart. </p><pre class="screen">dbPath&lt;-"C:\\dhis2\\sl.dmart"
drv&lt;-dbDriver("SQLite")
db&lt;-dbConnect(drv,dbPath)</pre><p>Let suppose we have been asked to compare ANC 1, 2, 3 coverage rates for each district for 2011. We can define an SQL query to retrieve data from the MyDatamart database into an R data frame as follows.</p><pre class="screen">#An SQL query which will retreive all indicators 
#at OU2 le
sql&lt;-"SELECT * FROM pivotsource_indicator_ou2_m 
WHERE year = '2011'"
#Execute the query into a new result set
rs&lt;-dbSendQuery(db,sql)
#Put the entire result set into a new data frame
Inds&lt;-fetch(rs,n=-1)
#Clean up a bit
dbClearResult(rs)
dbDisconnect(db)</pre><p>We used one of the pre-existing Pivot Source queries in the database to get all of the indicator values. Of course, we could have retrieved only the ANC indicators, but we did not exactly know how the data was structured, or how the columns were named, so lets take a closer look. </p><pre class="screen">#Get the name of the columns
colnames(Inds)
#output not shown for brevity
levels(as.factor(Inds$indshort)) </pre><p>We see from the <span class="command"><strong>colnames</strong></span> command that there is an column called "indshort" which looks like it contains some indicator names. We can see the names using the second command. After we have determined which ones we need (ANC 1, 2, and 3), lets further subset the data so that we only have these. </p><pre class="screen">#Subset the data for ANC
ANC&lt;-Inds[grep("ANC (1|2|3) Coverage",as.factor(Inds$indshort)),]</pre><p>We just used R's grep function to retrieve all the rows and columns of the Inds data frame which matched the regular expression "ANC (1|2|3) Coverage" and put this into a new data frame called "ANC". </p><p>By looking at the data with the <span class="command"><strong>str(ANC)</strong></span> command, we will notice that the time periods are not ordered correctly, so lets fix this before we try and create a plot of the data.  </p><pre class="screen">#Lets reorder the months
MonthOrder&lt;-c('Jan','Feb','Mar','Apr',
'May','Jun','Jul','Aug','Sep','Oct','Nov','Dec')
ANC$month&lt;-factor(ANC$month,levels=MonthOrder)</pre><p>Next, we need to actually calculate the indicator value from the numerator, factor and denominator. </p><pre class="screen">#Calculate the indicator value
ANC$value&lt;-ANC$numxfactor/ANC$denominatorvalue</pre><p>Finally, lets create a simple trellis plot which compares ANC 1, 2, 3 for each district by month and save it to our local working directory in a file called "District_ANC.png". </p><pre class="screen">png(filename="District_ANC.png",width=1024,height=768)
plot.new()
 xyplot(value ~ month | ou2, data=ANC, type="a", main="District ANC Comparison Sierra Leone 2011",
 groups=indshort,xlab="Month",ylab="ANC Coverage",
 scales = list(x = list(rot=90)),
 key = simpleKey(levels(factor(ANC$indshort)),
 points=FALSE,lines=TRUE,corner=c(1,1)))
 mtext(date(), side=1, line=3, outer=F, adj=0, cex=0.7)
dev.off()</pre><p>The results of which are displayed below.</p><div class="mediaobject"><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="80%"><tr><td><img src="resources/images/r/District_ANC.png" width="100%"></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="dhis2_r_maps"></a>A.5.&nbsp;Mapping with R and PostgreSQL</h2></div></div></div><p>A somewhat more extended example, will use the RPostgreSQL library and several other libraries to produce a map from the coordinates stored in the database. We will define a few helper functions to provide a layer of abstraction, which will make the R code more reusable. </p><pre class="programlisting">#load some dependent libraries
 library(maps)
 library(maptools)
 library(ColorBrewer)
 library(ClassInt)
 library(RPostgreSQL)

#Define some helper functions
 
#Returns a dataframe from the connection for a valid statement
dfFromSQL&lt;-function (con,sql){
    rs&lt;-dbSendQuery(con,sql)
    result&lt;-fetch(rs,n=-1)
    return(result)
}
#Returns a list of latitudes and
 longitudes from the orgunit table
dhisGetFacilityCoordinates&lt;- function(con,levelLimit=4) {
sqlCoords&lt;-paste("SELECT ou.organisationunitid, ou.name,
substring(ou.coordinates from E'(?=,?)-[0-9]+\\.[0-9]+')::double precision as latitude,
substring(ou.coordinates from E'[0-9\\.]+'):double precision as
 longitude FROM organisationunit ou where ou.organisationunitid
 in (SELECT DISTINCT idlevel",levelLimit, " from _orgunitstructure)
 and ou.featuretype = 'Point'
 ;",sep="")
 result&lt;-dfFromSQL(con,sqlCoords)
 return(result)
 }

#Gets a dataframe of IndicatorValues,
# provided the name of the indicator,
# startdate, periodtype and level
dhisGetAggregatedIndicatorValues&lt;-function(con,
indicatorName,
startdate,
periodtype="Yearly",
level=4)
{
  sql&lt;-paste("SELECT organisationunitid,dv.value FROM aggregatedindicatorvalue dv
where dv.indicatorid  =
(SELECT indicatorid from indicator where name = \'",indicatorName,"\') and dv.level
 =", level,"and
 dv.periodid  = 
(SELECT periodid from period where 
startdate = \'",startdate,"\'
and periodtypeid = 
(SELECT periodtypeid from periodtype
 where name = \'",periodtype,"\'));",sep="")
   result&lt;-dfFromSQL(con,sql)
 return(result)
 }

#Main function which handles the plotting.
#con is the database connection
#IndicatorName is the name of the Indicator
#StartDate is the startdate
#baselayer is the baselayer
plotIndicator&lt;-function(con,
IndicatorName,
StartDate,
periodtype="Yearly",
level=4,baselayer) 
{
#First, get the desired indicator data
myDF&lt;-dhisGetAggregatedIndicatorValues(con,
IndicatorName,StartDate,periodtype,level)
#Next, get the coordinates
coords&lt;-dhisGetFacilityCoordinates(con,level)
#Merge the indicataors with the coordinates data frame
myDF&lt;-merge(myDF,coords)
#We need to cast the new data fram to a spatial data
#frame in order to utilize plot
myDF&lt;-SpatialPointsDataFrame(myDF[,
c("longitude","latitude")],myDF)
#Define some color scales
IndColors&lt;-c("firebrick4","firebrick1","gold"
,"darkolivegreen1","darkgreen")
#Define the class breaks. In this case, we are going
#to use 6 quantiles
class&lt;-classIntervals(myDF$value,n=6,style="quantile"
,pal=IndColors)
#Define a vector for the color codes to be used for the
#coloring of points by class
colCode&lt;-findColours(class,IndColors)
#Go ahead and make the plot
myPlot&lt;-plot.new()
#First, plot the base layer
plot(baselayer)
#Next, add the points data frame
points(myDF,col=colCode,pch=19)
#Add the indicator name to the title of the map
title(main=IndicatorName,sub=StartDate)
#Finally, return the plot from the function
return(myPlot) }


</pre><p>Up until this point, we have defined a few functions to help us make a map. We need to get the coordinates stored in the database and merge these with the indicator which we plan to map. We then retrieve the data from the aggregated indicator table, create a special type of data frame (SpatialPointsDataFrame), apply some styling to this, and then create the plot. </p><pre class="programlisting">
#Now we define the actual thing to do
#Lets get a connection to the database
con &lt;- dbConnect(PostgreSQL(), user= "dhis", password="SomethingSecure", dbname="dhis")
#Define the name of the indicator to plot
MyIndicatorName&lt;-"Total OPD Attendance"
MyPeriodType&lt;-"Yearly"
#This should match the level where coordinates are stored
MyLevel&lt;-4
#Given the startdate and period type, it is enough
#to determine the period
MyStartDate&lt;-"2010-01-01"
#Get some Some Zambia district data from GADM
#This is going to be used as the background layer
con &lt;- url("http://www.filefactory.com/file/c2a3898/n/ZMB_adm2_RData")
print(load(con))#saved as gadm object
#Make the map
plotIndicator(con,MyIndicatorName,MyStartDate,MyPeriodType,MyLevel,gadm)</pre><p>The results of the plotIndicator function are shown below.</p><div class="mediaobject"><img src="resources/images/r/OPDAttendance.png"></div><p>In this example, we showed how to use the RPostgreSQL library and other helper libraries(Maptools, ColorBrewer) to create a simple map from the DHIS2 data mart. </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="dhis2_r_google_vis"></a>A.6.&nbsp;Using R, DHIS2 and the Google Visualization API</h2></div></div></div><p>Google's Visualization API provides a very rich set of tools for the visualization of multi-dimensional data. In this simple example, we will show how to create a simple motion chart with the Google Visualization API using the "googleVis" R package. Full information on the package can be found <a class="link" href="http://code.google.com/p/google-motion-charts-with-r/" target="_top">here.</a>. The basic principle, as with the other examples, is to get some data from the DHIS2 database, and bring it into R, perform some minor alterations on the data to make it easier to work with, and then create the chart. In this case, we will compare ANC1,2,3 data over time and see how they are related with a motion chart.</p><pre class="screen">#Load some libraries
library(RPostgreSQL)
library(googleVis)
library(reshape)
#A small helper function to get a data frame from some SQL
dfFromSQL&lt;-function (con,sql){
    rs&lt;-dbSendQuery(con,sql)
    result&lt;-fetch(rs,n=-1)
    return(result)
}

#Get a database connection
user&lt;-"postgres"
password&lt;-"postgres"
host&lt;-"127.0.0.1"
port&lt;-"5432"
dbname&lt;-"dhis2_demo"
con &lt;- dbConnect(PostgreSQL(), user= user,
password=password,host=host, port=port,dbname=dbname)
#Let's retrieve some ANC data from the demo database
sql&lt;-"SELECT ou.shortname as province,
i.shortname as indicator,
extract(year from p.startdate) as year,
 a.value
FROM aggregatedindicatorvalue a
INNER JOIN  organisationunit ou on a.organisationunitid = ou.organisationunitid
INNER JOIN indicator i on a.indicatorid = i.indicatorid
INNER JOIN period p on a.periodid = p.periodid
WHERE a.indicatorid IN
(SELECT DISTINCT indicatorid from indicator where shortname ~*('ANC [123] Coverage'))
AND a.organisationunitid IN
 (SELECT DISTINCT idlevel2 from _orgunitstructure where idlevel2 is not null)
AND a.periodtypeid = (SELECT DISTINCT periodtypeid from periodtype where name = 'Yearly')"
#Store this in a data frame
anc&lt;-dfFromSQL(con,sql)
#Change these some columns to factors so that the reshape will work more easily

anc$province&lt;-as.factor(anc$province)
anc$indicator&lt;-as.factor(anc$indicator)
#We need the time variable as numeric
anc$year&lt;-as.numeric(as.character(anc$year))
#Need to cast the table into a slightly different format
anc&lt;-cast(anc,province + year ~ indicator)
#Now, create the motion chart and plot it
M&lt;-gvisMotionChart(anc,idvar="province",timevar="year")
plot(M)</pre><p>The resulting graph is displayed below.</p><div class="screenshot"><div class="mediaobject"><img src="resources/images/r/google_vis_col_chart.PNG"></div></div><p>Using packages like <a class="link" href="http://cran.r-project.org/package=brew" target="_top">brew</a> or <a class="link" href="http://rapache.net" target="_top">Rapache</a>, these types of graphs could be easily integrated into external web sites. A fully functional version of the chart shown above can be accessed <a class="link" href="http://dhis2.net/R/google-motion-chart.html" target="_top">here.</a></p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="dhis2_r_plr"></a>A.7.&nbsp;Using PL/R with DHIS2</h2></div></div></div><p>The procedural language for R is an extension to the core of PostgreSQL which allows data to be passed from the database to R, where calculations in R can be performed. The data can then be passed back to the database for further processing.. In this example, we will create a function to calculate some summary statistics which do not exist by default in SQL by using R. We will then create an SQL View in DHIS2 to display the results. The advantage of utilizing R in this context is that we do not need to write any significant amount of code to return these summary statistics, but simply utilize the built-in functions of R to do the work for us. </p><p> First, you will need to install <a class="link" href="http://www.joeconway.com/plr/" target="_top">PL/R</a>, which is described in detail <a class="link" href="http://www.joeconway.com/plr/doc/plr-install.html" target="_top">here.</a>. Following the example from the PL/R site, we will create some custom aggregate functions as detailed <a class="link" href="http://www.joeconway.com/plr/doc/plr-aggregate-funcs.html" target="_top">here.</a>  We will create two functions, to return the median and the skewness of a range of values.</p><pre class="screen">CREATE OR REPLACE FUNCTION r_median(_float8) returns float as '
  median(arg1)
' language 'plr';

CREATE AGGREGATE median (
  sfunc = plr_array_accum,
  basetype = float8,
  stype = _float8,
  finalfunc = r_median
);

CREATE OR REPLACE FUNCTION r_skewness(_float8) returns float as '
  require(e1071)
  skewness(arg1)
' language 'plr';

CREATE AGGREGATE skewness (
  sfunc = plr_array_accum,
  basetype = float8,
  stype = _float8,
  finalfunc = r_skewness
);</pre><p>Next, we will define an SQL query which will be used to retrieve the two new aggregate functions (median and skewness) which will be calculated using R. In this case, we will just get a single indicator from the data mart at the district level and calculate the summary values based on the name of the district which the values belong to. This query is very specific, but could be easily adapted to your own database.</p><pre class="screen">SELECT  ou.shortname,avg(dv.value),
median(dv.value),skewness(dv.value) FROM aggregatedindicatorvalue dv
INNER JOIN period p on p.periodid = dv.periodid
INNER JOIN organisationunit ou on 
dv.organisationunitid = ou.organisationunitid
WHERE dv.indicatorid = 112670
AND dv.level = 3
AND dv.periodtypeid = 3
AND p.startdate &gt;='2009-01-01'
GROUP BY ou.shortname;</pre><p>We can then save this query in the form of SQL View in DHIS2. A clipped version of the results are shown below. </p><div class="screenshot"><div class="mediaobject" align="center"><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="66%"><tr><td align="center"><img src="resources/images/r/r_plr.PNG" align="middle" width="100%"></td></tr></table></div></div><p>In this simple example, we have shown how to use PL/R with the DHIS2 database and web interface to display some summary statistics using R to  perform the calculations. </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="dhis2_r_web_api"></a>A.8.&nbsp;Using this DHIS2 Web API with R</h2></div></div></div><p>DHIS2 has a powerful Web API which can be used to integrate applications together. In this section, we will illustrate a few trivial examples of the use of the Web API, and how we can retrieve data and metadata for use in R. The Web API uses basic HTTP authentication (as described in the Web API section of this document). Using two R packages "RCurl" and "XML", we will be able to work with the output of the API in R. In the first example, we will get some metadata from the database. </p><pre class="screen">#We are going to need these two libraries
require(RCurl)
require(XML)
#This is a URL endpoint for a report table which we can 
#get from the WebAPI. 

url&lt;-"https://apps.dhis2.org/dev/api/reportTables/KJFbpIymTAo/data.csv"
#Lets get the response and we do not need the headers
#This site has some issues with its SSL certificate
#so lets not verify it.
response&lt;-getURL(url,userpwd="admin:district"
,httpauth = 1L, header=FALSE,ssl.verifypeer = FALSE)
#Unquote the data
data&lt;-noquote(response)
#here is the data.
mydata&lt;-read.table(textConnection(data),sep=",",header=T)
head(mydata)
</pre><p>Here, we have shown how to get some aggregate data from the DHIS2 demo database using the DHIS2's Web API.</p><p>In the next code example, we will retrieve some metadata, namely a list of data elements and their unique identifiers.</p><pre class="screen">#Get the list of data elements. Turn off paging and links
#This site has some issues with its SSL certificate
#so lets not verify it.
url&lt;-"https://apps.dhis2.org/dev/api/dataElements.xml?
paging=false&amp;links=false"
response&lt;-getURL(url,userpwd="admin:district",
httpauth = 1L, header=FALSE,ssl.verifypeer = FALSE)
#We ned to parse the result
bri&lt;-xmlParse(response)
#And get the root
r&lt;-xmlRoot(bri)
#Parse out what we need explicitly, in this case from the first node
#Just get the names and ids as separate arrays
de_names&lt;-xmlSApply(r[['dataElements']],xmlGetAttr,"name")
de_id&lt;-xmlSApply(r[['dataElements']],xmlGetAttr,"id")
#Lets bind them together
#but we need to be careful for missing attribute values
foo&lt;-cbind(de_names,de_id)
#Recast this as a data frame
data_elements&lt;-as.data.frame(foo,
stringsAsFactors=FALSE,row.names=1:nrow(foo))
head(data_elements)
</pre><p>Note that the values which we are interested in are stored as XML attributes and were parsed into two separate matrices and then combined together into a single data frame. </p></div></div></div></body></html>