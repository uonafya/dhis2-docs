<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>1.26.&nbsp;Data approval</title><link rel="stylesheet" type="text/css" href="resources/css/docbook_bsd.css"><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"><link rel="home" href="dhis2_developer_manual.html" title="DHIS2 Developer Manual"><link rel="up" href="ch01.html" title="Chapter&nbsp;1.&nbsp;Web API"><link rel="prev" href="ch01s25.html" title="1.25.&nbsp;Complete data set registrations"><link rel="next" href="ch01s27.html" title="1.27.&nbsp;Auditing"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">1.26.&nbsp;Data approval</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch01s25.html">Prev</a>&nbsp;</td><th width="60%" align="center">Chapter&nbsp;1.&nbsp;Web API</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="ch01s27.html">Next</a></td></tr></table><hr></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e5779"></a>1.26.&nbsp;Data approval</h2></div></div></div><p>This section explains how to approve, unapprove and check approval status using the
        <span class="italic">dataApprovals</span> resource. Approval is done per data set,
      period, organisation unit and attribute option
      combo.</p><pre class="screen">/api/24/dataApprovals</pre><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d0e5789"></a>1.26.1.&nbsp;Get approval status</h3></div></div></div><p>To get approval information for a data set you can issue a GET request similar to
        this:</p><pre class="screen">GET http://server.com/api/dataApprovals?ds=aLpVgfXiz0f&amp;pe=2013&amp;ou=DiszpKrYNg8</pre><div class="table"><a name="d0e5796"></a><p class="title"><b>Table&nbsp;1.46.&nbsp;Data approval query parameters</b></p><div class="table-contents"><table class="table" summary="Data approval query parameters" border="1"><colgroup><col class="c1"><col class="c2"><col class="c3"></colgroup><thead><tr><th>Query parameter</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>ds</td><td>Yes</td><td>Data set identifier</td></tr><tr><td>pe</td><td>Yes</td><td>Period identifier</td></tr><tr><td>ou</td><td>Yes</td><td>Organisation unit identifier</td></tr></tbody></table></div></div><br class="table-break"><p>This will give you a response something like this:</p><pre class="screen">{
  "mayApprove": false,
  "mayUnapprove": false,
  "mayAccept": false,
  "mayUnaccept": false,
  "state": "UNAPPROVED_ELSEWHERE"
}</pre><p>The returned parameters are:</p><div class="table"><a name="d0e5839"></a><p class="title"><b>Table&nbsp;1.47.&nbsp;Data approval query parameters</b></p><div class="table-contents"><table class="table" summary="Data approval query parameters" border="1"><colgroup><col class="c1"><col class="c2"></colgroup><thead><tr><th>Return Parameter</th><th>Description</th></tr></thead><tbody><tr><td>mayApprove</td><td>Whether the current user may approve this data selection.</td></tr><tr><td>mayUnapprove</td><td>Whether the current user may unapprove this data selection.</td></tr><tr><td>mayAccept</td><td>Whether the current user may accept this data selection.</td></tr><tr><td>mayUnaccept</td><td>Whether the current user may unaccept this data selection.</td></tr><tr><td>state</td><td>One of the data approval states from the table below.</td></tr></tbody></table></div></div><br class="table-break"><div class="table"><a name="d0e5877"></a><p class="title"><b>Table&nbsp;1.48.&nbsp;Data approval states</b></p><div class="table-contents"><table class="table" summary="Data approval states" border="1"><colgroup><col class="c1"><col class="c2"></colgroup><thead><tr><th>State</th><th>Description</th></tr></thead><tbody><tr><td>UNAPPROVABLE</td><td>Data approval does not apply to this selection. (Data is neither
                "approved" nor "unapproved".)</td></tr><tr><td>UNAPPROVED_WAITING</td><td>Data could be approved for this selection, but is waiting for some lower-level
                approval before it is ready to be approved.</td></tr><tr><td>UNAPPROVED_ELSEWHERE</td><td>Data is unapproved, and is waiting for approval somewhere else (not approvable
                here.)</td></tr><tr><td>UNAPPROVED_READY</td><td>Data is unapproved, and is ready to be approved for this selection.</td></tr><tr><td>APPROVED_HERE</td><td>Data is approved, and was approved here (so could be unapproved here.)</td></tr><tr><td>APPROVED_ELSEWHERE</td><td>Data is approved, but was not approved here (so cannot be unapproved here.)
                This covers the following cases: <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Data is approved at a higher level.</p></li><li class="listitem"><p>Data is approved for wider scope of category options.</p></li><li class="listitem"><p>Data is approved for all sub-periods in selected period.</p></li></ul></div> In the first two cases, there is a single data approval object that
                covers the selection. In the third case there is not. </td></tr><tr><td>ACCEPTED_HERE</td><td>Data is approved and accepted here (so could be unapproved here.)</td></tr><tr><td>ACCEPTED_ELSEWHERE</td><td>Data is approved and accepted, but elsewhere.</td></tr></tbody></table></div></div><br class="table-break"><p>Note that when querying for the status of data approval, you may specify any combination
        of the query parameters. The combination you specify does not need to describe the place
        where data is to be approved at one of the approval levels. For example:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>The organisation unit might not be at an approval level. The approval status is
            determined by whether data is approved at an approval level for an ancestor of the
            organisation unit.</p></li><li class="listitem"><p>You may specify individual attribute category options. The approval status is
            determined by whether data is approved for an attribute category option combination that
            includes one or more of these options.</p></li><li class="listitem"><p>You may specify a time period that is longer than the period for the data set at
            which the data is entered and approvede. The approval status is determined by whether
            the data is approved for all the data set periods within the period you specify.</p></li></ul></div><p>For data sets which are associated with a category combo you might want to fetch data
        approval records for individual attribute option combos from the following
        resource:</p><pre class="screen">GET api/dataApprovals/categoryOptionCombos?ds=aLpVgfXiz0f&amp;pe=2013&amp;ou=DiszpKrYNg8</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d0e5957"></a>1.26.2.&nbsp;Approve data</h3></div></div></div><p>To approve data you can issue a <span class="italic">POST</span> request to the
          <span class="italic">dataApprovals</span> resource. To un-approve data you can
        issue a <span class="italic">DELETE</span> request to the dataApprovals
        resource.</p><pre class="screen">POST DELETE /api/24/dataApprovals</pre><p>To accept data you can issue a <span class="italic">POST</span> request to the
          <span class="italic">dataApprovals/acceptances</span> resource. To un-accept data
        you can issue a <span class="italic">DELETE</span> request to the <span class="italic">dataApprovals/acceptances</span> resource.</p><pre class="screen">POST DELETE /api/24/dataApprovals/acceptances</pre><p>These requests contain the following parameters:</p><div class="table"><a name="d0e5991"></a><p class="title"><b>Table&nbsp;1.49.&nbsp;Data approval action parameters</b></p><div class="table-contents"><table class="table" summary="Data approval action parameters" border="1"><colgroup><col class="c1"><col class="c2"><col class="c3"></colgroup><thead><tr><th>Action parameter</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>ds</td><td>Yes</td><td>Data set identifier</td></tr><tr><td>pe</td><td>Yes</td><td>Period identifier</td></tr><tr><td>ou</td><td>Yes</td><td>Organisation unit identifier</td></tr></tbody></table></div></div><br class="table-break"><p>Note that, unlike querying the data approval status, you must specify parameters that
        correspond to a selection of data that could be approved. In particular, all of the
        following must be true:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>The organisation unit's level must be specified by an approval level.</p></li><li class="listitem"><p>The time period specified must match the period type of the data set.</p></li><li class="listitem"><p>The data set must specify that data can be approved for this data set.</p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d0e6040"></a>1.26.3.&nbsp;Bulk approve data</h3></div></div></div><p>You can approve a bulk of data records by posting to the<span class="italic">
          api/dataApprovals/approvals</span>
        resource.</p><pre class="screen">POST /api/24/dataApprovals/approvals</pre><p>You can unapprove a bulk of data records by posting to the <span class="italic">api/dataApprovals/unapprovals</span>
        resource.</p><pre class="screen">POST /api/24/dataApprovals/unapprovals</pre><p>You can accept a bulk of records by posting to the <span class="italic">api/dataAcceptances/acceptances</span>
        resource.</p><pre class="screen">POST /api/24/dataAcceptances/acceptances</pre><p>You can unaccept a bulk of records by posting to the <span class="italic">api/dataAcceptances/unacceptances</span>
        resource.</p><pre class="screen">POST /api/24/dataAcceptances/unacceptances</pre><p>The approval payload is supported as JSON and looks like
        this:</p><pre class="screen">{
  "ds": [
    "pBOMPrpg1QX", "lyLU2wR22tC"
  ],
  "pe": [
    "201601", "201602"
  ],
  "approvals": [{
      "ou": "cDw53Ej8rju",
      "aoc": "ranftQIH5M9"
    }, {
      "ou": "cDw53Ej8rju",
      "aoc": "fC3z1lcAW5x"
    }]
}</pre></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch01s25.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="ch01.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="ch01s27.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">1.25.&nbsp;Complete data set registrations&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="dhis2_developer_manual.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;1.27.&nbsp;Auditing</td></tr></table></div></body></html>