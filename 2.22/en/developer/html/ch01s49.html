<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>1.49.&nbsp;Tracked entity instance management</title><link rel="stylesheet" type="text/css" href="resources/css/docbook_bsd.css"><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"><meta name="keywords" content="DHIS2, HMIS, aggregate data, Health Management Information System, Integrated data repository, Health Information System"><link rel="home" href="dhis2_developer_manual.html" title="DHIS2 Developer Manual"><link rel="up" href="ch01.html" title="Chapter&nbsp;1.&nbsp;Web API"><link rel="prev" href="ch01s48.html" title="1.48.&nbsp;Tracked entity management"><link rel="next" href="ch01s50.html" title="1.50.&nbsp;Tracked entity instance query"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">1.49.&nbsp;Tracked entity instance management</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch01s48.html">Prev</a>&nbsp;</td><th width="60%" align="center">Chapter&nbsp;1.&nbsp;Web API</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="ch01s50.html">Next</a></td></tr></table><hr></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d5e5285"></a>1.49.&nbsp;Tracked entity instance management</h2></div></div></div>
    
    <p>Tracked entity instances have full CRUD (create, read, update, delete) support in the
      Web-API. Together with the API for enrollment most operations needed for working with tracked
      entity instances and programs are supported.</p>
    <div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d5e5288"></a>1.49.1.&nbsp;Creating a new tracked entity instance</h3></div></div></div>
      
      <p>For creating a new person in the system, you will be working with the <span class="italic">trackedEntityInstances</span> resource. A template payload can be seen
        below:</p><pre class="screen">{
    "trackedEntity": "tracked-entity-id",
    "orgUnit": "org-unit-id",
    "attributes": [ {
        "attribute": "attribute-id",
        "value": "attribute-value"
    } ]
}</pre>
      <p>For getting the IDs for <span class="italic">relationship</span>, <span class="italic">attributes</span> you can have a look at the respective resources
          <span class="italic">relationshipTypes</span>,, <span class="italic">trackedEntityAttributes</span>. To create a tracked entity instance you must use the
        HTTP <span class="bold"><strong>POST</strong></span> method. You can post the payload the the
        following URL:</p>
      <pre class="screen">/api/trackedEntityInstances</pre>
      <p> For example, let us create a new instance of a person tracked entity and specify its
        first name and last name
        attributes:</p><pre class="screen">{
  "trackedEntity": "cyl5vuJ5ETQ",
  "orgUnit": "DiszpKrYNg8",
  "attributes": [
    {
      "attribute": "dv3nChNSIxy",
      "value": "Joe"
    },
    {
      "attribute": "hwlRTFIFSUq",
      "value": "Smith"
    }
  ]
}</pre>
      <p>To push this to the server you can use the cURL command like
        this:</p><pre class="screen">curl -d @tei.json "play.dhis2.org/demo/api/trackedEntityInstances" -X POST 
-H "Content-Type: application/json" -u admin:district -v</pre>
    </div>
    <div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d5e5304"></a>1.49.2.&nbsp;Updating a tracked entity instance</h3></div></div></div>
      
      <p>For updating a tracked entity instance, the payload is the equal to the previous
        section. The difference is that you must use the HTTP <span class="bold"><strong>PUT</strong></span>
        method for the request when sending the payload. You will also need to append the person
        identifier to the <span class="italic">trackedEntityInstances</span> resource in the
        URL like this, where &lt;tracked-entity-instance-identifier&gt; should be replaced by the
        identifier of the tracked entity instance:</p>
      <pre class="screen">/api/trackedEntityInstances/&lt;tracked-entity-instance-id&gt;</pre>
    </div>
    <div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d5e5310"></a>1.49.3.&nbsp;Deleting a tracked entity instance</h3></div></div></div>
      
      <p>To delete a tracked entity instance you can make a request to the URL identifiying the
        tracked entity instance with the HTTP <span class="bold"><strong>DELETE</strong></span> method. The
        URL is equal to the one above used for update.</p>
    </div>
    <div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d5e5314"></a>1.49.4.&nbsp;Enrolling a tracked entity instance into a program</h3></div></div></div>
      
      <p>For enrolling persons into a program, you will need to first get the identifier of the
        person from the <span class="italic">trackedEntityInstances</span> resource. Then,
        you will need to get the program identifier from the <span class="italic">programs</span> resource. A template payload can be seen
        below:</p><pre class="screen">{
    "trackedEntityInstance": "ZRyCnJ1qUXS",
    "orgUnit": "ImspTQPwCqd",
    "program": "S8uo8AlvYMz",
    "enrollmentDate": "2013-09-17",
    "incidentDate": "2013-09-17"
}</pre>
      <p>This payload should be used in a <span class="bold"><strong>POST</strong></span> request to the
        enrollments resource identified by the following URL:</p>
      <pre class="screen">/api/enrollments</pre>
      <p>For cancelling or completing an enrollment, you can make a <span class="bold"><strong>PUT</strong></span> request to the <span class="italic">enrollments</span> resource,
        including the identifier and the action you want to perform. For cancelling an enrollment
        for a tracked entity
        instance:</p><pre class="screen">/api/enrollments/&lt;enrollment-id&gt;/cancelled</pre>
      <p>For completing a enrollment for a tracked entity instance you can make a <span class="bold"><strong>PUT</strong></span> request to the following
        URL:</p><pre class="screen">/api/enrollments/&lt;enrollment-id&gt;/completed</pre>
      <p>For deleting a enrollment, you can make a <span class="bold"><strong>DELETE</strong></span>
        request to the following URL:</p><pre class="screen">/api/enrollments/&lt;enrollment-id&gt;</pre>
    </div>
    <div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d5e5333"></a>1.49.5.&nbsp;Update strategies</h3></div></div></div>
      
      <p>Two update strategies for tracked entity instance are supported: enrollment and event
        creation. This is useful when you have generated an identifier on the client side and are
        not sure if it was created or not on the server.</p><div class="table"><a name="d5e5336"></a><p class="title"><b>Table&nbsp;1.71.&nbsp;Available tracker strategies</b></p><div class="table-contents">
          
          <table summary="Available tracker strategies" border="1"><colgroup><col class="c1"><col class="c2"></colgroup><thead><tr><th>Parameter</th><th>Description</th></tr></thead><tbody><tr><td>CREATE</td><td>Create only, this is the default behavior.</td></tr><tr><td>CREATE_AND_UPDATE</td><td>Try and match the ID, if it exist then update, if not create.</td></tr></tbody></table>
        </div></div><p><br class="table-break"></p>
      <p>To change the parameter, please use the strategy
        parameter:</p><pre class="screen">POST /api/trackedEntityInstances?strategy=CREATE_AND_UPDATE</pre>
    </div>
  </div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch01s48.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="ch01.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="ch01s50.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">1.48.&nbsp;Tracked entity management&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="dhis2_developer_manual.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;1.50.&nbsp;Tracked entity instance query</td></tr></table></div></body></html>